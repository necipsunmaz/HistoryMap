!function(){var n;window.HistoryMaps?n=window.HistoryMaps:(n={},window.HistoryMaps=n,n.themes={},n.maps={},n.inheriting={},n.charts=[],n.onReadyArray=[],n.useUTC=!1,n.updateRate=60,n.uid=0,n.lang={},n.translations={},n.mapTranslations={},n.windows={},n.initHandlers=[],n.amString="am",n.pmString="pm");n.Class=function(t){var i=function(){arguments[0]!==n.inheriting&&(this.events={},this.construct.apply(this,arguments))},r;t.inherits?(i.prototype=new t.inherits(n.inheriting),i.base=t.inherits.prototype,delete t.inherits):(i.prototype.createEvents=function(){for(var n=0;n<arguments.length;n++)this.events[arguments[n]]=[]},i.prototype.listenTo=function(n,t,i){this.removeListener(n,t,i);n.events[t].push({handler:i,scope:this})},i.prototype.addListener=function(n,t,i){this.removeListener(this,n,t);n&&this.events[n]&&this.events[n].push({handler:t,scope:i})},i.prototype.removeListener=function(n,t,i){if(n&&n.events&&(n=n.events[t]))for(t=n.length-1;0<=t;t--)n[t].handler===i&&n.splice(t,1)},i.prototype.fire=function(n){for(var r,i=this.events[n.type],t=0;t<i.length;t++)r=i[t],r.handler.call(r.scope,n)});for(r in t)i.prototype[r]=t[r];return i};n.addChart=function(t){window.requestAnimationFrame?n.animationRequested||(n.animationRequested=!0,window.requestAnimationFrame(n.update)):n.updateInt||(n.updateInt=setInterval(function(){n.update()},Math.round(1e3/n.updateRate)));n.charts.push(t)};n.removeChart=function(t){for(var i=n.charts,r=i.length-1;0<=r;r--)i[r]==t&&i.splice(r,1);0===i.length&&(n.requestAnimation&&(window.cancelAnimationFrame(n.requestAnimation),n.animationRequested=!1),n.updateInt&&(clearInterval(n.updateInt),n.updateInt=NaN))};n.isModern=!0;n.getIEVersion=function(){var n,t,i=0;return"Microsoft Internet Explorer"==navigator.appName&&(n=navigator.userAgent,t=/MSIE ([0-9]{1,}[.0-9]{0,})/,null!==t.exec(n)&&(i=parseFloat(RegExp.$1))),i};n.applyLang=function(t,i){var r=n.translations;i.dayNames=n.extend({},n.dayNames);i.shortDayNames=n.extend({},n.shortDayNames);i.monthNames=n.extend({},n.monthNames);i.shortMonthNames=n.extend({},n.shortMonthNames);i.amString="am";i.pmString="pm";r&&(r=r[t])&&(n.lang=r,i.langObj=r,r.monthNames&&(i.dayNames=n.extend({},r.dayNames),i.shortDayNames=n.extend({},r.shortDayNames),i.monthNames=n.extend({},r.monthNames),i.shortMonthNames=n.extend({},r.shortMonthNames)),r.am&&(i.amString=r.am),r.pm&&(i.pmString=r.pm));n.amString=i.amString;n.pmString=i.pmString};n.IEversion=n.getIEVersion();9>n.IEversion&&0<n.IEversion&&(n.isModern=!1,n.isIE=!0);n.dx=0;n.dy=0;(document.addEventListener||window.opera)&&(n.isNN=!0,n.isIE=!1,n.dx=.5,n.dy=.5);document.attachEvent&&(n.isNN=!1,n.isIE=!0,n.isModern||(n.dx=0,n.dy=0));window.chrome&&(n.chrome=!0);n.handleMouseUp=function(t){for(var r,u=n.charts,i=0;i<u.length;i++)r=u[i],r&&r.handleReleaseOutside&&r.handleReleaseOutside(t)};n.handleMouseMove=function(t){for(var r,u=n.charts,i=0;i<u.length;i++)r=u[i],r&&r.handleMouseMove&&r.handleMouseMove(t)};n.handleWheel=function(t){for(var i,u=n.charts,r=0;r<u.length;r++)if(i=u[r],i&&i.mouseIsOver){(i.mouseWheelScrollEnabled||i.mouseWheelZoomEnabled)&&i.handleWheel&&i.handleWheel(t);break}};n.resetMouseOver=function(){for(var r,i=n.charts,t=0;t<i.length;t++)r=i[t],r&&(r.mouseIsOver=!1)};n.ready=function(t){n.onReadyArray.push(t)};n.handleLoad=function(){var i,t,r;for(n.isReady=!0,i=n.onReadyArray,t=0;t<i.length;t++)r=i[t],isNaN(n.processDelay)?r():setTimeout(r,n.processDelay*t)};n.addInitHandler=function(t,i){n.initHandlers.push({method:t,types:i})};n.callInitHandler=function(t){var u=n.initHandlers,r,i;if(n.initHandlers)for(r=0;r<u.length;r++)i=u[r],i.types?n.isInArray(i.types,t.type)&&i.method(t):i.method(t)};n.getUniqueId=function(){return"HistoryMapsEl-"+ ++n.uid};n.isNN&&(document.addEventListener("mousemove",n.handleMouseMove),document.addEventListener("mouseup",n.handleMouseUp,!0),window.addEventListener("load",n.handleLoad,!0),window.addEventListener("DOMMouseScroll",n.handleWheel,!0),document.addEventListener("mousewheel",n.handleWheel,!0));n.isIE&&(document.attachEvent("onmousemove",n.handleMouseMove),document.attachEvent("onmouseup",n.handleMouseUp),window.attachEvent("onload",n.handleLoad),document.attachEvent("onmousewheel",n.handleWheel));n.clear=function(){var i=n.charts,t;if(i)for(t=i.length-1;0<=t;t--)i[t].clear();n.updateInt&&clearInterval(n.updateInt);n.requestAnimation&&window.cancelAnimationFrame(n.requestAnimation);n.charts=[];n.isNN&&(document.removeEventListener("mousemove",n.handleMouseMove,!0),document.removeEventListener("mouseup",n.handleMouseUp,!0),window.removeEventListener("load",n.handleLoad,!0),window.removeEventListener("DOMMouseScroll",n.handleWheel,!0),document.removeEventListener("mousewheel",n.handleWheel,!0));n.isIE&&(document.detachEvent("onmousemove",n.handleMouseMove),document.detachEvent("onmouseup",n.handleMouseUp),window.detachEvent("onload",n.handleLoad))};n.makeChart=function(t,i,r){var e=i.type,f=i.theme,u;n.isString(f)&&(f=n.themes[f],i.theme=f);switch(e){case"serial":u=new n.AmSerialChart(f);break;case"xy":u=new n.AmXYChart(f);break;case"pie":u=new n.AmPieChart(f);break;case"radar":u=new n.AmRadarChart(f);break;case"gauge":u=new n.AmAngularGauge(f);break;case"funnel":u=new n.AmFunnelChart(f);break;case"map":u=new n.HisMap(f);break;case"stock":u=new n.AmStockChart(f);break;case"gantt":u=new n.AmGanttChart(f)}return n.extend(u,i),n.isReady?isNaN(r)?u.write(t):setTimeout(function(){n.realWrite(u,t)},r):n.ready(function(){isNaN(r)?u.write(t):setTimeout(function(){n.realWrite(u,t)},r)}),u};n.realWrite=function(n,t){n.write(t)};n.updateCount=0;n.validateAt=Math.round(n.updateRate/10);n.update=function(){var i=n.charts,r,t;if(n.updateCount++,r=!1,n.updateCount==n.validateAt&&(r=!0,n.updateCount=0),i)for(t=i.length-1;0<=t;t--)i[t].update&&i[t].update(),r&&(i[t].autoResize?i[t].validateSize&&i[t].validateSize():i[t].premeasure&&i[t].premeasure());window.requestAnimationFrame&&(n.requestAnimation=window.requestAnimationFrame(n.update))};n.bezierX=3;n.bezierY=6;"complete"==document.readyState&&n.handleLoad()}(),function(){var n=window.HistoryMaps;n.toBoolean=function(n,t){if(void 0===n)return t;switch(String(n).toLowerCase()){case"true":case"yes":case"1":return!0;case"false":case"no":case"0":case null:return!1;default:return!!n}};n.removeFromArray=function(n,t){var i;if(void 0!==t&&void 0!==n)for(i=n.length-1;0<=i;i--)n[i]==t&&n.splice(i,1)};n.getPath=function(){var t=document.getElementsByTagName("script"),n,i;if(t)for(n=0;n<t.length;n++)if(i=t[n].src,-1!==i.search(/\/(historymaps|historymap)\.js/))return i.replace(/\/(historymaps|historymap)\.js.*/,"/")};n.normalizeUrl=function(n){return""!==n&&-1===n.search(/\/$/)?n+"/":n};n.isAbsolute=function(n){return 0===n.search(/^http[s]?:|^\//)};n.isInArray=function(n,t){for(var i=0;i<n.length;i++)if(n[i]==t)return!0;return!1};n.getDecimals=function(n){var t=0;return isNaN(n)||(n=String(n),-1!=n.indexOf("e-")?t=Number(n.split("-")[1]):-1!=n.indexOf(".")&&(t=n.split(".")[1].length)),t};n.wordwrap=function(t,i,r,u){var o,e,f,s;if(t+="",1>i)return t;for(o=-1,t=(s=t.split(/\r\n|\n|\r/)).length;++o<t;s[o]+=f){for(f=s[o],s[o]="";f.length>i;s[o]+=n.trim(f.slice(0,e))+((f=f.slice(e)).length?r:""))e=2==u||(e=f.slice(0,i+1).match(/\S*(\s)?$/))[1]?i:e.input.length-e[0].length||1==u&&i||e.input.length+(e=f.slice(i).match(/^\S*/))[0].length;f=n.trim(f)}return s.join(r)};n.trim=function(n){return n.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")};n.wrappedText=function(t,i,r,u,f,e,o,s){var h=n.text(t,i,r,u,f,e,o),c,l;return h&&(c=h.getBBox(),c.width>s&&(l="\n",n.isModern||(l="<br>"),s=Math.floor(s/(c.width/i.length)),2<s&&(s-=2),i=n.wordwrap(i,s,l,!0),h.remove(),h=n.text(t,i,r,u,f,e,o))),h};n.getStyle=function(n,t){var i="";if(document.defaultView&&document.defaultView.getComputedStyle)try{i=document.defaultView.getComputedStyle(n,"").getPropertyValue(t)}catch(n){}else n.currentStyle&&(t=t.replace(/\-(\w)/g,function(n,t){return t.toUpperCase()}),i=n.currentStyle[t]);return i};n.removePx=function(n){if(void 0!==n)return Number(n.substring(0,n.length-2))};n.getURL=function(t,i){if(t)if("_self"!=i&&i)if("_top"==i&&window.top)window.top.location.href=t;else if("_parent"==i&&window.parent)window.parent.location.href=t;else if("_blank"==i)window.open(t);else{var r=document.getElementsByName(i)[0];r?r.src=t:(r=n.windows[i])&&r.opener&&!r.opener.closed?r.location.href=t:n.windows[i]=window.open(t)}else window.location.href=t};n.ifArray=function(n){return!!(n&&"object"==typeof n&&0<n.length)};n.callMethod=function(n,t){for(var i,e,u,f,r=0;r<t.length;r++)if(i=t[r],i&&(i[n]&&i[n](),e=i.length,0<e))for(u=0;u<e;u++)f=i[u],f&&f[n]&&f[n]()};n.toNumber=function(n){return"number"==typeof n?n:Number(String(n).replace(/[^0-9\-.]+/g,""))};n.toColor=function(n){var t,i;if(""!==n&&void 0!==n)if(-1!=n.indexOf(","))for(n=n.split(","),t=0;t<n.length;t++)i=n[t].substring(n[t].length-6,n[t].length),n[t]="#"+i;else n=n.substring(n.length-6,n.length),n="#"+n;return n};n.toCoordinate=function(n,t,i){var r;return void 0!==n&&(n=String(n),i&&i<t&&(t=i),r=Number(n),-1!=n.indexOf("!")&&(r=t-Number(n.substr(1))),-1!=n.indexOf("%")&&(r=t*Number(n.substr(0,n.length-1))/100)),r};n.fitToBounds=function(n,t,i){return n<t&&(n=t),n>i&&(n=i),n};n.isDefined=function(n){return void 0!==n};n.stripNumbers=function(n){return n.replace(/[0-9]+/g,"")};n.roundTo=function(n,t){if(0>t)return n;var i=Math.pow(10,t);return Math.round(n*i)/i};n.toFixed=function(n,t){var i=String(Math.round(n*Math.pow(10,t))),r,u;if(0<t){if(r=i.length,r<t)for(u=0;u<t-r;u++)i="0"+i;return r=i.substring(0,i.length-t),""===r&&(r=0),r+"."+i.substring(i.length-t,i.length)}return String(i)};n.formatDuration=function(t,i,r,u,f,e){var s=n.intervals,h=e.decimalSeparator,o;if(t>=s[i].contains)return o=t-Math.floor(t/s[i].contains)*s[i].contains,"ss"==i?(o=n.formatNumber(o,e),1==o.split(h)[0].length&&(o="0"+o)):o=n.roundTo(o,e.precision),("mm"==i||"hh"==i)&&10>o&&(o="0"+o),r=o+""+u[i]+r,t=Math.floor(t/s[i].contains),i=s[i].nextInterval,n.formatDuration(t,i,r,u,f,e);if("ss"==i&&(t=n.formatNumber(t,e),1==t.split(h)[0].length&&(t="0"+t)),("mm"==i||"hh"==i)&&10>t&&(t="0"+t),r=t+""+u[i]+r,s[f].count>s[i].count)for(t=s[i].count;t<s[f].count;t++)i=s[i].nextInterval,"ss"==i||"mm"==i||"hh"==i?r="00"+u[i]+r:"DD"==i&&(r="0"+u[i]+r);return":"==r.charAt(r.length-1)&&(r=r.substring(0,r.length-1)),r};n.formatNumber=function(t,i,r,u,f){var c,l,e,o,h,s;if(t=n.roundTo(t,i.precision),isNaN(r)&&(r=i.precision),c=i.decimalSeparator,i=i.thousandsSeparator,l=0>t?"-":"",t=Math.abs(t),h=String(t),s=!1,-1!=h.indexOf("e")&&(s=!0),0<=r&&!s&&(h=n.toFixed(t,r)),e="",s)e=h;else{for(h=h.split("."),s=String(h[0]),o=s.length;0<=o;o-=3)e=o!=s.length?0!==o?s.substring(o-3,o)+i+e:s.substring(o-3,o)+e:s.substring(o-3,o);void 0!==h[1]&&(e=e+c+h[1]);void 0!==r&&0<r&&"0"!=e&&(e=n.addZeroes(e,c,r))}return e=l+e,""===l&&!0===u&&0!==t&&(e="+"+e),!0===f&&(e+="%"),e};n.addZeroes=function(t,i,r){return t=t.split(i),void 0===t[1]&&0<r&&(t[1]="0"),t[1].length<r?(t[1]+="0",n.addZeroes(t[0]+i+t[1],i,r)):void 0!==t[1]?t[0]+i+t[1]:t[0]};n.scientificToNormal=function(n){var t,i,r;if(n=String(n).split("e"),"-"==n[1].substr(0,1)){for(t="0.",i=0;i<Math.abs(Number(n[1]))-1;i++)t+="0";t+=n[0].split(".").join("")}else for(r=0,t=n[0].split("."),t[1]&&(r=t[1].length),t=n[0].split(".").join(""),i=0;i<Math.abs(Number(n[1]))-r;i++)t+="0";return t};n.toScientific=function(n,t){if(0===n)return"0";var r=Math.floor(Math.log(Math.abs(n))*Math.LOG10E),i=String(i).split(".").join(t);return String(i)+"e"+r};n.randomColor=function(){return"#"+("00000"+(16777216*Math.random()<<0).toString(16)).substr(-6)};n.hitTest=function(t,i,r){var u=!1,e=t.x,o=t.x+t.width,s=t.y,h=t.y+t.height,f=n.isInRectangle;return u||(u=f(e,s,i)),u||(u=f(e,h,i)),u||(u=f(o,s,i)),u||(u=f(o,h,i)),u||!0===r||(u=n.hitTest(i,t,!0)),u};n.isInRectangle=function(n,t,i){return n>=i.x-5&&n<=i.x+i.width+5&&t>=i.y-5&&t<=i.y+i.height+5};n.isPercents=function(n){if(-1!=String(n).indexOf("%"))return!0};n.formatValue=function(t,i,r,u,f,e,o,s){var c,l,h;if(i)for(void 0===f&&(f=""),c=0;c<r.length;c++)l=r[c],h=i[l],void 0!==h&&(h=e?n.addPrefix(h,s,o,u):n.formatNumber(h,u),t=t.replace(new RegExp("\\[\\["+f+l+"\\]\\]","g"),h));return t};n.formatDataContextValue=function(n,t){var r,u,i;if(n)for(u=n.match(/\[\[.*?\]\]/g),r=0;r<u.length;r++)i=u[r],i=i.substr(2,i.length-4),void 0!==t[i]&&(n=n.replace(new RegExp("\\[\\["+i+"\\]\\]","g"),t[i]));return n};n.massReplace=function(n,t){var i,r;for(i in t)t.hasOwnProperty(i)&&(r=t[i],void 0===r&&(r=""),n=n.replace(i,r));return n};n.cleanFromEmpty=function(n){return n.replace(/\[\[[^\]]*\]\]/g,"")};n.addPrefix=function(t,i,r,u,f){var e,o,s,h=n.formatNumber(t,u),c="";if(0===t)return"0";if(0>t&&(c="-"),1<(t=Math.abs(t))){for(e=i.length-1;-1<e;e--)if(t>=i[e].number&&(o=t/i[e].number,s=Number(u.precision),1>s&&(s=1),r=n.roundTo(o,s),s=n.formatNumber(r,{precision:-1,decimalSeparator:u.decimalSeparator,thousandsSeparator:u.thousandsSeparator}),!f||o==r)){h=c+""+s+i[e].prefix;break}}else for(e=0;e<r.length;e++)if(t<=r[e].number){o=t/r[e].number;s=Math.abs(Math.floor(Math.log(o)*Math.LOG10E));o=n.roundTo(o,s);h=c+""+o+r[e].prefix;break}return h};n.remove=function(n){n&&n.remove()};n.getEffect=function(n){return">"==n&&(n="easeOutSine"),"<"==n&&(n="easeInSine"),"elastic"==n&&(n="easeOutElastic"),n};n.getObjById=function(n,t){for(var u,r,i=0;i<n.length;i++)if(r=n[i],r.id==t){u=r;break}return u};n.applyTheme=function(t,i,r){i||(i=n.theme);try{i=JSON.parse(JSON.stringify(i))}catch(n){}i&&i[r]&&n.extend(t,i[r])};n.isString=function(n){return"string"==typeof n};n.extend=function(n,t,i){var r;n||(n={});for(r in t)i?n.hasOwnProperty(r)||(n[r]=t[r]):n[r]=t[r];return n};n.copyProperties=function(n,t){for(var i in n)n.hasOwnProperty(i)&&"events"!=i&&void 0!==n[i]&&"function"!=typeof n[i]&&"cname"!=i&&(t[i]=n[i])};n.processObject=function(t,i,r,u){if(!1==t instanceof i&&(t=u?n.extend(new i(r),t):n.extend(t,new i(r),!0),t.listeners))for(var f in t.listeners)i=t.listeners[f],t.addListener(i.event,i.method);return t};n.fixNewLines=function(n){var t=RegExp("\\n","g");return n&&(n=n.replace(t,"<br />")),n};n.fixBrakes=function(t){if(n.isModern){var i=RegExp("<br>","g");t&&(t=t.replace(i,"\n"))}else t=n.fixNewLines(t);return t};n.deleteObject=function(t,i){if(t&&(void 0!==i&&null!==i||(i=20),0!==i))if("[object Array]"===Object.prototype.toString.call(t))for(var r=0;r<t.length;r++)n.deleteObject(t[r],i-1),t[r]=null;else if(t&&!t.tagName)try{for(r in t.theme=null,t)t[r]&&("object"==typeof t[r]&&n.deleteObject(t[r],i-1),"function"!=typeof t[r]&&(t[r]=null))}catch(n){}};n.bounce=function(n,t,i,r,u){return(t/=u)<1/2.75?7.5625*r*t*t+i:t<2/2.75?r*(7.5625*(t-=1.5/2.75)*t+.75)+i:t<2.5/2.75?r*(7.5625*(t-=2.25/2.75)*t+.9375)+i:r*(7.5625*(t-=2.625/2.75)*t+.984375)+i};n.easeInOutQuad=function(n,t,i,r,u){return 1>(t/=u/2)?r/2*t*t+i:(t--,-r/2*(t*(t-2)-1)+i)};n.easeInSine=function(n,t,i,r,u){return-r*Math.cos(t/u*(Math.PI/2))+r+i};n.easeOutSine=function(n,t,i,r,u){return r*Math.sin(t/u*(Math.PI/2))+i};n.easeOutElastic=function(n,t,i,r,u){n=1.70158;var f=0,e=r;return 0===t?i:1==(t/=u)?i+r:(f||(f=.3*u),e<Math.abs(r)?(e=r,n=f/4):n=f/(2*Math.PI)*Math.asin(r/e),e*Math.pow(2,-10*t)*Math.sin(2*(t*u-n)*Math.PI/f)+r+i)};n.fixStepE=function(t){t=t.toExponential(0).split("e");var i=Number(t[1]);return 9==Number(t[0])&&i++,n.generateNumber(1,i)};n.generateNumber=function(n,t){for(var i="",u=0>t?Math.abs(t)-1:Math.abs(t),r=0;r<u;r++)i+="0";return 0>t?Number("0."+i+String(n)):Number(String(n)+i)};n.setCN=function(n,t,i,r){if(n.addClassNames&&t&&(t=t.node)&&i){var u=t.getAttribute("class");n=n.classNamePrefix+"-";r&&(n="");u?t.setAttribute("class",u+" "+n+i):t.setAttribute("class",n+i)}};n.removeCN=function(n,t,i){t&&(t=t.node)&&i&&(t=t.classList)&&t.remove(n.classNamePrefix+"-"+i)};n.parseDefs=function(t,i){var r,u,f;for(r in t)if(u=typeof t[r],0<t[r].length&&"object"==u)for(f=0;f<t[r].length;f++)u=document.createElementNS(n.SVG_NS,r),i.appendChild(u),n.parseDefs(t[r][f],u);else"object"==u?(u=document.createElementNS(n.SVG_NS,r),i.appendChild(u),n.parseDefs(t[r],u)):i.setAttribute(r,t[r])}}(),function(){var n=window.HistoryMaps;n.AmDraw=n.Class({construct:function(t,i,r,u){n.SVG_NS="http://www.w3.org/2000/svg";n.SVG_XLINK="http://www.w3.org/1999/xlink";n.hasSVG=!!document.createElementNS&&!!document.createElementNS(n.SVG_NS,"svg").createSVGRect;1>i&&(i=10);1>r&&(r=10);this.div=t;this.width=i;this.height=r;this.rBin=document.createElement("div");n.hasSVG?(n.SVG=!0,i=this.createSvgElement("svg"),t.appendChild(i),this.container=i,this.addDefs(u),this.R=new n.SVGRenderer(this)):n.isIE&&n.VMLRenderer&&(n.VML=!0,n.vmlStyleSheet||(document.namespaces.add("amvml","urn:schemas-microsoft-com:vml"),31>document.styleSheets.length?(i=document.createStyleSheet(),i.addRule(".amvml","behavior:url(#default#VML); display:inline-block; antialias:true"),n.vmlStyleSheet=i):document.styleSheets[0].addRule(".amvml","behavior:url(#default#VML); display:inline-block; antialias:true")),this.container=t,this.R=new n.VMLRenderer(this,u),this.R.disableSelection(t))},createSvgElement:function(t){return document.createElementNS(n.SVG_NS,t)},circle:function(t,i,r,u){var f=new n.AmDObject("circle",this);return f.attr({r:r,cx:t,cy:i}),this.addToContainer(f.node,u),f},ellipse:function(t,i,r,u,f){var e=new n.AmDObject("ellipse",this);return e.attr({rx:r,ry:u,cx:t,cy:i}),this.addToContainer(e.node,f),e},setSize:function(n,t){0<n&&0<t&&(this.container.style.width=n+"px",this.container.style.height=t+"px")},rect:function(t,i,r,u,f,e,o){var s=new n.AmDObject("rect",this);return n.VML&&(f=Math.round(100*f/Math.min(r,u)),r+=2*e,u+=2*e,s.bw=e,s.node.style.marginLeft=-e,s.node.style.marginTop=-e),1>r&&(r=1),1>u&&(u=1),s.attr({x:t,y:i,width:r,height:u,rx:f,ry:f,"stroke-width":e}),this.addToContainer(s.node,o),s},image:function(t,i,r,u,f,e){var o=new n.AmDObject("image",this);return o.attr({x:i,y:r,width:u,height:f}),this.R.path(o,t),this.addToContainer(o.node,e),o},addToContainer:function(n,t){t||(t=this.container);t.appendChild(n)},text:function(n,t,i){return this.R.text(n,t,i)},path:function(t,i,r,u){var f=new n.AmDObject("path",this);return u||(u="100,100"),f.attr({cs:u}),r?f.attr({dd:t}):f.attr({d:t}),this.addToContainer(f.node,i),f},set:function(n){return this.R.set(n)},remove:function(n){if(n){var t=this.rBin;t.appendChild(n);t.innerHTML=""}},renderFix:function(){var i=this.container,n=i.style;n.top="0px";n.left="0px";try{var t=i.getBoundingClientRect(),r=t.left-Math.round(t.left),u=t.top-Math.round(t.top);r&&(n.left=r+"px");u&&(n.top=u+"px")}catch(i){}},update:function(){this.R.update()},addDefs:function(t){var r,i,u;n.hasSVG&&(r=this.createSvgElement("desc"),i=this.container,(i.setAttribute("version","1.1"),i.style.position="absolute",this.setSize(this.width,this.height),t.accessibleTitle)&&(u=this.createSvgElement("text"),i.appendChild(u),u.innerHTML=t.accessibleTitle,u.style.opacity=0),n.rtl&&(i.setAttribute("direction","rtl"),i.style.left="auto",i.style.right="0px"),t&&(t.addCodeCredits&&r.appendChild(document.createTextNode("JavaScript chart by amCharts "+t.version)),i.appendChild(r),t.defs&&(r=this.createSvgElement("defs"),i.appendChild(r),n.parseDefs(t.defs,r),this.defs=r)))}})}(),function(){var n=window.HistoryMaps;n.AmDObject=n.Class({construct:function(n,t){this.D=t;this.R=t.R;this.node=this.R.create(this,n);this.y=this.x=0;this.scale=1},attr:function(n){return this.R.attr(this,n),this},getAttr:function(n){return this.node.getAttribute(n)},setAttr:function(n,t){return this.R.setAttr(this,n,t),this},clipRect:function(n,t,i,r){this.R.clipRect(this,n,t,i,r)},translate:function(n,t,i,r){r||(n=Math.round(n),t=Math.round(t));this.R.move(this,n,t,i);this.x=n;this.y=t;this.scale=i;this.angle&&this.rotate(this.angle)},rotate:function(n,t){this.R.rotate(this,n,t);this.angle=n},animate:function(t,i,r){var u,f,e;for(u in t)t.hasOwnProperty(u)&&(f=u,e=t[u],r=n.getEffect(r),this.R.animate(this,f,e,i,r))},push:function(n){var t,i;n&&(t=this.node,t.appendChild(n.node),i=n.clipPath,i&&t.appendChild(i),(n=n.grad)&&t.appendChild(n))},text:function(n){this.R.setText(this,n)},remove:function(){this.stop();this.R.remove(this)},clear:function(){var n=this.node;if(n.hasChildNodes())for(;1<=n.childNodes.length;)n.removeChild(n.firstChild)},hide:function(){this.setAttr("visibility","hidden")},show:function(){this.setAttr("visibility","visible")},getBBox:function(){return this.R.getBBox(this)},toFront:function(){var n=this.node,t;n&&(this.prevNextNode=n.nextSibling,t=n.parentNode,t&&t.appendChild(n))},toPrevious:function(){var n=this.node;n&&this.prevNextNode&&(n=n.parentNode)&&n.insertBefore(this.prevNextNode,null)},toBack:function(){var n=this.node,t,i;n&&(this.prevNextNode=n.nextSibling,t=n.parentNode,t&&(i=t.firstChild,i&&t.insertBefore(n,i)))},mouseover:function(n){return this.R.addListener(this,"mouseover",n),this},mouseout:function(n){return this.R.addListener(this,"mouseout",n),this},click:function(n){return this.R.addListener(this,"click",n),this},dblclick:function(n){return this.R.addListener(this,"dblclick",n),this},mousedown:function(n){return this.R.addListener(this,"mousedown",n),this},mouseup:function(n){return this.R.addListener(this,"mouseup",n),this},touchmove:function(n){return this.R.addListener(this,"touchmove",n),this},touchstart:function(n){return this.R.addListener(this,"touchstart",n),this},touchend:function(n){return this.R.addListener(this,"touchend",n),this},keyup:function(n){return this.R.addListener(this,"keyup",n),this},focus:function(n){return this.R.addListener(this,"focus",n),this},blur:function(n){return this.R.addListener(this,"blur",n),this},contextmenu:function(n){return this.node.addEventListener?this.node.addEventListener("contextmenu",n,!0):this.R.addListener(this,"contextmenu",n),this},stop:function(){n.removeFromArray(this.R.animations,this.an_translate);n.removeFromArray(this.R.animations,this.an_y);n.removeFromArray(this.R.animations,this.an_x)},length:function(){return this.node.childNodes.length},gradient:function(n,t,i){this.R.gradient(this,n,t,i)},pattern:function(n,t,i){n&&this.R.pattern(this,n,t,i)}})}(),function(){var n=window.HistoryMaps;n.SVGRenderer=n.Class({construct:function(n){this.D=n;this.animations=[]},create:function(t,i){return document.createElementNS(n.SVG_NS,i)},attr:function(n,t){for(var i in t)t.hasOwnProperty(i)&&this.setAttr(n,i,t[i])},setAttr:function(n,t,i){void 0!==i&&n.node.setAttribute(t,i)},animate:function(t,i,r,u,f){t.animationFinished=!1;var e=t.node;t["an_"+i]&&n.removeFromArray(this.animations,t["an_"+i]);"translate"==i?(e=(e=e.getAttribute("transform"))?String(e).substring(10,e.length-1):"0,0",e=e.split(", ").join(" "),0===(e=e.split(" ").join(","))&&(e="0,0")):e=Number(e.getAttribute(i));r={obj:t,frame:0,attribute:i,from:e,to:r,time:u,effect:f};this.animations.push(r);t["an_"+i]=r},update:function(){for(var c=this.animations,e=c.length-1;0<=e;e--){var r,i,u,t=c[e],o=t.time*n.updateRate,s=t.frame+1,h=t.obj,f=t.attribute;if(s<=o){if(t.frame++,"translate"==f){if(r=t.from.split(","),f=Number(r[0]),r=Number(r[1]),isNaN(r)&&(r=0),i=t.to.split(","),u=Number(i[0]),i=Number(i[1]),u=0==u-f?u:Math.round(n[t.effect](0,s,f,u-f,o)),t=0==i-r?i:Math.round(n[t.effect](0,s,r,i-r,o)),f="transform",isNaN(u)||isNaN(t))continue;t="translate("+u+","+t+")"}else i=Number(t.from),r=Number(t.to),u=r-i,t=n[t.effect](0,s,i,u,o),isNaN(t)&&(t=r),0===u&&this.animations.splice(e,1);this.setAttr(h,f,t)}else"translate"==f?(i=t.to.split(","),u=Number(i[0]),i=Number(i[1]),h.translate(u,i)):(r=Number(t.to),this.setAttr(h,f,r)),h.animationFinished=!0,this.animations.splice(e,1)}},getBBox:function(n){if(n=n.node)try{return n.getBBox()}catch(n){}return{width:0,height:0,x:0,y:0}},path:function(t,i){t.node.setAttributeNS(n.SVG_XLINK,"xlink:href",i)},clipRect:function(t,i,r,u,f){var e=t.node,o=t.clipPath,s;o&&this.D.remove(o);s=e.parentNode;s&&(e=document.createElementNS(n.SVG_NS,"clipPath"),o=n.getUniqueId(),e.setAttribute("id",o),this.D.rect(i,r,u,f,0,0,e),s.appendChild(e),i="#",n.baseHref&&!n.isIE&&(i=this.removeTarget(window.location.href)+i),this.setAttr(t,"clip-path","url("+i+o+")"),this.clipPathC++,t.clipPath=e)},text:function(t,i,r){var u=new n.AmDObject("text",this.D),f,o,e;for(t=String(t).split("\n"),o=n.removePx(i["font-size"]),f=0;f<t.length;f++)e=this.create(null,"tspan"),e.appendChild(document.createTextNode(t[f])),e.setAttribute("y",(o+2)*f+Math.round(o/2)),e.setAttribute("x",0),u.node.appendChild(e);return u.node.setAttribute("y",Math.round(o/2)),this.attr(u,i),this.D.addToContainer(u.node,r),u},setText:function(n,t){var i=n.node;i&&(i.removeChild(i.firstChild),i.appendChild(document.createTextNode(t)))},move:function(n,t,i,r){isNaN(t)&&(t=0);isNaN(i)&&(i=0);t="translate("+t+","+i+")";r&&(t=t+" scale("+r+")");this.setAttr(n,"transform",t)},rotate:function(n,t){var r=n.node.getAttribute("transform"),i="rotate("+t+")";r&&(i=r+" "+i);this.setAttr(n,"transform",i)},set:function(t){var r=new n.AmDObject("g",this.D),i;if(this.D.container.appendChild(r.node),t)for(i=0;i<t.length;i++)r.push(t[i]);return r},addListener:function(n,t,i){n.node["on"+t]=i},gradient:function(t,i,r,u){var s=t.node,e=t.grad;if(e&&this.D.remove(e),i=document.createElementNS(n.SVG_NS,i),e=n.getUniqueId(),i.setAttribute("id",e),!isNaN(u)){var f=0,o=0,h=0,c=0;90==u?h=100:270==u?c=100:180==u?f=100:0===u&&(o=100);i.setAttribute("x1",f+"%");i.setAttribute("x2",o+"%");i.setAttribute("y1",h+"%");i.setAttribute("y2",c+"%")}for(u=0;u<r.length;u++)f=document.createElementNS(n.SVG_NS,"stop"),o=100*u/(r.length-1),0===u&&(o=0),f.setAttribute("offset",o+"%"),f.setAttribute("stop-color",r[u]),i.appendChild(f);s.parentNode.appendChild(i);r="#";n.baseHref&&!n.isIE&&(r=this.removeTarget(window.location.href)+r);s.setAttribute("fill","url("+r+e+")");t.grad=i},removeTarget:function(n){return n.split("#")[0]},pattern:function(t,i,r,u){var c=t.node,f,h,o,s;isNaN(r)&&(r=1);f=t.patternNode;f&&this.D.remove(f);var f=document.createElementNS(n.SVG_NS,"pattern"),l=n.getUniqueId(),e=i;i.url&&(e=i.url);n.isAbsolute(e)||-1!=e.indexOf("data:image")||(e=u+e);u=Number(i.width);isNaN(u)&&(u=4);h=Number(i.height);isNaN(h)&&(h=4);u/=r;h/=r;r=i.x;isNaN(r)&&(r=0);o=-Math.random()*Number(i.randomX);isNaN(o)||(r=o);o=i.y;isNaN(o)&&(o=0);s=-Math.random()*Number(i.randomY);isNaN(s)||(o=s);f.setAttribute("id",l);f.setAttribute("width",u);f.setAttribute("height",h);f.setAttribute("patternUnits","userSpaceOnUse");f.setAttribute("xlink:href",e);i.color&&(s=document.createElementNS(n.SVG_NS,"rect"),s.setAttributeNS(null,"height",u),s.setAttributeNS(null,"width",h),s.setAttributeNS(null,"fill",i.color),f.appendChild(s));this.D.image(e,0,0,u,h,f).translate(r,o);e="#";n.baseHref&&!n.isIE&&(e=this.removeTarget(window.location.href)+e);c.setAttribute("fill","url("+e+l+")");t.patternNode=f;c.parentNode.appendChild(f)},remove:function(n){n.clipPath&&this.D.remove(n.clipPath);n.grad&&this.D.remove(n.grad);n.patternNode&&this.D.remove(n.patternNode);this.D.remove(n.node)}})}(),function(){var n=window.HistoryMaps;n.HistoryMap=n.Class({construct:function(t){this.svgIcons=this.tapToActivate=!0;this.theme=t;this.classNamePrefix="historymaps";this.addClassNames=!1;this.version="3.20.20";n.addChart(this);this.createEvents("buildStarted","dataUpdated","init","rendered","drawn","failed","resized","animationFinished");this.height=this.width="100%";this.dataChanged=!0;this.chartCreated=!1;this.previousWidth=this.previousHeight=0;this.backgroundColor="#FFFFFF";this.borderAlpha=this.backgroundAlpha=0;this.color=this.borderColor="#000000";this.fontFamily="Verdana";this.fontSize=11;this.usePrefixes=!1;this.autoResize=!0;this.autoDisplay=!1;this.addCodeCredits=this.accessible=!0;this.touchStartTime=this.touchClickDuration=0;this.precision=-1;this.percentPrecision=2;this.decimalSeparator=".";this.thousandsSeparator=",";this.labels=[];this.allLabels=[];this.titles=[];this.marginRight=this.marginLeft=this.autoMarginOffset=0;this.timeOuts=[];this.creditsPosition="top-left";var r=document.createElement("div"),i=r.style;i.overflow="hidden";i.position="relative";i.textAlign="left";this.chartDiv=r;r=document.createElement("div");i=r.style;i.overflow="hidden";i.position="relative";i.textAlign="left";this.legendDiv=r;this.titleHeight=0;this.hideBalloonTime=150;this.handDrawScatter=2;this.cssScale=this.handDrawThickness=1;this.cssAngle=0;this.prefixesOfBigNumbers=[{number:1e3,prefix:"k"},{number:1e6,prefix:"M"},{number:1e9,prefix:"G"},{number:1e12,prefix:"T"},{number:1e15,prefix:"P"},{number:1e18,prefix:"E"},{number:1e21,prefix:"Z"},{number:1e24,prefix:"Y"}];this.prefixesOfSmallNumbers=[{number:1e-24,prefix:"y"},{number:1e-21,prefix:"z"},{number:1e-18,prefix:"a"},{number:1e-15,prefix:"f"},{number:1e-12,prefix:"p"},{number:1e-9,prefix:"n"},{number:1e-6,prefix:"Î¼"},{number:.001,prefix:"m"}];this.panEventsEnabled=!0;this.product="historymaps";this.animations=[];this.balloon=new n.AmBalloon(this.theme);this.balloon.chart=this;this.processTimeout=0;this.processCount=1e3;this.animatable=[];this.langObj={};n.applyTheme(this,t,"HistoryMap")},drawChart:function(){0<this.realWidth&&0<this.realHeight&&(this.drawBackground(),this.redrawLabels(),this.drawTitles(),this.brr(),this.renderFix(),this.chartDiv&&(this.boundingRect=this.chartDiv.getBoundingClientRect()))},makeAccessible:function(n,t,i){this.accessible&&n&&(i&&n.setAttr("role",i),n.setAttr("aria-label",t),n.setAttr("class","countryArea"))},drawBackground:function(){var r,u;n.remove(this.background);var i=this.container,t=this.backgroundColor,f=this.backgroundAlpha,e=this.set;n.isModern||0!==f||(f=.001);r=this.updateWidth();this.realWidth=r;u=this.updateHeight();this.realHeight=u;t=n.polygon(i,[0,r-1,r-1,0],[0,0,u-1,u-1],t,f,1,this.borderColor,this.borderAlpha);n.setCN(this,t,"bg");this.background=t;e.push(t);(t=this.backgroundImage)&&(i=i.image(t,0,0,r,u),n.setCN(this,t,"bg-image"),this.bgImg=i,e.push(i))},drawTitles:function(t){var o=this.titles,u,f,i,r,e,s,h;if(this.titleHeight=0,n.ifArray(o)){for(f=20,u=0;u<o.length;u++)i=o[u],i=n.processObject(i,n.Title,this.theme),!1!==i.enabled&&(r=i.color,void 0===r&&(r=this.color),e=i.size,isNaN(e)&&(e=this.fontSize+2),isNaN(i.alpha),s=this.marginLeft,h=!0,void 0!==i.bold&&(h=i.bold),r=n.wrappedText(this.container,i.text,r,this.fontFamily,e,"middle",h,this.realWidth-35),r.translate(s+(this.realWidth-this.marginRight-s)/2,f),r.node.style.pointerEvents="none",i.sprite=r,void 0!==i.tabIndex&&r.setAttr("tabindex",i.tabIndex),n.setCN(this,r,"title"),i.id&&n.setCN(this,r,"title-"+i.id),r.attr({opacity:i.alpha}),f+=r.getBBox().height+5,t?r.remove():this.freeLabelsSet.push(r));this.titleHeight=f-10}},write:function(n){var t=this,i,r;if(t.listeners)for(i=0;i<t.listeners.length;i++)r=t.listeners[i],t.addListener(r.event,r.method);t.fire({type:"buildStarted",chart:t});t.afterWriteTO&&clearTimeout(t.afterWriteTO);0<t.processTimeout?t.afterWriteTO=setTimeout(function(){t.afterWrite.call(t,n)},t.processTimeout):t.afterWrite(n)},afterWrite:function(t){var f,s,i;if(f="object"!=typeof t?document.getElementById(t):t){for(;f.firstChild;)f.removeChild(f.firstChild);this.div=f;f.style.overflow="hidden";f.style.textAlign="left";t=this.chartDiv;var o=this.legendDiv,r=this.legend,u=o.style,e=t.style;if(this.measure(),this.previousHeight=this.divRealHeight,this.previousWidth=this.divRealWidth,i=document.createElement("div"),s=i.style,s.position="relative",this.containerDiv=i,i.className=this.classNamePrefix+"-main-div",t.className=this.classNamePrefix+"-chart-div",f.appendChild(i),(f=this.exportConfig)&&n.AmExport&&!this.AmExport&&(this.AmExport=new n.AmExport(this,f)),this.amExport&&n.AmExport&&(this.AmExport=n.extend(this.amExport,new n.AmExport(this),!0)),this.AmExport&&this.AmExport.init&&this.AmExport.init(),r){if(r=this.addLegend(r,r.divId),r.enabled)switch(u.left=null,u.top=null,u.right=null,e.left=null,e.right=null,e.top=null,u.position="relative",e.position="relative",s.width="100%",s.height="100%",r.position){case"bottom":i.appendChild(t);i.appendChild(o);break;case"top":i.appendChild(o);i.appendChild(t);break;case"absolute":u.position="absolute";e.position="absolute";void 0!==r.left&&(u.left=r.left+"px");void 0!==r.right&&(u.right=r.right+"px");void 0!==r.top&&(u.top=r.top+"px");void 0!==r.bottom&&(u.bottom=r.bottom+"px");r.marginLeft=0;r.marginRight=0;i.appendChild(t);i.appendChild(o);break;case"right":u.position="relative";e.position="absolute";i.appendChild(t);i.appendChild(o);break;case"left":u.position="absolute";e.position="relative";i.appendChild(t);i.appendChild(o);break;case"outside":i.appendChild(t)}else i.appendChild(t);this.prevLegendPosition=r.position}else i.appendChild(t);this.listenersAdded||(this.addListeners(),this.listenersAdded=!0);this.initChart()}},createLabelsSet:function(){n.remove(this.labelsSet);this.labelsSet=this.container.set();this.freeLabelsSet.push(this.labelsSet)},initChart:function(){this.balloon=n.processObject(this.balloon,n.AmBalloon,this.theme);window.HistoryMaps_path&&(this.path=window.HistoryMaps_path);void 0===this.path&&(this.path=n.getPath());void 0===this.path&&(this.path="historymaps/");this.path=n.normalizeUrl(this.path);void 0===this.pathToImages&&(this.pathToImages=this.path+"images/");this.initHC||(n.callInitHandler(this),this.initHC=!0);n.applyLang(this.language,this);var t=this.numberFormatter;t&&(isNaN(t.precision)||(this.precision=t.precision),void 0!==t.thousandsSeparator&&(this.thousandsSeparator=t.thousandsSeparator),void 0!==t.decimalSeparator&&(this.decimalSeparator=t.decimalSeparator));(t=this.percentFormatter)&&!isNaN(t.precision)&&(this.percentPrecision=t.precision);this.nf={precision:this.precision,thousandsSeparator:this.thousandsSeparator,decimalSeparator:this.decimalSeparator};this.pf={precision:this.percentPrecision,thousandsSeparator:this.thousandsSeparator,decimalSeparator:this.decimalSeparator};this.destroy();(t=this.container)?(t.container.innerHTML="",t.width=this.realWidth,t.height=this.realHeight,t.addDefs(this),this.chartDiv.appendChild(t.container)):t=new n.AmDraw(this.chartDiv,this.realWidth,this.realHeight,this);this.container=t;this.extension=".png";this.svgIcons&&n.SVG&&(this.extension=".svg");this.checkDisplay();this.checkTransform(this.div);t.chart=this;n.VML||n.SVG?(t.handDrawn=this.handDrawn,t.handDrawScatter=this.handDrawScatter,t.handDrawThickness=this.handDrawThickness,n.remove(this.set),this.set=t.set(),n.remove(this.gridSet),this.gridSet=t.set(),n.remove(this.cursorLineSet),this.cursorLineSet=t.set(),n.remove(this.graphsBehindSet),this.graphsBehindSet=t.set(),n.remove(this.bulletBehindSet),this.bulletBehindSet=t.set(),n.remove(this.columnSet),this.columnSet=t.set(),n.remove(this.graphsSet),this.graphsSet=t.set(),n.remove(this.trendLinesSet),this.trendLinesSet=t.set(),n.remove(this.axesSet),this.axesSet=t.set(),n.remove(this.cursorSet),this.cursorSet=t.set(),n.remove(this.scrollbarsSet),this.scrollbarsSet=t.set(),n.remove(this.bulletSet),this.bulletSet=t.set(),n.remove(this.freeLabelsSet),this.freeLabelsSet=t.set(),n.remove(this.axesLabelsSet),this.axesLabelsSet=t.set(),n.remove(this.balloonsSet),this.balloonsSet=t.set(),n.remove(this.plotBalloonsSet),this.plotBalloonsSet=t.set(),n.remove(this.zoomButtonSet),this.zoomButtonSet=t.set(),n.remove(this.zbSet),this.zbSet=null,n.remove(this.linkSet),this.linkSet=t.set()):this.fire({type:"failed",chart:this})},premeasure:function(){var n=this.div,t,i;if(n){try{this.boundingRect=this.chartDiv.getBoundingClientRect()}catch(n){}t=n.offsetWidth;i=n.offsetHeight;n.clientHeight&&(t=n.clientWidth,i=n.clientHeight);t==this.mw&&i==this.mh||(this.mw=t,this.mh=i,this.measure())}},measure:function(){var t=this.div;if(t){var f=this.chartDiv,i=t.offsetWidth,r=t.offsetHeight,e=this.container;t.clientHeight&&(i=t.clientWidth,r=t.clientHeight);var r=Math.round(r),i=Math.round(i),t=Math.round(n.toCoordinate(this.width,i)),u=Math.round(n.toCoordinate(this.height,r));(i!=this.previousWidth||r!=this.previousHeight)&&0<t&&0<u&&(f.style.width=t+"px",f.style.height=u+"px",f.style.padding=0,e&&e.setSize(t,u),this.balloon=n.processObject(this.balloon,n.AmBalloon,this.theme));this.balloon&&this.balloon.setBounds&&this.balloon.setBounds(2,2,t-2,u);this.updateWidth();this.balloon.chart=this;this.realWidth=t;this.realHeight=u;this.divRealWidth=i;this.divRealHeight=r}},checkDisplay:function(){if(this.autoDisplay&&this.container){var t=n.rect(this.container,10,10),i=t.getBBox();0===i.width&&0===i.height&&(this.divRealHeight=this.divRealWidth=this.realHeight=this.realWidth=0,this.previousWidth=this.previousHeight=NaN);t.remove()}},checkTransform:function(n){var t;if(this.autoTransform&&window.getComputedStyle&&n){if(n.style&&(t=window.getComputedStyle(n,null),t&&(t=t.getPropertyValue("-webkit-transform")||t.getPropertyValue("-moz-transform")||t.getPropertyValue("-ms-transform")||t.getPropertyValue("-o-transform")||t.getPropertyValue("transform"))&&"none"!==t)){var i=t.split("(")[1].split(")")[0].split(","),t=i[0],i=i[1],t=Math.sqrt(t*t+i*i);isNaN(t)||(this.cssScale*=t)}n.parentNode&&this.checkTransform(n.parentNode)}},destroy:function(){this.chartDiv.innerHTML="";this.clearTimeOuts();this.legend&&this.legend.destroy()},clearTimeOuts:function(){var t=this.timeOuts,n;if(t)for(n=0;n<t.length;n++)clearTimeout(t[n]);this.timeOuts=[]},clear:function(t){try{document.removeEventListener("touchstart",this.docfn1,!0);document.removeEventListener("touchend",this.docfn2,!0)}catch(n){}if(n.callMethod("clear",[this.chartScrollbar,this.scrollbarV,this.scrollbarH,this.chartCursor]),this.chartCursor=this.scrollbarH=this.scrollbarV=this.chartScrollbar=null,this.clearTimeOuts(),this.container&&(this.container.remove(this.chartDiv),this.container.remove(this.legendDiv)),t||n.removeChart(this),t=this.div)for(;t.firstChild;)t.removeChild(t.firstChild);this.legend&&this.legend.destroy();this.AmExport&&this.AmExport.clear&&this.AmExport.clear()},setMouseCursor:function(t){"auto"==t&&n.isNN&&(t="default");this.chartDiv.style.cursor=t;this.legendDiv.style.cursor=t},redrawLabels:function(){var t,n;for(this.labels=[],t=this.allLabels,this.createLabelsSet(),n=0;n<t.length;n++)this.drawLabel(t[n])},drawLabel:function(t){var i=this;if(i.container&&!1!==t.enabled){t=n.processObject(t,n.Label,i.theme);var f=t.y,r=t.text,u=t.align,s=t.size,h=t.color,e=t.rotation,c=t.alpha,l=t.bold,o=n.toCoordinate(t.x,i.realWidth),f=n.toCoordinate(f,i.realHeight);o||(o=0);f||(f=0);void 0===h&&(h=i.color);isNaN(s)&&(s=i.fontSize);u||(u="start");"left"==u&&(u="start");"right"==u&&(u="end");"center"==u&&(u="middle",e?f=i.realHeight-f+f/2:o=i.realWidth/2-o);void 0===c&&(c=1);void 0===e&&(e=0);f+=s/2;r=n.text(i.container,r,h,i.fontFamily,s,u,l,c);r.translate(o,f);void 0!==t.tabIndex&&r.setAttr("tabindex",t.tabIndex);n.setCN(i,r,"label");t.id&&n.setCN(i,r,"label-"+t.id);0!==e&&r.rotate(e);t.url?(r.setAttr("cursor","pointer"),r.click(function(){n.getURL(t.url,i.urlTarget)})):r.node.style.pointerEvents="none";i.labelsSet.push(r);i.labels.push(r)}},addLabel:function(n,t,i,r,u,f,e,o,s,h){n={x:n,y:t,text:i,align:r,size:u,color:f,alpha:o,rotation:e,bold:s,url:h,enabled:!0};this.container&&this.drawLabel(n);this.allLabels.push(n)},clearLabels:function(){for(var t=this.labels,n=t.length-1;0<=n;n--)t[n].remove();this.labels=[];this.allLabels=[]},updateHeight:function(){var n=this.divRealHeight,t=this.legend,i;return t&&(i=this.legendDiv.offsetHeight,t=t.position,"top"!=t&&"bottom"!=t||(n-=i,(0>n||isNaN(n))&&(n=0),this.chartDiv.style.height=n+"px")),n},updateWidth:function(){var n=this.divRealWidth,e=this.divRealHeight,t=this.legend,i,r;if(t){i=this.legendDiv;r=i.offsetWidth;isNaN(t.width)||(r=t.width);t.ieW&&(r=t.ieW);var o=i.offsetHeight,i=i.style,u=this.chartDiv.style,f=t.position;"right"!=f&&"left"!=f||void 0!==t.divId||(n-=r,(0>n||isNaN(n))&&(n=0),u.width=n+"px",this.balloon.setBounds(2,2,n-2,this.realHeight),"left"==f?(u.left=r+"px",i.left="0px"):(u.left="0px",i.left=n+"px"),e>o&&(i.top=(e-o)/2+"px"))}return n},getTitleHeight:function(){return this.drawTitles(!0),this.titleHeight},addTitle:function(n,t,i,r,u){return isNaN(t)&&(t=this.fontSize+2),n={text:n,size:t,color:i,alpha:r,bold:u,enabled:!0},this.titles.push(n),n},handleWheel:function(n){var t=0;n||(n=window.event);n.wheelDelta?t=n.wheelDelta/120:n.detail&&(t=-n.detail/3);t&&this.handleWheelReal(t,n.shiftKey);n.preventDefault&&n.preventDefault()},handleWheelReal:function(){},handleDocTouchStart:function(){this.handleMouseMove();this.tmx=this.mouseX;this.tmy=this.mouseY;this.touchStartTime=(new Date).getTime()},handleDocTouchEnd:function(){-.5<this.tmx&&this.tmx<this.divRealWidth+1&&0<this.tmy&&this.tmy<this.divRealHeight?(this.handleMouseMove(),4>Math.abs(this.mouseX-this.tmx)&&4>Math.abs(this.mouseY-this.tmy)?(this.tapped=!0,this.panRequired&&this.panEventsEnabled&&this.chartDiv&&(this.chartDiv.style.msTouchAction="none",this.chartDiv.style.touchAction="none")):this.mouseIsOver||this.resetTouchStyle()):(this.tapped=!1,this.resetTouchStyle())},resetTouchStyle:function(){this.panEventsEnabled&&this.chartDiv&&(this.chartDiv.style.msTouchAction="auto",this.chartDiv.style.touchAction="auto")},checkTouchDuration:function(n){var t=this,i=(new Date).getTime();if(n)if(n.touches)t.isTouchEvent=!0;else if(!t.isTouchEvent)return!0;if(i-t.touchStartTime>t.touchClickDuration)return!0;setTimeout(function(){t.resetTouchDuration()},300)},resetTouchDuration:function(){this.isTouchEvent=!1},checkTouchMoved:function(){if(4<Math.abs(this.mouseX-this.tmx)||4<Math.abs(this.mouseY-this.tmy))return!0},addListeners:function(){var n=this,t=n.chartDiv;document.addEventListener?("ontouchstart"in document.documentElement&&(t.addEventListener("touchstart",function(t){n.handleTouchStart.call(n,t)},!0),t.addEventListener("touchmove",function(t){n.handleMouseMove.call(n,t)},!0),t.addEventListener("touchend",function(t){n.handleTouchEnd.call(n,t)},!0),n.docfn1=function(t){n.handleDocTouchStart.call(n,t)},n.docfn2=function(t){n.handleDocTouchEnd.call(n,t)},document.addEventListener("touchstart",n.docfn1,!0),document.addEventListener("touchend",n.docfn2,!0)),t.addEventListener("mousedown",function(t){n.mouseIsOver=!0;n.handleMouseMove.call(n,t);n.handleMouseDown.call(n,t);n.handleDocTouchStart.call(n,t)},!0),t.addEventListener("mouseover",function(t){n.handleMouseOver.call(n,t)},!0),t.addEventListener("mouseout",function(t){n.handleMouseOut.call(n,t)},!0),t.addEventListener("mouseup",function(t){n.handleDocTouchEnd.call(n,t)},!0)):(t.attachEvent("onmousedown",function(t){n.handleMouseDown.call(n,t)}),t.attachEvent("onmouseover",function(t){n.handleMouseOver.call(n,t)}),t.attachEvent("onmouseout",function(t){n.handleMouseOut.call(n,t)}))},dispDUpd:function(){this.skipEvents||(this.dispatchDataUpdated&&(this.dispatchDataUpdated=!1,this.fire({type:"dataUpdated",chart:this})),this.chartCreated||(this.chartCreated=!0,this.fire({type:"init",chart:this})),this.chartRendered||(this.fire({type:"rendered",chart:this}),this.chartRendered=!0),this.fire({type:"drawn",chart:this}));this.skipEvents=!1},validateSize:function(){var n=this,t,i;(n.premeasure(),n.checkDisplay(),n.cssScale=1,n.cssAngle=0,n.checkTransform(n.div),n.divRealWidth!=n.previousWidth||n.divRealHeight!=n.previousHeight)&&(t=n.legend,0<n.realWidth&&0<n.realHeight&&((n.sizeChanged=!0,t)&&(n.legendInitTO&&clearTimeout(n.legendInitTO),i=setTimeout(function(){t.invalidateSize()},10),n.timeOuts.push(i),n.legendInitTO=i),n.marginsUpdated=!1,clearTimeout(n.initTO),i=setTimeout(function(){n.initChart()},10),n.timeOuts.push(i),n.initTO=i),n.renderFix(),t&&t.renderFix&&t.renderFix(),clearTimeout(n.resizedTO),n.resizedTO=setTimeout(function(){n.fire({type:"resized",chart:n})},10),n.previousHeight=n.divRealHeight,n.previousWidth=n.divRealWidth)},invalidateSize:function(){this.previousHeight=this.previousWidth=NaN;this.invalidateSizeReal()},invalidateSizeReal:function(){var n=this,t;n.marginsUpdated=!1;clearTimeout(n.validateTO);t=setTimeout(function(){n.validateSize()},5);n.timeOuts.push(t);n.validateTO=t},validateData:function(n){this.chartCreated&&(this.dataChanged=!0,this.marginsUpdated=!1,this.initChart(n))},validateNow:function(n,t){this.initTO&&clearTimeout(this.initTO);n&&(this.dataChanged=!0,this.marginsUpdated=!1);this.skipEvents=t;this.chartRendered=!1;var i=this.legend;i&&i.position!=this.prevLegendPosition&&(this.previousWidth=this.mw=0,i.invalidateSize&&(i.invalidateSize(),this.validateSize()));this.write(this.div)},showItem:function(n){n.hidden=!1;this.initChart()},hideItem:function(n){n.hidden=!0;this.initChart()},hideBalloon:function(){var n=this;clearTimeout(n.hoverInt);clearTimeout(n.balloonTO);n.hoverInt=setTimeout(function(){n.hideBalloonReal.call(n)},n.hideBalloonTime)},cleanChart:function(){},hideBalloonReal:function(){var n=this.balloon;n&&n.hide&&n.hide()},showBalloon:function(n,t,i,r,u){var f=this;clearTimeout(f.balloonTO);clearTimeout(f.hoverInt);f.balloonTO=setTimeout(function(){f.showBalloonReal.call(f,n,t,i,r,u)},1)},showBalloonReal:function(n,t,i,r,u){this.handleMouseMove();var f=this.balloon;f.enabled&&(f.followCursor(!1),f.changeColor(t),!i||f.fixedPosition?(f.setPosition(r,u),isNaN(r)||isNaN(u)?f.followCursor(!0):f.followCursor(!1)):f.followCursor(!0),n&&f.showBalloon(n))},handleMouseOver:function(){this.outTO&&clearTimeout(this.outTO);n.resetMouseOver();this.mouseIsOver=!0},handleMouseOut:function(){var t=this;n.resetMouseOver();t.outTO&&clearTimeout(t.outTO);t.outTO=setTimeout(function(){t.handleMouseOutReal()},10)},handleMouseOutReal:function(){this.mouseIsOver=!1},handleMouseMove:function(n){var t,i,r,u,f;if(n||(n=window.event),this.mouse2Y=this.mouse2X=NaN,n){if(n.touches){if(f=n.touches.item(1),f&&this.panEventsEnabled&&this.boundingRect&&(r=f.clientX-this.boundingRect.left,u=f.clientY-this.boundingRect.top),!(n=n.touches.item(0)))return}else this.wasTouched=!1;this.boundingRect&&n.clientX&&(t=n.clientX-this.boundingRect.left,i=n.clientY-this.boundingRect.top);isNaN(r)?this.mouseX=t:(this.mouseX=Math.min(t,r),this.mouse2X=Math.max(t,r));isNaN(u)?this.mouseY=i:(this.mouseY=Math.min(i,u),this.mouse2Y=Math.max(i,u));this.autoTransform&&(this.mouseX/=this.cssScale,this.mouseY/=this.cssScale)}},handleTouchStart:function(n){this.hideBalloonReal();n&&(n.touches&&this.tapToActivate&&!this.tapped||!this.panRequired)||(this.handleMouseMove(n),this.handleMouseDown(n))},handleTouchEnd:function(t){this.wasTouched=!0;this.handleMouseMove(t);n.resetMouseOver();this.handleReleaseOutside(t)},handleReleaseOutside:function(){this.handleDocTouchEnd.call(this)},handleMouseDown:function(t){n.resetMouseOver();this.mouseIsOver=!0;t&&t.preventDefault&&(this.panEventsEnabled?t.preventDefault():t.touches||t.preventDefault())},addLegend:function(t,i){t=n.processObject(t,n.AmLegend,this.theme);t.divId=i;t.ieW=0;var r;return r="object"!=typeof i&&i?document.getElementById(i):i,this.legend=t,t.chart=this,r?(t.div=r,t.position="outside",t.autoMargins=!1):t.div=this.legendDiv,t},removeLegend:function(){this.legend=void 0;this.previousWidth=0;this.legendDiv.innerHTML=""},handleResize:function(){(n.isPercents(this.width)||n.isPercents(this.height))&&this.invalidateSizeReal();this.renderFix()},renderFix:function(){if(!n.VML){var t=this.container;t&&t.renderFix()}},getSVG:function(){if(n.hasSVG)return this.container},animate:function(t,i,r,u,f,e,o){return t["an_"+i]&&n.removeFromArray(this.animations,t["an_"+i]),r={obj:t,frame:0,attribute:i,from:r,to:u,time:f,effect:e,suffix:o},t["an_"+i]=r,this.animations.push(r),r},setLegendData:function(n){var t=this.legend;t&&t.setData(n)},stopAnim:function(t){n.removeFromArray(this.animations,t)},updateAnimations:function(){var i;if(this.container&&this.container.update(),this.animations)for(i=this.animations.length-1;0<=i;i--){var t=this.animations[i],u=n.updateRate*t.time,e=t.frame+1,r=t.obj,f=t.attribute;if(e<=u){t.frame++;var o=Number(t.from),s=Number(t.to)-o,u=n[t.effect](0,e,o,s,u);0===s?(this.animations.splice(i,1),r.node.style[f]=Number(t.to)+t.suffix):r.node.style[f]=u+t.suffix}else r.node.style[f]=Number(t.to)+t.suffix,r.animationFinished=!0,this.animations.splice(i,1)}},update:function(){var n,i,t,r;if(this.updateAnimations(),n=this.animatable,0<n.length){for(i=!0,t=n.length-1;0<=t;t--)r=n[t],r&&(r.animationFinished?n.splice(t,1):i=!1);i&&(this.fire({type:"animationFinished",chart:this}),this.animatable=[])}},inIframe:function(){try{return window.self!==window.top}catch(n){return!0}},brr:function(){var u,n,i;if(!this.hideCredits&&(n="historymaps.com",i=window.location.hostname.split("."),2<=i.length&&(u=i[i.length-2]+"."+i[i.length-1]),this.amLink&&(i=this.amLink.parentNode)&&i.removeChild(this.amLink),i=this.creditsPosition,u!=n||!0===this.inIframe())){var n="http://www."+n,e=u=0,o=this.realWidth,s=this.realHeight,t=this.type;"serial"!=t&&"xy"!=t&&"gantt"!=t||(u=this.marginLeftReal,e=this.marginTopReal,o=u+this.plotAreaWidth,s=e+this.plotAreaHeight);var t=n+"/2017/",f="",r="HistoryMap";"historymap"==this.product&&(t=n+"/Wold-HistoryMap/",f="Interactive World Map",r="HistoryMap Project 2017");n=document.createElement("a");r=document.createTextNode(r);n.target="_blank";n.setAttribute("href",t);n.setAttribute("title",f);this.urlTarget&&n.setAttribute("target",this.urlTarget);n.appendChild(r);this.chartDiv.appendChild(n);this.amLink=n;t=n.style;t.position="absolute";t.textDecoration="none";t.color=this.color;t.fontFamily=this.fontFamily;t.fontSize="11px";t.opacity=.7;t.display="block";var f=n.offsetWidth,n=n.offsetHeight,r=5+u;"bottom-left"==i&&(r=5+u,s-n-3);"bottom-right"==i&&(r=o-f-5,s-n-3);"top-right"==i&&(r=o-f-5,e+5);t.left=r+"px";t.bottom=r+"px"}}});n.Slice=n.Class({construct:function(){}});n.SerialDataItem=n.Class({construct:function(){}});n.GraphDataItem=n.Class({construct:function(){}});n.Guide=n.Class({construct:function(t){this.cname="Guide";n.applyTheme(this,t,this.cname)}});n.Title=n.Class({construct:function(t){this.cname="Title";n.applyTheme(this,t,this.cname)}});n.Label=n.Class({construct:function(t){this.cname="Label";n.applyTheme(this,t,this.cname)}})}(),function(){var n=window.HistoryMaps;n.AmBalloon=n.Class({construct:function(t){this.cname="AmBalloon";this.enabled=!0;this.fillColor="#FFFFFF";this.fillAlpha=.8;this.borderThickness=2;this.borderColor="#FFFFFF";this.borderAlpha=1;this.cornerRadius=0;this.maxWidth=220;this.horizontalPadding=8;this.verticalPadding=4;this.pointerWidth=6;this.pointerOrientation="V";this.color="#000000";this.adjustBorderColor=!0;this.show=this.follow=this.showBullet=!1;this.bulletSize=3;this.shadowAlpha=.4;this.shadowColor="#000000";this.fadeOutDuration=this.animationDuration=.3;this.fixedPosition=!0;this.offsetY=6;this.offsetX=1;this.textAlign="center";this.disableMouseEvents=!0;this.deltaSignX=this.deltaSignY=1;n.isModern||(this.offsetY*=1.5);this.sdy=this.sdx=0;n.applyTheme(this,t,this.cname)},draw:function(){var f=this.pointToX,o=this.pointToY,a,s,p,i,r,rt,ut,st,t;if(n.isModern||(this.drop=!1),a=this.chart,n.VML&&(this.fadeOutDuration=0),this.xAnim&&a.stopAnim(this.xAnim),this.yAnim&&a.stopAnim(this.yAnim),this.sdy=this.sdx=0,!isNaN(f)){var ot=this.follow,v=a.container,y=this.set;if(n.remove(y),this.removeDiv(),y=v.set(),y.node.style.pointerEvents="none",this.set=y,this.mainSet?(this.mainSet.push(this.set),this.sdx=this.mainSet.x,this.sdy=this.mainSet.y):a.balloonsSet.push(y),this.show){var e=this.l,b=this.t,w=this.r,g=this.b,s=this.balloonColor,c=this.fillColor,it=this.borderColor,nt=c;void 0!=s&&(this.adjustBorderColor?nt=it=s:c=s);var k=this.horizontalPadding,tt=this.verticalPadding,h=this.pointerWidth,l=this.pointerOrientation,d=this.cornerRadius,u=a.fontFamily,t=this.fontSize;void 0==t&&(t=a.fontSize);s=document.createElement("div");p=a.classNamePrefix;s.className=p+"-balloon-div";this.className&&(s.className=s.className+" "+p+"-balloon-div-"+this.className);p=s.style;this.disableMouseEvents&&(p.pointerEvents="none");p.position="absolute";i=this.minWidth;r="";isNaN(i)||(r="min-width:"+(i-2*k)+"px; ");s.innerHTML='<div style="text-align:'+this.textAlign+"; "+r+"max-width:"+this.maxWidth+"px; font-size:"+t+"px; color:"+this.color+"; font-family:"+u+'">'+this.text+"<\/div>";a.chartDiv.appendChild(s);this.textDiv=s;rt=s.offsetWidth;ut=s.offsetHeight;s.clientHeight&&(rt=s.clientWidth,ut=s.clientHeight);u=ut+2*tt;r=rt+2*k;!isNaN(i)&&r<i&&(r=i);window.opera&&(u+=2);st=!1;t=this.offsetY;a.handDrawn&&(t+=a.handDrawScatter+2);"H"!=l?(i=f-r/2,o<b+u+10&&"down"!=l?(st=!0,ot&&(o+=t),t=o+h,this.deltaSignY=-1):(ot&&(o-=t),t=o-u-h,this.deltaSignY=1)):(2*h>u&&(h=u/2),t=o-u/2,f<e+(w-e)/2?(i=f+h,this.deltaSignX=-1):(i=f-r-h,this.deltaSignX=1));t+u>=g&&(t=g-u);t<b&&(t=b);i<e&&(i=e);i+r>w&&(i=w-r);var ft,b=t+tt,g=i+k,et=this.shadowAlpha,ct=this.shadowColor,k=this.borderThickness,lt=this.bulletSize,tt=this.fillAlpha,ht=this.borderAlpha;this.showBullet&&(ft=n.circle(v,lt,nt,tt),y.push(ft));this.drop?(e=r/1.6,w=0,"V"==l&&(l="down"),"H"==l&&(l="left"),"down"==l&&(i=f+1,t=o-e-e/3),"up"==l&&(w=180,i=f+1,t=o+e+e/3),"left"==l&&(w=270,i=f+e+e/3+2,t=o),"right"==l&&(w=90,i=f-e-e/3+2,t=o),b=t-ut/2+1,g=i-rt/2-1,c=n.drop(v,e,w,c,tt,k,it,ht)):0<d||0===h?(0<et&&(f=n.rect(v,r,u,c,0,k+1,ct,et,d),n.isModern?f.translate(1,1):f.translate(4,4),y.push(f)),c=n.rect(v,r,u,c,tt,k,it,ht,d)):(nt=[],d=[],"H"!=l?(e=f-i,e>r-h&&(e=r-h),e<h&&(e=h),nt=[0,e-h,f-i,e+h,r,r,0,0],d=st?[0,0,o-t,0,0,u,u,0]:[u,u,o-t,u,u,0,0,u]):(l=o-t,l>u-h&&(l=u-h),l<h&&(l=h),d=[0,l-h,o-t,l+h,u,u,0,0],nt=f<e+(w-e)/2?[0,0,i<f?0:f-i,0,0,r,r,0]:[r,r,i+r>f?r:f-i,r,r,0,0,r]),0<et&&(f=n.polygon(v,nt,d,c,0,k,ct,et),f.translate(1,1),y.push(f)),c=n.polygon(v,nt,d,c,tt,k,it,ht));this.bg=c;y.push(c);c.toFront();n.setCN(a,c,"balloon-bg");this.className&&n.setCN(a,c,"balloon-bg-"+this.className);v=1*this.deltaSignX;g+=this.sdx;b+=this.sdy;p.left=g+"px";p.top=b+"px";y.translate(i-v,t,1,!0);c=c.getBBox();this.bottom=t+u+1;this.yPos=c.y+t;ft&&ft.translate(this.pointToX-i+v,o-t);o=this.animationDuration;0<this.animationDuration&&!ot&&!isNaN(this.prevX)&&(y.translate(this.prevX,this.prevY,NaN,!0),y.animate({translate:i-v+","+t},o,"easeOutSine"),s&&(p.left=this.prevTX+"px",p.top=this.prevTY+"px",this.xAnim=a.animate({node:s},"left",this.prevTX,g,o,"easeOutSine","px"),this.yAnim=a.animate({node:s},"top",this.prevTY,b,o,"easeOutSine","px")));this.prevX=i-v;this.prevY=t;this.prevTX=g;this.prevTY=b}}},fixPrevious:function(){this.rPrevX=this.prevX;this.rPrevY=this.prevY;this.rPrevTX=this.prevTX;this.rPrevTY=this.prevTY},restorePrevious:function(){this.prevX=this.rPrevX;this.prevY=this.rPrevY;this.prevTX=this.rPrevTX;this.prevTY=this.rPrevTY},followMouse:function(){var n,t,i;if(this.follow&&this.show&&(n=this.chart.mouseX-this.offsetX*this.deltaSignX-this.sdx,t=this.chart.mouseY-this.sdy,this.pointToX=n,this.pointToY=t,n!=this.previousX||t!=this.previousY))if(this.previousX=n,this.previousY=t,0===this.cornerRadius)this.draw();else if(i=this.set,i){var r=i.getBBox(),n=n-r.width/2,u=t-r.height-10;n<this.l&&(n=this.l);n>this.r-r.width&&(n=this.r-r.width);u<this.t&&(u=t+10);i.translate(n,u);t=this.textDiv.style;t.left=n+this.horizontalPadding+"px";t.top=u+this.verticalPadding+"px"}},changeColor:function(n){this.balloonColor=n},setBounds:function(n,t,i,r){this.l=n;this.t=t;this.r=i;this.b=r;this.destroyTO&&clearTimeout(this.destroyTO)},showBalloon:function(n){(this.text!=n||this.positionChanged)&&(this.text=n,this.isHiding=!1,this.show=!0,this.destroyTO&&clearTimeout(this.destroyTO),n=this.chart,this.fadeAnim1&&n.stopAnim(this.fadeAnim1),this.fadeAnim2&&n.stopAnim(this.fadeAnim2),this.draw(),this.positionChanged=!1)},hide:function(n){var t=this,r,i;t.text=void 0;isNaN(n)&&(n=t.fadeOutDuration);r=t.chart;0<n&&!t.isHiding?(t.isHiding=!0,t.destroyTO&&clearTimeout(t.destroyTO),t.destroyTO=setTimeout(function(){t.destroy.call(t)},1e3*n),t.follow=!1,t.show=!1,i=t.set,i&&(i.setAttr("opacity",t.fillAlpha),t.fadeAnim1=i.animate({opacity:0},n,"easeInSine")),t.textDiv&&(t.fadeAnim2=r.animate({node:t.textDiv},"opacity",1,0,n,"easeInSine",""))):(t.show=!1,t.follow=!1,t.destroy())},setPosition:function(n,t){n==this.pointToX&&t==this.pointToY||(this.previousX=this.pointToX,this.previousY=this.pointToY,this.pointToX=n,this.pointToY=t,this.positionChanged=!0)},followCursor:function(n){var t=this,i,r;t.follow=n;clearInterval(t.interval);i=t.chart.mouseX-t.sdx;r=t.chart.mouseY-t.sdy;!isNaN(i)&&n&&(t.pointToX=i-t.offsetX*t.deltaSignX,t.pointToY=r,t.followMouse(),t.interval=setInterval(function(){t.followMouse.call(t)},40))},removeDiv:function(){if(this.textDiv){var n=this.textDiv.parentNode;n&&n.removeChild(this.textDiv)}},destroy:function(){clearInterval(this.interval);n.remove(this.set);this.removeDiv();this.set=null}})}(),function(){var n=window.HistoryMaps;n.circle=function(t,i,r,u,f,e,o,s,h){return 0>=i&&(i=.001),void 0!=f&&0!==f||(f=.01),void 0===e&&(e="#000000"),void 0===o&&(o=0),u={fill:r,stroke:e,"fill-opacity":u,"stroke-width":f,"stroke-opacity":o},t=isNaN(h)?t.circle(0,0,i).attr(u):t.ellipse(0,0,i,h).attr(u),s&&t.gradient("radialGradient",[r,n.adjustLuminosity(r,-.6)]),t};n.text=function(t,i,r,u,f,e,o,s){return e||(e="middle"),"right"==e&&(e="end"),"left"==e&&(e="start"),isNaN(s)&&(s=1),void 0!==i&&(i=String(i),n.isIE&&!n.isModern&&(i=i.replace("&amp;","&"),i=i.replace("&","&amp;"))),r={fill:r,"font-family":u,"font-size":f+"px",opacity:s},!0===o&&(r["font-weight"]="bold"),r["text-anchor"]=e,t.text(i,r)};n.polygon=function(t,i,r,u,f,e,o,s,h,c,l){var v,y,a;for(isNaN(e)&&(e=.01),isNaN(s)&&(s=f),v=u,y=!1,"object"==typeof v&&1<v.length&&(y=!0,v=v[0]),void 0===o&&(o=v),f={fill:v,stroke:o,"fill-opacity":f,"stroke-width":e,"stroke-opacity":s},void 0!==l&&0<l&&(f["stroke-dasharray"]=l),l=n.dx,e=n.dy,t.handDrawn&&(r=n.makeHD(i,r,t.handDrawScatter),i=r[0],r=r[1]),o=Math.round,c&&(i[a]=n.roundTo(i[a],5),r[a]=n.roundTo(r[a],5),o=Number),s="M"+(o(i[0])+l)+","+(o(r[0])+e),a=1;a<i.length;a++)c&&(i[a]=n.roundTo(i[a],5),r[a]=n.roundTo(r[a],5)),s+=" L"+(o(i[a])+l)+","+(o(r[a])+e);return t=t.path(s+" Z").attr(f),y&&t.gradient("linearGradient",u,h),t};n.rect=function(t,i,r,u,f,e,o,s,h,c,l){var a,p,v,y;return isNaN(i)||isNaN(r)?t.set():(isNaN(e)&&(e=0),void 0===h&&(h=0),void 0===c&&(c=270),isNaN(f)&&(f=0),a=u,p=!1,"object"==typeof a&&(a=a[0],p=!0),void 0===o&&(o=a),void 0===s&&(s=f),i=Math.round(i),r=Math.round(r),v=0,y=0,0>i&&(i=Math.abs(i),v=-i),0>r&&(r=Math.abs(r),y=-r),v+=n.dx,y+=n.dy,f={fill:a,stroke:o,"fill-opacity":f,"stroke-opacity":s},void 0!==l&&0<l&&(f["stroke-dasharray"]=l),t=t.rect(v,y,i,r,h,e).attr(f),p&&t.gradient("linearGradient",u,c),t)};n.bullet=function(t,i,r,u,f,e,o,s,h,c,l,a,v){var y;switch("circle"==i&&(i="round"),i){case"round":y=n.circle(t,r/2,u,f,e,o,s);break;case"square":y=n.polygon(t,[-r/2,r/2,r/2,-r/2],[r/2,r/2,-r/2,-r/2],u,f,e,o,s,c-180,void 0,v);break;case"rectangle":y=n.polygon(t,[-r,r,r,-r],[r/2,r/2,-r/2,-r/2],u,f,e,o,s,c-180,void 0,v);break;case"diamond":y=n.polygon(t,[-r/2,0,r/2,0],[0,-r/2,0,r/2],u,f,e,o,s);break;case"triangleUp":y=n.triangle(t,r,0,u,f,e,o,s);break;case"triangleDown":y=n.triangle(t,r,180,u,f,e,o,s);break;case"triangleLeft":y=n.triangle(t,r,270,u,f,e,o,s);break;case"triangleRight":y=n.triangle(t,r,90,u,f,e,o,s);break;case"bubble":y=n.circle(t,r/2,u,f,e,o,s,!0);break;case"line":y=n.line(t,[-r/2,r/2],[0,0],u,f,e,o,s);break;case"yError":y=t.set();y.push(n.line(t,[0,0],[-r/2,r/2],u,f,e));y.push(n.line(t,[-h,h],[-r/2,-r/2],u,f,e));y.push(n.line(t,[-h,h],[r/2,r/2],u,f,e));break;case"xError":y=t.set();y.push(n.line(t,[-r/2,r/2],[0,0],u,f,e));y.push(n.line(t,[-r/2,-r/2],[-h,h],u,f,e));y.push(n.line(t,[r/2,r/2],[-h,h],u,f,e))}return y&&y.pattern(l,NaN,a),y};n.triangle=function(n,t,i,r,u,f,e,o){void 0!==f&&0!==f||(f=1);void 0===e&&(e="#000");void 0===o&&(o=0);r={fill:r,stroke:e,"fill-opacity":u,"stroke-width":f,"stroke-opacity":o};t/=2;var s;return 0===i&&(s=" M"+-t+","+t+" L0,"+-t+" L"+t+","+t+" Z"),180==i&&(s=" M"+-t+","+-t+" L0,"+t+" L"+t+","+-t+" Z"),90==i&&(s=" M"+-t+","+-t+" L"+t+",0 L"+-t+","+t+" Z"),270==i&&(s=" M"+-t+",0 L"+t+","+t+" L"+t+","+-t+" Z"),n.path(s).attr(r)};n.line=function(t,i,r,u,f,e,o,s,h,c,l){if(t.handDrawn&&!l)return n.handDrawnLine(t,i,r,u,f,e,o,s,h,c,l);for(e={fill:"none","stroke-width":e},void 0!==o&&0<o&&(e["stroke-dasharray"]=o),isNaN(f)||(e["stroke-opacity"]=f),u&&(e.stroke=u),u=Math.round,c&&(u=Number,i[0]=n.roundTo(i[0],5),r[0]=n.roundTo(r[0],5)),c=n.dx,f=n.dy,o="M"+(u(i[0])+c)+","+(u(r[0])+f),s=1;s<i.length;s++)i[s]=n.roundTo(i[s],5),r[s]=n.roundTo(r[s],5),o+=" L"+(u(i[s])+c)+","+(u(r[s])+f);return n.VML?t.path(o,void 0,!0).attr(e):(h&&(o+=" M0,0 L0,0"),t.path(o).attr(e))};n.makeHD=function(n,t,i){for(var a,c=[],l=[],r=1;r<n.length;r++)for(var f=Number(n[r-1]),e=Number(t[r-1]),o=Number(n[r]),s=Number(t[r]),h=Math.round(Math.sqrt(Math.pow(o-f,2)+Math.pow(s-e,2))/50)+1,o=(o-f)/h,s=(s-e)/h,u=0;u<=h;u++)a=e+u*s+Math.random()*i,c.push(f+u*o+Math.random()*i),l.push(a);return[c,l]};n.handDrawnLine=function(t,i,r,u,f,e,o,s,h,c){for(var p=t.set(),l=1;l<i.length;l++)for(var y=[i[l-1],i[l]],v=[r[l-1],r[l]],v=n.makeHD(y,v,t.handDrawScatter),y=v[0],v=v[1],a=1;a<y.length;a++)p.push(n.line(t,[y[a-1],y[a]],[v[a-1],v[a]],u,f,e+Math.random()*t.handDrawThickness-t.handDrawThickness/2,o,s,h,c,!0));return p};n.doNothing=function(n){return n};n.drop=function(n,t,i,r,u,f,e,o){var s=1/180*Math.PI,h=i-20,v=Math.sin(h*s)*t,y=Math.cos(h*s)*t,p=Math.sin((h+40)*s)*t,w=Math.cos((h+40)*s)*t,a=.8*t,c=-t/3,l=t/3;return 0===i&&(c=-c,l=0),180==i&&(l=0),90==i&&(c=0),270==i&&(c=0,l=-l),i={fill:r,stroke:e,"stroke-width":f,"stroke-opacity":o,"fill-opacity":u},t="M"+v+","+y+" A"+t+","+t+",0,1,1,"+p+","+w+" A"+a+","+a+",0,0,0,"+(Math.sin((h+20)*s)*t+l)+","+(Math.cos((h+20)*s)*t+c),t+=" A"+a+","+a+",0,0,0,"+v+","+y,n.path(t,void 0,void 0,"1000,1000").attr(i)};n.wedge=function(t,i,r,u,f,e,o,s,h,c,l,a,v,y){var p=Math.round,st,ut,ct,ht,lt;e=p(e);o=p(o);s=p(s);var k=p(o/e*s),et=n.VML,b=359.5+e/100;359.94<b&&(b=359.94);f>=b&&(f=b);var w=1/180*Math.PI,b=i+Math.sin(u*w)*s,d=r-Math.cos(u*w)*k,g=i+Math.sin(u*w)*e,nt=r-Math.cos(u*w)*o,tt=i+Math.sin((u+f)*w)*e,it=r-Math.cos((u+f)*w)*o,rt=i+Math.sin((u+f)*w)*s,w=r-Math.cos((u+f)*w)*k,ft={fill:n.adjustLuminosity(c.fill,-.2),"stroke-opacity":0,"fill-opacity":c["fill-opacity"]},ot=0;if(180<Math.abs(f)&&(ot=1),u=t.set(),et&&(b=p(10*b),g=p(10*g),tt=p(10*tt),rt=p(10*rt),d=p(10*d),nt=p(10*nt),it=p(10*it),w=p(10*w),i=p(10*i),h=p(10*h),r=p(10*r),e*=10,o*=10,s*=10,k*=10,1>Math.abs(f)&&1>=Math.abs(tt-g)&&1>=Math.abs(it-nt)&&(st=!0)),f="",a&&(ft["fill-opacity"]=0,ft["stroke-opacity"]=c["stroke-opacity"]/2,ft.stroke=c.stroke),0<h){for(ut=" M"+b+","+(d+h)+" L"+g+","+(nt+h),et?(st||(ut+=" A"+(i-e)+","+(h+r-o)+","+(i+e)+","+(h+r+o)+","+g+","+(nt+h)+","+tt+","+(it+h)),ut+=" L"+rt+","+(w+h),0<s&&(st||(ut+=" B"+(i-s)+","+(h+r-k)+","+(i+s)+","+(h+r+k)+","+rt+","+(h+w)+","+b+","+(h+d)))):(ut+=" A"+e+","+o+",0,"+ot+",1,"+tt+","+(it+h)+" L"+rt+","+(w+h),0<s&&(ut+=" A"+s+","+k+",0,"+ot+",0,"+b+","+(d+h))),ut+=" Z",ct=h,et&&(ct/=10),ht=0;ht<ct;ht+=10)lt=t.path(ut,void 0,void 0,"1000,1000").attr(ft),u.push(lt),lt.translate(0,-ht);ut=t.path(" M"+b+","+d+" L"+b+","+(d+h)+" L"+g+","+(nt+h)+" L"+g+","+nt+" L"+b+","+d+" Z",void 0,void 0,"1000,1000").attr(ft);h=t.path(" M"+tt+","+it+" L"+tt+","+(it+h)+" L"+rt+","+(w+h)+" L"+rt+","+w+" L"+tt+","+it+" Z",void 0,void 0,"1000,1000").attr(ft);u.push(ut);u.push(h)}if(et?(st||(f=" A"+p(i-e)+","+p(r-o)+","+p(i+e)+","+p(r+o)+","+p(g)+","+p(nt)+","+p(tt)+","+p(it)),o=" M"+p(b)+","+p(d)+" L"+p(g)+","+p(nt)+f+" L"+p(rt)+","+p(w)):o=" M"+b+","+d+" L"+g+","+nt+" A"+e+","+o+",0,"+ot+",1,"+tt+","+it+" L"+rt+","+w,0<s&&(et?st||(o+=" B"+(i-s)+","+(r-k)+","+(i+s)+","+(r+k)+","+rt+","+w+","+b+","+d):o+=" A"+s+","+k+",0,"+ot+",0,"+b+","+d),t.handDrawn&&(s=n.line(t,[b,g],[d,nt],c.stroke,c.thickness*Math.random()*t.handDrawThickness,c["stroke-opacity"]),u.push(s)),t=t.path(o+" Z",void 0,void 0,"1000,1000").attr(c),l){for(s=[],k=0;k<l.length;k++)s.push(n.adjustLuminosity(c.fill,l[k]));"radial"!=y||n.isModern||(s=[]);0<s.length&&t.gradient(y+"Gradient",s)}return n.isModern&&"radial"==y&&t.grad&&(t.grad.setAttribute("gradientUnits","userSpaceOnUse"),t.grad.setAttribute("r",e),t.grad.setAttribute("cx",i),t.grad.setAttribute("cy",r)),t.pattern(a,NaN,v),u.wedge=t,u.push(t),u};n.rgb2hex=function(n){return(n=n.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?/i))&&4===n.length?"#"+("0"+parseInt(n[1],10).toString(16)).slice(-2)+("0"+parseInt(n[2],10).toString(16)).slice(-2)+("0"+parseInt(n[3],10).toString(16)).slice(-2):""};n.adjustLuminosity=function(t,i){t&&-1!=t.indexOf("rgb")&&(t=n.rgb2hex(t));t=String(t).replace(/[^0-9a-f]/gi,"");6>t.length&&(t=String(t[0])+String(t[0])+String(t[1])+String(t[1])+String(t[2])+String(t[2]));i=i||0;for(var r,f="#",u=0;3>u;u++)r=parseInt(t.substr(2*u,2),16),r=Math.round(Math.min(Math.max(0,r+r*i),255)).toString(16),f+=("00"+r).substr(r.length);return f}}(),function(){var n=window.HistoryMaps;n.AmLegend=n.Class({construct:function(t){this.enabled=!0;this.cname="AmLegend";this.createEvents("rollOverMarker","rollOverItem","rollOutMarker","rollOutItem","showItem","hideItem","clickMarker","clickLabel");this.position="bottom";this.borderColor=this.color="#000000";this.borderAlpha=0;this.markerLabelGap=5;this.verticalGap=10;this.align="left";this.horizontalGap=0;this.spacing=10;this.markerDisabledColor="#AAB3B3";this.markerType="square";this.markerSize=16;this.markerBorderThickness=this.markerBorderAlpha=1;this.marginBottom=this.marginTop=0;this.marginLeft=this.marginRight=20;this.autoMargins=!0;this.valueWidth=50;this.switchable=!0;this.switchType="x";this.switchColor="#FFFFFF";this.rollOverColor="#CC0000";this.reversedOrder=!1;this.labelText="[[title]]";this.valueText="[[value]]";this.accessibleLabel="[[title]]";this.useMarkerColorForLabels=!1;this.rollOverGraphAlpha=1;this.textClickEnabled=!1;this.equalWidths=!0;this.backgroundColor="#FFFFFF";this.backgroundAlpha=0;this.useGraphSettings=!1;this.showEntries=!0;this.labelDx=0;n.applyTheme(this,t,this.cname)},setData:function(n){this.legendData=n;this.invalidateSize()},invalidateSize:function(){this.destroy();this.entries=[];this.valueLabels=[];var t=this.legendData;this.enabled&&(n.ifArray(t)||n.ifArray(this.data))&&this.drawLegend()},drawLegend:function(){var t=this.chart,r=this.position,u=this.width,s=t.divRealWidth,i=t.divRealHeight,f=this.div,e=this.legendData,o;if((this.data&&(e=this.combineLegend?this.legendData.concat(this.data):this.data),isNaN(this.fontSize)&&(this.fontSize=t.fontSize),this.maxColumnsReal=this.maxColumns,"right"==r||"left"==r)?(this.maxColumnsReal=1,this.autoMargins&&(this.marginLeft=this.marginRight=10)):this.autoMargins&&(this.marginRight=t.marginRight,this.marginLeft=t.marginLeft,o=t.autoMarginOffset,"bottom"==r?(this.marginBottom=o,this.marginTop=0):(this.marginTop=o,this.marginBottom=0)),u=void 0!==u?n.toCoordinate(u,s):"right"!=r&&"left"!=r?t.realWidth:0<this.ieW?this.ieW:t.realWidth,"outside"==r?(u=f.offsetWidth,i=f.offsetHeight,f.clientHeight&&(u=f.clientWidth,i=f.clientHeight)):(isNaN(u)||(f.style.width=u+"px"),f.className="amChartsLegend "+t.classNamePrefix+"-legend-div"),this.divWidth=u,(r=this.container)?(r.container.innerHTML="",f.appendChild(r.container),r.width=u,r.height=i,r.setSize(u,i),r.addDefs(t)):r=new n.AmDraw(f,u,i,t),this.container=r,this.lx=0,this.ly=8,i=this.markerSize,i>this.fontSize&&(this.ly=i/2-1),0<i&&(this.lx+=i+this.markerLabelGap),this.titleWidth=0,(i=this.title)&&(i=n.text(this.container,i,this.color,t.fontFamily,this.fontSize,"start",!0),n.setCN(t,i,"legend-title"),i.translate(this.marginLeft,this.marginTop+this.verticalGap+this.ly+1),t=i.getBBox(),this.titleWidth=t.width+15,this.titleHeight=t.height+6),this.index=this.maxLabelWidth=0,this.showEntries){for(t=0;t<e.length;t++)this.createEntry(e[t]);for(t=this.index=0;t<e.length;t++)this.createValue(e[t])}this.arrangeEntries();this.updateValues()},arrangeEntries:function(){var f=this.position,e=this.marginLeft+this.titleWidth,c=this.marginRight,o=this.marginTop,ut=this.marginBottom,s=this.horizontalGap,tt=this.div,y=this.divWidth,h=this.maxColumnsReal,nt=this.verticalGap,i=this.spacing,ft=y-c-e,it=0,p=0,rt=this.container,w,b,t,r,l,u,g,v;for(this.set&&this.set.remove(),w=rt.set(),this.set=w,b=rt.set(),w.push(b),l=this.entries,r=0;r<l.length;r++)t=l[r].getBBox(),u=t.width,u>it&&(it=u),t=t.height,t>p&&(p=t);var u=p=0,k=s,d=0,a=0;for(r=0;r<l.length;r++)g=l[r],this.reversedOrder&&(g=l[l.length-r-1]),t=g.getBBox(),this.equalWidths?v=u*(it+i+this.markerLabelGap):(v=k,k=k+t.width+s+i),v+t.width>ft&&0<r&&0!==u&&(p++,v=u=0,k=v+t.width+s+i,d=d+a+nt,a=0),t.height>a&&(a=t.height),g.translate(v,d),u++,!isNaN(h)&&u>=h&&(u=0,p++,d=d+a+nt,k=s,a=0),b.push(g);t=b.getBBox();h=t.height+2*nt-1;"left"==f||"right"==f?(i=t.width+2*s,y=i+e+c,tt.style.width=y+"px",this.ieW=y):i=y-e-c-1;c=n.polygon(this.container,[0,i,i,0],[0,0,h,h],this.backgroundColor,this.backgroundAlpha,1,this.borderColor,this.borderAlpha);n.setCN(this.chart,c,"legend-bg");w.push(c);w.translate(e,o);c.toBack();e=s;"top"!=f&&"bottom"!=f&&"absolute"!=f&&"outside"!=f||("center"==this.align?e=s+(i-t.width)/2:"right"==this.align&&(e=s+i-t.width));b.translate(e,nt+1);this.titleHeight>h&&(h=this.titleHeight);o=h+o+ut+1;0>o&&(o=0);"absolute"!=f&&"outside"!=f&&o>this.chart.divRealHeight&&(tt.style.top="0px");tt.style.height=Math.round(o)+"px";rt.setSize(this.divWidth,o)},createEntry:function(t){var f,b,s,u,l,y,d,h,a;if(!1!==t.visibleInLegend&&!t.hideFromLegend){var i=this,e=i.chart,v=i.useGraphSettings,p=t.markerType;p&&(v=!1);t.legendEntryWidth=i.markerSize;p||(p=i.markerType);f=t.color;b=t.alpha;t.legendKeyColor&&(f=t.legendKeyColor());t.legendKeyAlpha&&(b=t.legendKeyAlpha());!0===t.hidden&&(s=f=i.markerDisabledColor);l=t.pattern;y=t.customMarker;y||(y=i.customMarker);var o=i.container,r=i.markerSize,c=0,k=0,w=r/2;v?(v=t.type,i.switchType=void 0,"line"==v||"step"==v||"smoothedLine"==v||"ohlc"==v?(u=o.set(),t.hidden||(f=t.lineColorR,s=t.bulletBorderColorR),c=n.line(o,[0,2*r],[r/2,r/2],f,t.lineAlpha,t.lineThickness,t.dashLength),n.setCN(e,c,"graph-stroke"),u.push(c),t.bullet&&(t.hidden||(f=t.bulletColorR),c=n.bullet(o,t.bullet,t.bulletSize,f,t.bulletAlpha,t.bulletBorderThickness,s,t.bulletBorderAlpha))&&(n.setCN(e,c,"graph-bullet"),c.translate(r+1,r/2),u.push(c)),w=0,c=r,k=r/3):(t.getGradRotation&&0===(u=t.getGradRotation())&&(u=180),c=t.fillColorsR,!0===t.hidden&&(c=f),(u=i.createMarker("rectangle",c,t.fillAlphas,t.lineThickness,f,t.lineAlpha,u,l,t.dashLength))&&(w=r,u.translate(w,r/2)),c=r),n.setCN(e,u,"graph-"+v),n.setCN(e,u,"graph-"+t.id)):y?u=o.image(y,0,0,r,r):(isNaN(i.gradientRotation)||(d=180+i.gradientRotation),(u=i.createMarker(p,f,b,void 0,void 0,void 0,d,l))&&u.translate(r/2,r/2));n.setCN(e,u,"legend-marker");i.addListeners(u,t);o=o.set([u]);i.switchable&&t.switchable&&o.setAttr("cursor","pointer");void 0!==t.id&&n.setCN(e,o,"legend-item-"+t.id);n.setCN(e,o,t.className,!0);s=i.switchType;s&&"none"!=s&&0<r&&("x"==s?(h=i.createX(),h.translate(r/2,r/2)):h=i.createV(),h.dItem=t,!0!==t.hidden?"x"==s?h.hide():h.show():"x"!=s&&h.hide(),i.switchable||h.hide(),i.addListeners(h,t),t.legendSwitch=h,o.push(h),n.setCN(e,h,"legend-switch"));s=i.color;t.showBalloon&&i.textClickEnabled&&void 0!==i.selectedColor&&(s=i.selectedColor);i.useMarkerColorForLabels&&!l&&(s=f);!0===t.hidden&&(s=i.markerDisabledColor);f=n.massReplace(i.labelText,{"[[title]]":t.title});void 0!==i.tabIndex&&(o.setAttr("tabindex",i.tabIndex),o.setAttr("role","menuitem"),o.keyup(function(n){13==n.keyCode&&i.clickMarker(t,n)}));e.accessible&&i.accessibleLabel&&(l=n.massReplace(i.accessibleLabel,{"[[title]]":t.title}),e.makeAccessible(o,l));l=i.fontSize;u&&(r<=l&&(r=r/2+i.ly-l/2+(l+2-r)/2-k,u.translate(w,r),h&&h.translate(h.x,r)),t.legendEntryWidth=u.getBBox().width);f&&(f=n.fixBrakes(f),t.legendTextReal=f,a=i.labelWidth,a=isNaN(a)?n.text(i.container,f,s,e.fontFamily,l,"start"):n.wrappedText(i.container,f,s,e.fontFamily,l,"start",!1,a,0),n.setCN(e,a,"legend-label"),a.translate(i.lx+c,i.ly),o.push(a),i.labelDx=c,e=a.getBBox().width,i.maxLabelWidth<e&&(i.maxLabelWidth=e));i.entries[i.index]=o;t.legendEntry=i.entries[i.index];t.legendMarker=u;t.legendLabel=a;i.index++}},addListeners:function(n,t){var i=this;n&&n.mouseover(function(n){i.rollOverMarker(t,n)}).mouseout(function(n){i.rollOutMarker(t,n)}).click(function(n){i.clickMarker(t,n)})},rollOverMarker:function(n,t){this.switchable&&this.dispatch("rollOverMarker",n,t);this.dispatch("rollOverItem",n,t)},rollOutMarker:function(n,t){this.switchable&&this.dispatch("rollOutMarker",n,t);this.dispatch("rollOutItem",n,t)},clickMarker:function(n,t){this.switchable&&(!0===n.hidden?this.dispatch("showItem",n,t):this.dispatch("hideItem",n,t));this.dispatch("clickMarker",n,t)},rollOverLabel:function(n,t){n.hidden||this.textClickEnabled&&n.legendLabel&&n.legendLabel.attr({fill:this.rollOverColor});this.dispatch("rollOverItem",n,t)},rollOutLabel:function(n,t){if(!n.hidden&&this.textClickEnabled&&n.legendLabel){var i=this.color;void 0!==this.selectedColor&&n.showBalloon&&(i=this.selectedColor);this.useMarkerColorForLabels&&void 0===(i=n.lineColor)&&(i=n.color);n.legendLabel.attr({fill:i})}this.dispatch("rollOutItem",n,t)},clickLabel:function(n,t){this.textClickEnabled?n.hidden||this.dispatch("clickLabel",n,t):this.switchable&&(!0===n.hidden?this.dispatch("showItem",n,t):this.dispatch("hideItem",n,t))},dispatch:function(n,t,i){n={type:n,dataItem:t,target:this,event:i,chart:this.chart};this.chart&&this.chart.handleLegendEvent(n);this.fire(n)},createValue:function(t){var i=this,u=i.fontSize,e=i.chart,f,o,r;if(!1!==t.visibleInLegend&&!t.hideFromLegend){if(f=i.maxLabelWidth,i.forceWidth&&(f=i.labelWidth),i.equalWidths||(i.valueAlign="left"),"left"==i.valueAlign&&t.legendLabel&&(f=t.legendLabel.getBBox().width),o=f,i.valueText&&0<i.valueWidth){r=i.color;i.useMarkerColorForValues&&(r=t.color,t.legendKeyColor&&(r=t.legendKeyColor()));!0===t.hidden&&(r=i.markerDisabledColor);var h=i.valueText,f=f+i.lx+i.labelDx+i.markerLabelGap+i.valueWidth,s="end";"left"==i.valueAlign&&(f-=i.valueWidth,s="start");r=n.text(i.container,h,r,i.chart.fontFamily,u,s);n.setCN(e,r,"legend-value");r.translate(f,i.ly);i.entries[i.index].push(r);o+=i.valueWidth+2*i.markerLabelGap;r.dItem=t;i.valueLabels.push(r)}i.index++;e=i.markerSize;e<u+7&&(e=u+7,n.VML&&(e+=3));u=i.container.rect(t.legendEntryWidth,0,o,e,0,0).attr({stroke:"none",fill:"#fff","fill-opacity":.005});u.dItem=t;i.entries[i.index-1].push(u);u.mouseover(function(n){i.rollOverLabel(t,n)}).mouseout(function(n){i.rollOutLabel(t,n)}).click(function(n){i.clickLabel(t,n)})}},createV:function(){var t=this.markerSize;return n.polygon(this.container,[t/5,t/2,t-t/5,t/2],[t/3,t-t/5,t/5,t/1.7],this.switchColor)},createX:function(){var t=(this.markerSize-4)/2,i={stroke:this.switchColor,"stroke-width":3},r=this.container,u=n.line(r,[-t,t],[-t,t]).attr(i),t=n.line(r,[-t,t],[t,-t]).attr(i);return this.container.set([u,t])},createMarker:function(t,i,r,u,f,e,o,s,h){var c=this.markerSize,l=this.container;return f||(f=this.markerBorderColor),f||(f=i),isNaN(u)&&(u=this.markerBorderThickness),isNaN(e)&&(e=this.markerBorderAlpha),n.bullet(l,t,c,i,r,u,f,e,c,o,s,this.chart.path,h)},validateNow:function(){this.invalidateSize()},updateValues:function(){var s,h=this.valueLabels,o=this.chart,l=this.data,f,t,i,r,u,c,e;if(h)for(s=0;s<h.length;s++)f=h[s],t=f.dItem,t.periodDataItem=void 0,t.periodPercentDataItem=void 0,i=" ",l?t.value?f.text(t.value):f.text(""):(r=null,void 0!==t.type?(r=t.currentDataItem,u=this.periodValueText,t.legendPeriodValueText&&(u=t.legendPeriodValueText),r?(i=this.valueText,t.legendValueText&&(i=t.legendValueText),i=o.formatString(i,r)):u&&o.formatPeriodString&&(u=n.massReplace(u,{"[[title]]":t.title}),i=o.formatPeriodString(u,t))):i=o.formatString(this.valueText,t),u=t,r&&(u=r),c=this.valueFunction,c&&(i=c(u,i,o.periodDataItem)),this.useMarkerColorForLabels&&!r&&t.lastDataItem&&(r=t.lastDataItem),r?e=o.getBalloonColor(t,r):t.legendKeyColor&&(e=t.legendKeyColor()),t.legendColorFunction&&(e=t.legendColorFunction(u,i,t.periodDataItem,t.periodPercentDataItem)),f.text(i),!t.pattern&&(this.useMarkerColorForValues&&f.setAttr("fill",e),this.useMarkerColorForLabels)&&((f=t.legendMarker)&&(f.setAttr("fill",e),f.setAttr("stroke",e)),(t=t.legendLabel)&&t.setAttr("fill",e)))},renderFix:function(){if(!n.VML&&this.enabled){var t=this.container;t&&t.renderFix()}},destroy:function(){this.div.innerHTML="";n.remove(this.set)}})}(),function(){var n=window.HistoryMaps;n.HisMap=n.Class({inherits:n.HistoryMap,construct:function(t){this.cname="HisMap";this.type="map";this.theme=t;this.svgNotSupported="This browser doesn't support SVG. Use Chrome, Firefox, Internet Explorer 9 or later.";this.createEvents("rollOverMapObject","rollOutMapObject","clickMapObject","mouseDownMapObject","selectedObjectChanged","homeButtonClicked","zoomCompleted","dragCompleted","positionChanged","writeDevInfo","click","descriptionClosed");this.zoomDuration=.6;this.zoomControl=new n.ZoomControl(t);this.fitMapToContainer=!0;this.mouseWheelZoomEnabled=this.backgroundZoomsToTop=!1;this.allowClickOnSelectedObject=this.useHandCursorOnClickableOjects=this.showBalloonOnSelectedObject=!0;this.showObjectsAfterZoom=this.wheelBusy=!1;this.zoomOnDoubleClick=this.useObjectColorForBalloon=!0;this.allowMultipleDescriptionWindows=!1;this.dragMap=this.centerMap=this.linesAboveImages=!0;this.colorSteps=5;this.forceNormalize=!1;this.showAreasInList=!0;this.showLinesInList=this.showImagesInList=!1;this.areasProcessor=new n.AreasProcessor(this);this.areasSettings=new n.AreasSettings(t);this.imagesProcessor=new n.ImagesProcessor(this);this.imagesSettings=new n.ImagesSettings(t);this.linesProcessor=new n.LinesProcessor(this);this.linesSettings=new n.LinesSettings(t);this.initialTouchZoom=1;this.showDescriptionOnHover=!1;n.HisMap.base.construct.call(this,t);this.creditsPosition="bottom-left";this.product="historymap";this.areasClasses={};n.applyTheme(this,t,this.cname)},initChart:function(){var t,i;this.zoomInstantly=!0;t=this.container;(this.panRequired=!0,this.sizeChanged&&n.hasSVG&&this.chartCreated)?(this.freeLabelsSet&&this.freeLabelsSet.remove(),this.freeLabelsSet=t.set(),this.container.setSize(this.realWidth,this.realHeight),this.resizeMap(),this.drawBackground(),this.redrawLabels(),this.drawTitles(),this.processObjects(!0),this.rescaleObjects(),this.zoomControl.init(this,t),this.drawBg(),i=this.smallMap,i&&i.init(this,t),(i=this.valueLegend)&&i.init(this,t),this.sizeChanged=!1,this.zoomToLongLat(this.zLevelTemp,this.zLongTemp,this.zLatTemp,!0),this.previousWidth=this.realWidth,this.previousHeight=this.realHeight,this.updateSmallMap(),this.linkSet.toFront(),this.zoomControl.update&&this.zoomControl.update()):(n.HisMap.base.initChart.call(this),n.hasSVG?(this.dataChanged&&(this.parseData(),this.dispatchDataUpdated=!0,this.dataChanged=!1,t=this.legend)&&(t.position="absolute",t.invalidateSize()),this.createDescriptionsDiv(),this.svgAreas=[],this.svgAreasById={},this.drawChart()):(this.chartDiv.style.textAlign="",this.chartDiv.setAttribute("class","historymapAlert"),this.chartDiv.innerHTML=this.svgNotSupported,this.fire({type:"failed",chart:this})))},storeTemp:function(){if(n.hasSVG&&0<this.realWidth&&0<this.realHeight){var t=this.mapContainer.getBBox();0<t.width&&0<t.height&&(t=this.zoomLongitude(),isNaN(t)||(this.zLongTemp=t),t=this.zoomLatitude(),isNaN(t)||(this.zLatTemp=t),t=this.zoomLevel(),isNaN(t)||(this.zLevelTemp=t))}},invalidateSize:function(){this.storeTemp();n.HisMap.base.invalidateSize.call(this)},validateSize:function(){this.storeTemp();n.HisMap.base.validateSize.call(this)},handleWheelReal:function(t){if(!this.wheelBusy){this.stopAnimation();var r=this.zoomLevel(),u=this.zoomControl,i=u.zoomFactor;this.wheelBusy=!0;t=n.fitToBounds(0<t?r*i:r/i,u.minZoomLevel,u.maxZoomLevel);i=this.mouseX/this.mapWidth;u=this.mouseY/this.mapHeight;i=(this.zoomX()-i)*(t/r)+i;r=(this.zoomY()-u)*(t/r)+u;this.zoomTo(t,i,r)}},addLegend:function(t,i){return t.position="absolute",t.autoMargins=!1,t.valueWidth=0,t.switchable=!1,n.HisMap.base.addLegend.call(this,t,i),void 0===t.enabled&&(t.enabled=!0),t},handleLegendEvent:function(){},createDescriptionsDiv:function(){if(!this.descriptionsDiv){var t=document.createElement("div"),n=t.style;n.position="absolute";n.left="0px";n.top="0px";this.descriptionsDiv=t}this.containerDiv.appendChild(this.descriptionsDiv)},drawChart:function(){var t,r,i;n.HisMap.base.drawChart.call(this);t=this.dataProvider;this.dataProvider=t=n.extend(t,new n.MapData,!0);this.areasSettings=n.processObject(this.areasSettings,n.AreasSettings,this.theme);this.imagesSettings=n.processObject(this.imagesSettings,n.ImagesSettings,this.theme);this.linesSettings=n.processObject(this.linesSettings,n.LinesSettings,this.theme);r=this.container;this.mapContainer&&this.mapContainer.remove();this.mapContainer=r.set();this.graphsSet.push(this.mapContainer);t.map&&(i=n.maps[t.map]);t.mapVar&&(i=t.mapVar);i?(this.svgData=i.svg,this.getBounds(),this.buildEverything()):(t=t.mapURL)&&this.loadXml(t);this.balloonsSet.toFront()},drawBg:function(){var n=this;n.background.click(function(){n.handleBackgroundClick()});n.background.mouseover(function(){n.rollOutMapObject(n.previouslyHovered)})},buildEverything:function(){var r,t,i;0<this.realWidth&&0<this.realHeight?(r=this.container,t=this.dataProvider,this.projection||(this.projection=t.projection,this.projection||(this.projection="equirectangular")),i=this.projection,i&&(this.projectionFunction=n[i]),this.projectionFunction||(this.projectionFunction=n.equirectangular),this.dpProjectionFunction=n[t.projection],this.dpProjectionFunction||(this.dpProjectionFunction=n.equirectangular),this.zoomControl=n.processObject(this.zoomControl,n.ZoomControl,this.theme),this.zoomControl.init(this,r),this.drawBg(),this.buildSVGMap(),this.projectionFunction&&i!=t.projection||this.forceNormalize?(this.normalizeMap(),this.changeProjection()):this.fixMapPosition(),(i=this.smallMap)&&(i=n.processObject(i,n.SmallMap,this.theme),i.init(this,r),this.smallMap=i),isNaN(t.zoomX)&&isNaN(t.zoomY)&&isNaN(t.zoomLatitude)&&isNaN(t.zoomLongitude)&&(this.centerMap?(i=this.xyToCoordinates(this.mapWidth/2,this.mapHeight/2),t.zoomLongitudeC=i.longitude,t.zoomLatitudeC=i.latitude):(t.zoomX=0,t.zoomY=0),this.zoomInstantly=!0),this.selectObject(this.dataProvider),this.processAreas(),(t=this.valueLegend)&&(this.valueLegend=t=n.processObject(t,n.ValueLegend,this.theme),t.init(this,r)),this.objectList&&(r=this.objectList=n.processObject(this.objectList,n.ObjectList))&&(this.clearObjectList(),r.init(this)),this.dispDUpd(),this.updateSmallMap(),this.linkSet.toFront()):this.cleanChart()},hideGroup:function(n){this.showHideGroup(n,!1)},showGroup:function(n){this.showHideGroup(n,!0)},showHideGroup:function(n,t){this.showHideReal(this.imagesProcessor.allObjects,n,t);this.showHideReal(this.areasProcessor.allObjects,n,t);this.showHideReal(this.linesProcessor.allObjects,n,t)},showHideReal:function(n,t,i){for(var r,f,u=0;u<n.length;u++)r=n[u],r.groupId==t&&(f=r.displayObject,f&&(i?(r.hidden=!1,f.show()):(r.hidden=!0,f.hide())))},makeObjectAccessible:function(n){if(n.accessibleLabel){var t=this.formatString(n.accessibleLabel,n);n.displayObject&&this.makeAccessible(n.displayObject,t,"menuitem")}},update:function(){n.hasSVG&&(n.HisMap.base.update.call(this),this.zoomControl&&this.zoomControl.update&&this.zoomControl.update())},animateMap:function(){var t=this;t.totalFrames=t.zoomDuration*n.updateRate;t.totalFrames+=1;t.frame=0;t.tweenPercent=0;t.balloon.hide(0);setTimeout(function(){t.updateSize.call(t)},1e3/n.updateRate)},updateSize:function(){var t=this,i=t.totalFrames;t.preventHover=!0;t.frame<=i?(t.frame++,i=n.easeOutSine(0,t.frame,0,1,i),1<=i?(i=1,t.preventHover=!1,t.wheelBusy=!1):window.requestAnimationFrame?window.requestAnimationFrame(function(){t.updateSize.call(t)}):setTimeout(function(){t.updateSize.call(t)},1e3/n.updateRate),.8<i&&(t.preventHover=!1)):(i=1,t.preventHover=!1,t.wheelBusy=!1);t.tweenPercent=i;t.rescaleMapAndObjects()},rescaleMapAndObjects:function(){var r=this.initialScale,n=this.initialX,i=this.initialY,u=this.tweenPercent,r=r+(this.finalScale-r)*u,t,f;if(this.mapContainer.translate(n+(this.finalX-n)*u,i+(this.finalY-i)*u,r,!0),this.areasSettings.adjustOutlineThickness){for(n=this.svgAreas,t=0;t<n.length;t++)(i=n[t])&&i.setAttr("stroke-width",this.areasSettings.outlineThickness/r/this.mapScale);if(n=this.dataProvider.areas)for(t=0;t<n.length;t++)i=n[t],f=i.displayObject,f&&f.setAttr("stroke-width",i.outlineThicknessReal/r/this.mapScale)}this.rescaleObjects();this.positionChanged();this.updateSmallMap();1==u&&this.fire({type:"zoomCompleted",chart:this})},updateSmallMap:function(){this.smallMap&&this.smallMap.update()},rescaleObjects:function(){for(var f=this.mapContainer.scale,i=this.imagesProcessor.objectsToResize,n=0;n<i.length;n++){var t=i[n].image,r=i[n].scale,u=i[n].mapImage;isNaN(u.selectedScaleReal)||u!=this.selectedObject||(u.tempScale=r,r*=u.selectedScaleReal);t.translate(t.x,t.y,r/f,!0)}for(i=this.imagesProcessor.labelsToReposition,n=0;n<i.length;n++)t=i[n],t.imageLabel&&this.imagesProcessor.positionLabel(t.imageLabel,t,t.labelPositionReal);if(i=this.linesProcessor,t=i.linesToResize)for(n=0;n<t.length;n++)r=t[n],r.line.setAttr("stroke-width",r.thickness/f);for(i=i.objectsToResize,n=0;n<i.length;n++)t=i[n],t.translate(t.x,t.y,1/f,!0)},handleTouchEnd:function(t){this.initialDistance=NaN;this.mouseIsDown=this.isDragging=!1;n.HisMap.base.handleTouchEnd.call(this,t)},handleMouseDown:function(t){if(n.resetMouseOver(),this.mouseIsDown=this.mouseIsOver=!0,this.balloon.hide(0),t&&this.mouseIsOver&&t.preventDefault&&this.panEventsEnabled&&t.preventDefault(),this.chartCreated&&!this.preventHover&&(this.initialTouchZoom=this.zoomLevel(),this.dragMap&&(this.stopAnimation(),this.mapContainerClickX=this.mapContainer.x,this.mapContainerClickY=this.mapContainer.y),t||(t=window.event),t.shiftKey&&!0===this.developerMode&&this.getDevInfo(),t&&t.touches)){var r=this.mouseX,u=this.mouseY,i=t.touches.item(1);i&&this.panEventsEnabled&&this.boundingRect&&(t=i.clientX-this.boundingRect.left,i=i.clientY-this.boundingRect.top,this.middleXP=(r+(t-r)/2)/this.realWidth,this.middleYP=(u+(i-u)/2)/this.realHeight,this.initialDistance=Math.sqrt(Math.pow(t-r,2)+Math.pow(i-u,2)))}},stopDrag:function(){this.isDragging=!1},handleReleaseOutside:function(){var t,i;if(n.isModern){if(t=this,n.HisMap.base.handleReleaseOutside.call(t),t.mouseIsDown=!1,setTimeout(function(){t.resetPinch.call(t)},100),!t.preventHover){t.stopDrag();i=t.zoomControl;i&&i.draggerUp&&i.draggerUp();t.mapWasDragged=!1;var i=t.mapContainer,r=t.mapContainerClickX,u=t.mapContainerClickY;!isNaN(r)&&!isNaN(u)&&(3<Math.abs(i.x-r)||3<Math.abs(i.y-u))&&(t.mapWasDragged=!0,i={type:"dragCompleted",zoomX:t.zoomX(),zoomY:t.zoomY(),zoomLevel:t.zoomLevel(),chart:t},t.fire(i));(t.mouseIsOver&&!t.mapWasDragged&&!t.skipClick||t.wasTouched&&3>Math.abs(t.mouseX-t.tmx)&&3>Math.abs(t.mouseY-t.tmy))&&t.fire({type:"click",x:t.mouseX,y:t.mouseY,chart:t});t.mapContainerClickX=NaN;t.mapContainerClickY=NaN;t.objectWasClicked=!1;t.zoomOnDoubleClick&&t.mouseIsOver&&(i=(new Date).getTime(),200>i-t.previousClickTime&&40<i-t.previousClickTime&&t.doDoubleClickZoom(),t.previousClickTime=i)}t.wasTouched=!1}},resetPinch:function(){this.mapWasPinched=!1},handleMouseMove:function(t){var i=this,r,o,v,e;if(n.HisMap.base.handleMouseMove.call(i,t),!t||!t.touches||!i.tapToActivate||i.tapped){i.panEventsEnabled&&i.mouseIsOver&&t&&t.preventDefault&&t.preventDefault();var u=i.previuosMouseX,f=i.previuosMouseY,s=i.mouseX,h=i.mouseY,c=i.zoomControl;if(isNaN(u)&&(u=s),isNaN(f)&&(f=h),i.mouse2X=NaN,i.mouse2Y=NaN,t&&t.touches&&(t=t.touches.item(1))&&i.panEventsEnabled&&i.boundingRect&&(i.mouse2X=t.clientX-i.boundingRect.left,i.mouse2Y=t.clientY-i.boundingRect.top),t=i.mapContainer){r=i.mouse2X;o=i.mouse2Y;i.pinchTO&&clearTimeout(i.pinchTO);i.pinchTO=setTimeout(function(){i.resetPinch.call(i)},1e3);var l=i.realHeight,y=i.realWidth,p=i.mapWidth,a=i.mapHeight;if((i.mouseIsDown&&i.dragMap&&(3<Math.abs(i.previuosMouseX-i.mouseX)||3<Math.abs(i.previuosMouseY-i.mouseY))&&(i.isDragging=!0),!isNaN(r))&&(i.stopDrag(),v=Math.sqrt(Math.pow(r-s,2)+Math.pow(o-h,2)),e=i.initialDistance,isNaN(e)&&(e=Math.sqrt(Math.pow(r-s,2)+Math.pow(o-h,2))),!isNaN(e))){var r=i.initialTouchZoom*v/e,r=n.fitToBounds(r,c.minZoomLevel,c.maxZoomLevel),c=i.zoomLevel(),e=i.middleXP,o=i.middleYP,v=l/a,w=y/p,e=(i.zoomX()-e*w)*(r/c)+e*w,o=(i.zoomY()-o*v)*(r/c)+o*v;.1<Math.abs(r-c)&&(i.zoomTo(r,e,o,!0),i.mapWasPinched=!0,clearTimeout(i.pinchTO))}r=t.scale;i.isDragging&&(i.balloon.hide(0),i.positionChanged(),u=t.x+(s-u),f=t.y+(h-f),i.preventDragOut&&(a=-a*r+l/2-i.diffY*i.mapScale*r,l=l/2-i.diffY*i.mapScale*r,u=n.fitToBounds(u,-p*r+y/2,y/2),f=n.fitToBounds(f,a,l)),isNaN(u)||isNaN(f)||(t.translate(u,f,r,!0),i.updateSmallMap()));i.previuosMouseX=s;i.previuosMouseY=h}}},selectObject:function(t,i){var u=this,l,h,c,e,r,f,s,o,a;if(t||(t=u.dataProvider),t.isOver=!1,r=t.linkToObject,n.isString(r)&&(r=u.getObjectById(r)),t.useTargetsZoomValues&&r&&(t.zoomX=r.zoomX,t.zoomY=r.zoomY,t.zoomLatitude=r.zoomLatitude,t.zoomLongitude=r.zoomLongitude,t.zoomLevel=r.zoomLevel),l=u.selectedObject,l&&u.returnInitialColor(l),u.selectedObject=t,e=!1,"MapArea"==t.objectType&&(t.autoZoomReal&&(e=!0),h=u.areasSettings.selectedOutlineColor,c=u.areasSettings.selectedOutlineThickness),r&&!e&&(n.isString(r)&&(r=u.getObjectById(r)),isNaN(t.zoomLevel)&&isNaN(t.zoomX)&&isNaN(t.zoomY)))return u.extendMapData(r)?void 0:void u.selectObject(r);if((u.allowMultipleDescriptionWindows||u.closeAllDescriptions(),clearTimeout(u.selectedObjectTimeOut),clearTimeout(u.processObjectsTimeOut),r=u.zoomDuration,!e&&isNaN(t.zoomLevel)&&isNaN(t.zoomX)&&isNaN(t.zoomY)?(u.showDescriptionAndGetUrl(),i||u.processObjects()):(u.selectedObjectTimeOut=setTimeout(function(){u.showDescriptionAndGetUrl.call(u)},1e3*r+200),u.showObjectsAfterZoom?i||(u.processObjectsTimeOut=setTimeout(function(){u.processObjects.call(u)},1e3*r+200)):i||u.processObjects()),r=t.displayObject,e=t.selectedColorReal,"MapImage"==t.objectType)&&(h=u.imagesSettings.selectedOutlineColor,c=u.imagesSettings.selectedOutlineThickness,r=t.image,f=t.selectedScaleReal,isNaN(f)||1==f||(s=t.scale,isNaN(t.tempScale)||(s=t.tempScale),isNaN(s)&&(s=1),t.tempScale=s,o=t.displayObject,o.translate(o.x,o.y,s*f,!0))),r?(n.removeCN(u,r,"selected-object"),n.setCN(u,r,"selected-object"),t.bringForwardOnHover&&t.displayObject.toFront(),u.outlinesToFront(),t.preserveOriginalAttributes||(r.setAttr("stroke",t.outlineColorReal),void 0!==e&&r.setAttr("fill",e),void 0!==h&&r.setAttr("stroke",h),void 0!==c&&r.setAttr("stroke-width",c),"MapLine"==t.objectType&&((f=t.lineSvg)&&f.setAttr("stroke",e),f=t.arrowSvg)&&(f.setAttr("fill",e),f.setAttr("stroke",e)),(f=t.imageLabel)&&void 0!==(s=t.selectedLabelColorReal)&&f.setAttr("fill",s),t.selectable||(r.setAttr("cursor","default"),f&&f.setAttr("cursor","default")))):u.returnInitialColorReal(t),r=t.groupId)for(f=t.groupArray,f||(f=u.getGroupById(r),t.groupArray=f),s=0;s<f.length;s++)(o=f[s],o.isOver=!1,r=o.displayObject,"MapImage"==o.objectType&&(r=o.image),r)&&(a=o.selectedColorReal,void 0!==a&&r.setAttr("fill",a),void 0!==h&&r.setAttr("stroke",h),void 0!==c&&r.setAttr("stroke-width",c),"MapLine"==o.objectType&&((r=o.lineSvg)&&r.setAttr("stroke",e),r=o.arrowSvg)&&(r.setAttr("fill",e),r.setAttr("stroke",e)));u.rescaleObjects();u.zoomToSelectedObject();l!=t&&u.fire({type:"selectedObjectChanged",chart:u})},returnInitialColor:function(n,t){var r,i;if((this.returnInitialColorReal(n),t&&(n.isFirst=!1),this.selectedObject.bringForwardOnHover)&&(i=this.selectedObject.displayObject,i&&i.toFront()),i=n.groupId)for(i=this.getGroupById(i),r=0;r<i.length;r++)this.returnInitialColorReal(i[r]),t&&(i[r].isFirst=!1);this.outlinesToFront()},outlinesToFront:function(){if(this.outlines)for(var n=0;n<this.outlines.length;n++)this.outlines[n].toFront()},closeAllDescriptions:function(){this.descriptionsDiv.innerHTML=""},fireClosed:function(){this.fire({type:"descriptionClosed",chart:this})},returnInitialColorReal:function(t){var i,f,e,u,o,r;if(t.isOver=!1,i=t.displayObject,i){(n.removeCN(this,i,"selected-object"),i.toPrevious(),"MapImage"==t.objectType)&&(r=t.tempScale,isNaN(r)||i.translate(i.x,i.y,r,!0),t.tempScale=NaN,i=t.image);(r=t.colorReal,"MapLine"==t.objectType)&&(f=t.lineSvg,(f&&f.setAttr("stroke",r),f=t.arrowSvg)&&(e=t.arrowColor,void 0==e&&(e=r),f.setAttr("fill",e),f.setAttr("stroke",e)));var f=t.alphaReal,e=t.outlineAlphaReal,s=t.outlineThicknessReal,h=t.outlineColorReal;t.showAsSelected&&(r=t.selectedColorReal,"MapImage"==t.objectType&&(u=this.imagesSettings.selectedOutlineColor,o=this.imagesSettings.selectedOutlineThickness),"MapArea"==t.objectType&&(u=this.areasSettings.selectedOutlineColor,o=this.areasSettings.selectedOutlineThickness),void 0!==u&&(h=u),void 0!==o&&(s=o));"bubble"==t.type&&(r=void 0);void 0!==r&&i.setAttr("fill",r);(u=t.image)&&(u.setAttr("fill",r),u.setAttr("stroke",h),u.setAttr("stroke-width",s),u.setAttr("fill-opacity",f),u.setAttr("stroke-opacity",e));"MapArea"==t.objectType&&(r=1,this.areasSettings.adjustOutlineThickness&&(r=this.zoomLevel()*this.mapScale),i.setAttr("stroke",h),i.setAttr("stroke-width",s/r),i.setAttr("fill-opacity",f),i.setAttr("stroke-opacity",e));(r=t.pattern)&&i.pattern(r,this.mapScale,this.path);(i=t.imageLabel)&&!t.labelInactive&&(t.showAsSelected&&void 0!==t.selectedLabelColor?i.setAttr("fill",t.selectedLabelColor):i.setAttr("fill",t.labelColorReal))}},zoomToRectangle:function(t,i,r,u){var e=this.realWidth,o=this.realHeight,f=this.mapSet.scale,s=this.zoomControl,e=n.fitToBounds(r/e>u/o?.8*e/(r*f):.8*o/(u*f),s.minZoomLevel,s.maxZoomLevel);this.zoomToMapXY(e,(t+r/2)*f,(i+u/2)*f)},zoomToLatLongRectangle:function(t,i,r,u){var f=this.dataProvider,e=this.zoomControl,o=Math.abs(r-t),s=Math.abs(i-u),h=Math.abs(f.rightLongitude-f.leftLongitude),f=Math.abs(f.topLatitude-f.bottomLatitude),e=n.fitToBounds(o/h>s/f?.8*h/o:.8*f/s,e.minZoomLevel,e.maxZoomLevel);this.zoomToLongLat(e,t+(r-t)/2,u+(i-u)/2)},getGroupById:function(n){var t=[];return this.getGroup(this.imagesProcessor.allObjects,n,t),this.getGroup(this.linesProcessor.allObjects,n,t),this.getGroup(this.areasProcessor.allObjects,n,t),t},zoomToGroup:function(n){var i,r,u,f,o,e;for(n="object"==typeof n?n:this.getGroupById(n),o=0;o<n.length;o++)if(e=n[o].displayObject,e){var t=e.getBBox(),e=t.y,s=t.y+t.height,h=t.x,t=t.x+t.width;(e<i||isNaN(i))&&(i=e);(s>f||isNaN(f))&&(f=s);(h<r||isNaN(r))&&(r=h);(t>u||isNaN(u))&&(u=t)}r+=this.diffX;u+=this.diffX;f+=this.diffY;i+=this.diffY;this.zoomToRectangle(r,i,u-r,f-i)},getGroup:function(n,t,i){var r,u;if(n)for(r=0;r<n.length;r++)u=n[r],u.groupId==t&&i.push(u)},zoomToStageXY:function(t,i,r,u){var f,e;this.objectWasClicked||(f=this.zoomControl,t=n.fitToBounds(t,f.minZoomLevel,f.maxZoomLevel),f=this.zoomLevel(),e=this.mapSet.getBBox(),i=this.xyToCoordinates((i-this.mapContainer.x)/f-e.x*this.mapScale,(r-this.mapContainer.y)/f-e.y*this.mapScale),this.zoomToLongLat(t,i.longitude,i.latitude,u))},zoomToLongLat:function(n,t,i,r){t=this.coordinatesToXY(t,i);this.zoomToMapXY(n,t.x,t.y,r)},zoomToMapXY:function(n,t,i,r){var u=this.mapWidth,f=this.mapHeight;this.zoomTo(n,-t/u*n+this.realWidth/u/2,-i/f*n+this.realHeight/f/2,r)},zoomToObject:function(t){var u,f;if(t){u=t.zoomLatitude;f=t.zoomLongitude;isNaN(t.zoomLatitudeC)||(u=t.zoomLatitudeC);isNaN(t.zoomLongitudeC)||(f=t.zoomLongitudeC);var r=t.zoomLevel,i=this.zoomInstantly,e=t.zoomX,h=t.zoomY,o=this.realWidth,s=this.realHeight;isNaN(r)||(isNaN(u)||isNaN(f)?this.zoomTo(r,e,h,i):this.zoomToLongLat(r,f,u,i));this.zoomInstantly=!1;"MapImage"==t.objectType&&isNaN(t.zoomX)&&isNaN(t.zoomY)&&isNaN(t.zoomLatitude)&&isNaN(t.zoomLongitude)&&!isNaN(t.latitude)&&!isNaN(t.longitude)&&this.zoomToLongLat(t.zoomLevel,t.longitude,t.latitude);"MapArea"==t.objectType&&(i=t.displayObject.getBBox(),e=this.mapScale,u=(i.x+this.diffX)*e,f=(i.y+this.diffY)*e,r=i.width*e,i=i.height*e,o=t.autoZoomReal&&isNaN(t.zoomLevel)?r/o>i/s?.8*o/r:.8*s/i:t.zoomLevel,s=this.zoomControl,o=n.fitToBounds(o,s.minZoomLevel,s.maxZoomLevel),isNaN(t.zoomX)&&isNaN(t.zoomY)&&isNaN(t.zoomLatitude)&&isNaN(t.zoomLongitude)&&this.zoomToMapXY(o,u+r/2,f+i/2));this.zoomControl.update()}},zoomToSelectedObject:function(){this.zoomToObject(this.selectedObject)},zoomTo:function(t,i,r,u){var f=this.zoomControl;t=n.fitToBounds(t,f.minZoomLevel,f.maxZoomLevel);f=this.zoomLevel();isNaN(i)&&(i=this.realWidth/this.mapWidth,i=(this.zoomX()-.5*i)*(t/f)+.5*i);isNaN(r)&&(r=this.realHeight/this.mapHeight,r=(this.zoomY()-.5*r)*(t/f)+.5*r);this.stopAnimation();isNaN(t)||(f=this.mapContainer,this.initialX=f.x,this.initialY=f.y,this.initialScale=f.scale,this.finalX=this.mapWidth*i,this.finalY=this.mapHeight*r,this.finalScale=t,this.finalX!=this.initialX||this.finalY!=this.initialY||this.finalScale!=this.initialScale?u?(this.tweenPercent=1,this.rescaleMapAndObjects(),this.wheelBusy=!1):this.animateMap():this.wheelBusy=!1)},loadXml:function(n){var t;window.XMLHttpRequest&&(t=new XMLHttpRequest);t.overrideMimeType&&t.overrideMimeType("text/xml");t.open("GET",n,!1);t.send();this.parseXMLObject(t.responseXML);this.svgData&&this.buildEverything()},stopAnimation:function(){this.frame=this.totalFrames},processObjects:function(n){var t=this.selectedObject,i,r,u,f;(0<t.images.length||0<t.areas.length||0<t.lines.length||t==this.dataProvider||n)&&(n=this.container,i=this.stageImagesContainer,i&&i.remove(),this.stageImagesContainer=i=n.set(),this.trendLinesSet.push(i),r=this.stageLinesContainer,r&&r.remove(),this.stageLinesContainer=r=n.set(),this.trendLinesSet.push(r),u=this.mapImagesContainer,u&&u.remove(),this.mapImagesContainer=u=n.set(),this.mapContainer.push(u),f=this.mapLinesContainer,f&&f.remove(),this.mapLinesContainer=f=n.set(),this.mapContainer.push(f),this.linesAboveImages?(u.toFront(),i.toFront(),f.toFront(),r.toFront()):(f.toFront(),r.toFront(),u.toFront(),i.toFront()),t&&(this.imagesProcessor.reset(),this.linesProcessor.reset(),this.linesAboveImages?(this.imagesProcessor.process(t),this.linesProcessor.process(t)):(this.linesProcessor.process(t),this.imagesProcessor.process(t))),this.rescaleObjects())},processAreas:function(){this.areasProcessor.process(this.dataProvider)},buildSVGMap:function(){var f,i,r;n.remove(this.mapSet);var u=this.svgData.g.path,o=this.container,e=o.set();for(this.svgAreas=[],this.svgAreasById={},void 0===u.length&&(u=[u]),f=0;f<u.length;f++){var t=u[f],s=t.d,h=t.title;if(t.titleTr&&(h=t.titleTr),i=o.path(s),i.id=t.id,this.areasSettings.preserveOriginalAttributes){i.customAttr={};for(r in t)"d"!=r&&"id"!=r&&"title"!=r&&(i.customAttr[r]=t[r])}t.outline&&(i.outline=!0);i.path=s;this.svgAreasById[t.id]={area:i,title:h,className:t.class};this.svgAreas.push(i);e.push(i)}this.mapSet=e;this.mapContainer.push(e);this.resizeMap()},centerAlign:function(){},setProjection:function(n){this.projection=n;this.chartCreated=!1;this.buildEverything()},addObjectEventListeners:function(n,t){var i=this;n.mousedown(function(n){i.mouseDownMapObject(t,n)}).mouseup(function(n){i.clickMapObject(t,n)}).mouseover(function(n){i.balloonX=NaN;i.rollOverMapObject(t,!0,n)}).mouseout(function(n){i.balloonX=NaN;i.rollOutMapObject(t,n)}).touchend(function(n){4>Math.abs(i.mouseX-i.tmx)&&4>Math.abs(i.mouseY-i.tmy)&&(i.tapped=!0);i.tapToActivate&&!i.tapped||i.mapWasDragged||i.mapWasPinched||(i.balloonX=NaN,i.rollOverMapObject(t,!0,n),i.clickMapObject(t,n))}).touchstart(function(n){i.tmx=i.mouseX;i.tmy=i.mouseY;i.mouseDownMapObject(t,n)}).keyup(function(n){13==n.keyCode&&i.clickMapObject(t,n)})},checkIfSelected:function(n){var t=this.selectedObject,i;if(t==n)return!0;if(t=t.groupId)for(t=this.getGroupById(t),i=0;i<t.length;i++)if(t[i]==n)return!0;return!1},clearMap:function(){this.chartDiv.innerHTML="";this.clearObjectList()},clearObjectList:function(){var n=this.objectList;n&&n.div&&(n.div.innerHTML="")},checkIfLast:function(n){if(n){var t=n.parentNode;if(t&&t.lastChild==n)return!0}return!1},showAsRolledOver:function(t){var u=t.displayObject,r,i,f;t.showAsSelected||!u||t.isOver||(u.node.onmouseout=function(){},u.node.onmouseover=function(){},u.node.onclick=function(){},!t.isFirst&&t.bringForwardOnHover&&(u.toFront(),t.isFirst=!0),i=t.rollOverColorReal,(t.preserveOriginalAttributes&&(i=void 0),"bubble"==t.type&&(i=void 0),void 0==i&&(isNaN(t.rollOverBrightnessReal)||(i=n.adjustLuminosity(t.colorReal,t.rollOverBrightnessReal/100))),void 0!=i&&("MapImage"==t.objectType?(r=t.image)&&r.setAttr("fill",i):"MapLine"==t.objectType?((r=t.lineSvg)&&r.setAttr("stroke",i),(r=t.arrowSvg)&&(r.setAttr("fill",i),r.setAttr("stroke",i))):u.setAttr("fill",i)),(i=t.imageLabel)&&!t.labelInactive&&void 0!=(r=t.labelRollOverColorReal)&&i.setAttr("fill",r),i=t.rollOverOutlineColorReal,void 0!=i&&("MapImage"==t.objectType?(r=t.image)&&r.setAttr("stroke",i):u.setAttr("stroke",i)),"MapImage"==t.objectType?(i=this.imagesSettings.rollOverOutlineThickness,(r=t.image)&&(isNaN(i)||r.setAttr("stroke-width",i))):(i=this.areasSettings.rollOverOutlineThickness,isNaN(i)||u.setAttr("stroke-width",i)),"MapArea"==t.objectType)&&(i=this.areasSettings,r=t.rollOverAlphaReal,isNaN(r)||u.setAttr("fill-opacity",r),r=i.rollOverOutlineAlpha,isNaN(r)||u.setAttr("stroke-opacity",r),r=1,this.areasSettings.adjustOutlineThickness&&(r=this.zoomLevel()*this.mapScale),f=i.rollOverOutlineThickness,isNaN(f)||u.setAttr("stroke-width",f/r),(i=i.rollOverPattern)&&u.pattern(i,this.mapScale,this.path)),"MapImage"==t.objectType&&(i=t.rollOverScaleReal,isNaN(i)||1==i||(r=u.scale,isNaN(r)&&(r=1),t.tempScale=r,u.translate(u.x,u.y,r*i,!0))),this.useHandCursorOnClickableOjects&&this.checkIfClickable(t)&&u.setAttr("cursor","pointer"),t.mouseEnabled&&this.addObjectEventListeners(u,t),t.isOver=!0);this.outlinesToFront()},rollOverMapObject:function(n,t,i){var u,r;if(this.chartCreated&&(this.handleMouseMove(),r=this.previouslyHovered,r&&r!=n?(!1===this.checkIfSelected(r)&&(this.returnInitialColor(r,!0),this.previouslyHovered=null),this.balloon.hide(0)):clearTimeout(this.hoverInt),!this.preventHover)){if(!1===this.checkIfSelected(n)){if(r=n.groupId)for(r=this.getGroupById(r),u=0;u<r.length;u++)r[u]!=n&&this.showAsRolledOver(r[u]);this.showAsRolledOver(n)}else(r=n.displayObject)&&(this.allowClickOnSelectedObject?r.setAttr("cursor","pointer"):r.setAttr("cursor","default"));this.showDescriptionOnHover?this.showDescription(n):!this.showBalloonOnSelectedObject&&this.checkIfSelected(n)||!1===t||(u=this.balloon,this.balloon.fixedPosition=!1,t=n.colorReal,r="",void 0!==t&&this.useObjectColorForBalloon||(t=u.fillColor),(u=n.balloonTextReal)&&(r=this.formatString(u,n)),this.balloonLabelFunction&&(r=this.balloonLabelFunction(n,this)),r&&""!==r&&this.showBalloon(r,t,!1,this.balloonX,this.balloonY));this.fire({type:"rollOverMapObject",mapObject:n,chart:this,event:i});this.previouslyHovered=n}},longitudeToX:function(n){return(this.longitudeToCoordinate(n)+this.diffX*this.mapScale)*this.zoomLevel()+this.mapContainer.x},latitudeToY:function(n){return(this.latitudeToCoordinate(n)+this.diffY*this.mapScale)*this.zoomLevel()+this.mapContainer.y},latitudeToStageY:function(n){return this.latitudeToCoordinate(n)*this.zoomLevel()+this.mapContainer.y+this.diffY*this.mapScale},longitudeToStageX:function(n){return this.longitudeToCoordinate(n)*this.zoomLevel()+this.mapContainer.x+this.diffX*this.mapScale},stageXToLongitude:function(n){return n=(n-this.mapContainer.x)/this.zoomLevel(),this.coordinateToLongitude(n)},stageYToLatitude:function(n){return n=(n-this.mapContainer.y)/this.zoomLevel(),this.coordinateToLatitude(n)},rollOutMapObject:function(n,t){this.hideBalloon();n&&this.chartCreated&&n.isOver&&(this.checkIfSelected(n)||this.returnInitialColor(n),this.fire({type:"rollOutMapObject",mapObject:n,chart:this,event:t}))},formatString:function(t,i){var r=this.nf,u=this.pf,f=i.title,e;i.titleTr&&(f=i.titleTr);void 0==f&&(f="");var o=i.value,o=isNaN(o)?"":n.formatNumber(o,r),r=i.percents,r=isNaN(r)?"":n.formatNumber(r,u),u=i.description;return void 0==u&&(u=""),e=i.customData,void 0==e&&(e=""),t=n.massReplace(t,{"[[title]]":f,"[[value]]":o,"[[percent]]":r,"[[description]]":u,"[[customData]]":e})},mouseDownMapObject:function(n,t){this.fire({type:"mouseDownMapObject",mapObject:n,chart:this,event:t})},clickMapObject:function(n,t){var i=this;if(t&&(t.touches||isNaN(n.zoomLevel)&&isNaN(n.zoomX)&&isNaN(n.zoomY)||i.hideBalloon()),i.chartCreated&&!i.preventHover&&i.checkTouchDuration(t)&&!i.mapWasDragged&&i.checkIfClickable(n)&&!i.mapWasPinched){i.selectObject(n);var r=i.zoomLevel(),u=i.mapSet.getBBox(),r=i.xyToCoordinates((i.mouseX-i.mapContainer.x)/r-u.x*i.mapScale,(i.mouseY-i.mapContainer.y)/r-u.y*i.mapScale);i.clickLatitude=r.latitude;i.clickLongitude=r.longitude;t&&t.touches&&setTimeout(function(){i.showBalloonAfterZoom.call(i)},1e3*i.zoomDuration);i.fire({type:"clickMapObject",mapObject:n,chart:i,event:t});i.objectWasClicked=!0}},showBalloonAfterZoom:function(){var n=this.clickLongitude,i=this.clickLatitude,t=this.selectedObject;"MapImage"!=t.objectType||isNaN(t.longitude)||(n=t.longitude,i=t.latitude);n=this.coordinatesToStageXY(n,i);this.balloonX=n.x;this.balloonY=n.y;this.rollOverMapObject(this.selectedObject,!0)},checkIfClickable:function(n){var t=this.allowClickOnSelectedObject;return!(this.selectedObject!=n||!t)||!(this.selectedObject==n&&!t)&&!(!(!0===n.selectable||"MapArea"==n.objectType&&n.autoZoomReal||n.url||n.linkToObject||0<n.images.length||0<n.lines.length)&&isNaN(n.zoomLevel)&&isNaN(n.zoomX)&&isNaN(n.zoomY)&&!n.description)},resizeMap:function(){var r=this.mapSet;if(r){var t=1,n=r.getBBox(),u=this.realWidth,f=this.realHeight,i=n.width,n=n.height;0<i&&0<n&&(this.fitMapToContainer&&(t=i/u>n/f?u/i:f/n),r.translate(0,0,t,!0),this.mapScale=t,this.mapHeight=n*t,this.mapWidth=i*t)}},zoomIn:function(){var n=this.zoomLevel()*this.zoomControl.zoomFactor;this.zoomTo(n)},zoomOut:function(){var n=this.zoomLevel()/this.zoomControl.zoomFactor;this.zoomTo(n)},moveLeft:function(){var n=this.zoomX()+this.zoomControl.panStepSize;this.zoomTo(this.zoomLevel(),n,this.zoomY())},moveRight:function(){var n=this.zoomX()-this.zoomControl.panStepSize;this.zoomTo(this.zoomLevel(),n,this.zoomY())},moveUp:function(){var n=this.zoomY()+this.zoomControl.panStepSize;this.zoomTo(this.zoomLevel(),this.zoomX(),n)},moveDown:function(){var n=this.zoomY()-this.zoomControl.panStepSize;this.zoomTo(this.zoomLevel(),this.zoomX(),n)},zoomX:function(){return this.mapSet?Math.round(1e4*this.mapContainer.x/this.mapWidth)/1e4:NaN},zoomY:function(){return this.mapSet?Math.round(1e4*this.mapContainer.y/this.mapHeight)/1e4:NaN},goHome:function(){this.selectObject(this.dataProvider);this.fire({type:"homeButtonClicked",chart:this})},zoomLevel:function(){return Math.round(1e5*this.mapContainer.scale)/1e5},showDescriptionAndGetUrl:function(){var i=this.selectedObject,t,r;if(i)if(this.showDescription(),t=i.url,t)n.getURL(t,i.urlTarget);else if(t=i.linkToObject){if(n.isString(t)&&(r=this.getObjectById(t),r))return void this.selectObject(r);t&&i.passZoomValuesToTarget&&(t.zoomLatitude=this.zoomLatitude(),t.zoomLongitude=this.zoomLongitude(),t.zoomLevel=this.zoomLevel());this.extendMapData(t)||this.selectObject(t)}},extendMapData:function(t){var i=t.objectType;if("MapImage"!=i&&"MapArea"!=i&&"MapLine"!=i)return n.extend(t,new n.MapData,!0),this.dataProvider=t,this.zoomInstantly=!0,this.validateData(),!0},showDescription:function(t){var i,u;if(t||(t=this.selectedObject),this.allowMultipleDescriptionWindows||this.closeAllDescriptions(),t.description){i=t.descriptionWindow;i&&i.close();i=new n.DescriptionWindow;t.descriptionWindow=i;var s=t.descriptionWindowWidth,h=t.descriptionWindowHeight,r=t.descriptionWindowLeft,f=t.descriptionWindowTop,e=t.descriptionWindowRight,o=t.descriptionWindowBottom;isNaN(e)||(r=this.realWidth-e);isNaN(o)||(f=this.realHeight-o);u=t.descriptionWindowX;isNaN(u)||(r=u);u=t.descriptionWindowY;isNaN(u)||(f=u);isNaN(r)&&(r=this.mouseX,r=r>this.realWidth/2?r-s-20:r+20);isNaN(f)&&(f=this.mouseY);i.maxHeight=h;u=t.title;t.titleTr&&(u=t.titleTr);i.show(this,this.descriptionsDiv,t.description,u);t=i.div.style;t.position="absolute";t.width=s+"px";t.maxHeight=h+"px";isNaN(o)||(f-=i.div.offsetHeight);isNaN(e)||(r-=i.div.offsetWidth);t.left=r+"px";t.top=f+"px"}},parseXMLObject:function(n){var t={root:{}};this.parseXMLNode(t,"root",n);this.svgData=t.root.svg;this.getBounds()},getBounds:function(){var n=this.dataProvider,t,i;try{t=this.svgData.defs["historymaps:historymap"];n.leftLongitude=Number(t.leftLongitude);n.rightLongitude=Number(t.rightLongitude);n.topLatitude=Number(t.topLatitude);n.bottomLatitude=Number(t.bottomLatitude);n.projection=t.projection;i=t.wrappedLongitudes;i&&(n.rightLongitude+=360);n.wrappedLongitudes=i}catch(n){}},recalcLongitude:function(n){return this.dataProvider.wrappedLongitudes&&n<this.dataProvider.leftLongitude?Number(n)+360:n},latitudeToCoordinate:function(n){var t,r=this.dataProvider,i;return this.mapSet&&(t=r.topLatitude,i=r.bottomLatitude,"mercator"==r.projection&&(n=this.mercatorLatitudeToCoordinate(n),t=this.mercatorLatitudeToCoordinate(t),i=this.mercatorLatitudeToCoordinate(i)),t=(n-t)/(i-t)*this.mapHeight),t},longitudeToCoordinate:function(n){n=this.recalcLongitude(n);var t,i=this.dataProvider;return this.mapSet&&(t=i.leftLongitude,t=(n-t)/(i.rightLongitude-t)*this.mapWidth),t},mercatorLatitudeToCoordinate:function(t){return 89.5<t&&(t=89.5),-89.5>t&&(t=-89.5),t=n.degreesToRadians(t),n.radiansToDegrees(.5*Math.log((1+Math.sin(t))/(1-Math.sin(t)))/2)},zoomLatitude:function(){if(this.mapContainer){var n=this.mapSet.getBBox(),t=(-this.mapContainer.x+this.previousWidth/2)/this.zoomLevel()-n.x*this.mapScale,n=(-this.mapContainer.y+this.previousHeight/2)/this.zoomLevel()-n.y*this.mapScale;return this.xyToCoordinates(t,n).latitude}},zoomLongitude:function(){if(this.mapContainer){var n=this.mapSet.getBBox(),t=(-this.mapContainer.x+this.previousWidth/2)/this.zoomLevel()-n.x*this.mapScale,n=(-this.mapContainer.y+this.previousHeight/2)/this.zoomLevel()-n.y*this.mapScale;return this.xyToCoordinates(t,n).longitude}},getAreaCenterLatitude:function(n){n=n.displayObject.getBBox();var t=this.mapScale,i=this.mapSet.getBBox();return this.xyToCoordinates((n.x+n.width/2+this.diffX)*t-i.x*t,(n.y+n.height/2+this.diffY)*t-i.y*t).latitude},getAreaCenterLongitude:function(n){n=n.displayObject.getBBox();var t=this.mapScale,i=this.mapSet.getBBox();return this.xyToCoordinates((n.x+n.width/2+this.diffX)*t-i.x*t,(n.y+n.height/2+this.diffY)*t-i.y*t).longitude},milesToPixels:function(n){var t=this.dataProvider;return this.mapWidth/(t.rightLongitude-t.leftLongitude)*n/69.172},kilometersToPixels:function(n){var t=this.dataProvider;return this.mapWidth/(t.rightLongitude-t.leftLongitude)*n/111.325},handleBackgroundClick:function(){var n;if(this.backgroundZoomsToTop&&!this.mapWasDragged)if(n=this.dataProvider,this.checkIfClickable(n))this.clickMapObject(n);else{var t=n.zoomX,i=n.zoomY,r=n.zoomLongitude,u=n.zoomLatitude,n=n.zoomLevel;isNaN(t)||isNaN(i)||this.zoomTo(n,t,i);isNaN(r)||isNaN(u)||this.zoomToLongLat(n,r,u,!0)}},parseXMLNode:function(n,t,i,r){var h,u,s,c,o;if(void 0===r&&(r=""),i){for(c=i.childNodes.length,h=0;h<c;h++){u=i.childNodes[h];var f=u.nodeName,e=u.nodeValue?this.trim(u.nodeValue):"",l=!1;if(u.attributes&&0<u.attributes.length&&(l=!0),0!==u.childNodes.length||""!==e||!1!==l)if(3==u.nodeType||4==u.nodeType){if(""!==e){u=0;for(s in n[t])n[t].hasOwnProperty(s)&&u++;u?n[t]["#text"]=e:n[t]=e}}else if(1==u.nodeType){if(void 0!==n[t][f]?void 0===n[t][f].length?(o=n[t][f],n[t][f]=[],n[t][f].push(o),n[t][f].push({}),o=n[t][f][1]):"object"==typeof n[t][f]&&(n[t][f].push({}),o=n[t][f][n[t][f].length-1]):(n[t][f]={},o=n[t][f]),u.attributes&&u.attributes.length)for(e=0;e<u.attributes.length;e++)o[u.attributes[e].name]=u.attributes[e].value;void 0!==n[t][f].length?this.parseXMLNode(n[t][f],n[t][f].length-1,u,r+"  "):this.parseXMLNode(n[t],f,u,r+"  ")}}u=0;i="";for(s in n[t])"#text"==s?i=n[t][s]:u++;0===u&&void 0===n[t].length&&(n[t]=i)}},doDoubleClickZoom:function(){if(!this.mapWasDragged){var n=this.zoomLevel()*this.zoomControl.zoomFactor;this.zoomToStageXY(n,this.mouseX,this.mouseY)}},getDevInfo:function(){var n=this.zoomLevel(),t=this.mapSet.getBBox(),t=this.xyToCoordinates((this.mouseX-this.mapContainer.x)/n-t.x*this.mapScale,(this.mouseY-this.mapContainer.y)/n-t.y*this.mapScale),n={chart:this,type:"writeDevInfo",zoomLevel:n,zoomX:this.zoomX(),zoomY:this.zoomY(),zoomLatitude:this.zoomLatitude(),zoomLongitude:this.zoomLongitude(),latitude:t.latitude,longitude:t.longitude,left:this.mouseX,top:this.mouseY,right:this.realWidth-this.mouseX,bottom:this.realHeight-this.mouseY,percentLeft:Math.round(this.mouseX/this.realWidth*100)+"%",percentTop:Math.round(this.mouseY/this.realHeight*100)+"%",percentRight:Math.round((this.realWidth-this.mouseX)/this.realWidth*100)+"%",percentBottom:Math.round((this.realHeight-this.mouseY)/this.realHeight*100)+"%"},t="zoomLevel:"+n.zoomLevel+", zoomLongitude:"+n.zoomLongitude+", zoomLatitude:"+n.zoomLatitude+"\n",t=t+"zoomX:"+n.zoomX+", zoomY:"+n.zoomY+"\n",t=t+"latitude:"+n.latitude+", longitude:"+n.longitude+"\n",t=t+"left:"+n.left+", top:"+n.top+"\n",t=t+"right:"+n.right+", bottom:"+n.bottom+"\n",t=t+"left:"+n.percentLeft+", top:"+n.percentTop+"\n",t=t+"right:"+n.percentRight+", bottom:"+n.percentBottom+"\n";return n.str=t,this.fire(n),n},getXY:function(n,t,i){return void 0!==n&&(-1!=String(n).indexOf("%")?(n=Number(n.split("%").join("")),i&&(n=100-n),n=Number(n)*t/100):i&&(n=t-n)),n},getObjectById:function(n){var i=this.dataProvider,t;return i.areas&&(t=this.getObject(n,i.areas),t)?t:(t=this.getObject(n,i.images))?t:(n=this.getObject(n,i.lines))?n:void 0},getObject:function(n,t){var r,i,u;if(t)for(r=0;r<t.length;r++){if(i=t[r],i.id==n)return i;if(i.areas&&(u=this.getObject(n,i.areas),u)||(u=this.getObject(n,i.images)))return u;if(i=this.getObject(n,i.lines))return i}},parseData:function(){var n=this.dataProvider;this.processObject(n.areas,n,"area");this.processObject(n.images,n,"image");this.processObject(n.lines,n,"line")},processObject:function(t,i,r){var f,u;if(t)for(f=0;f<t.length;f++)u=t[f],u.parentObject=i,"area"==r&&n.extend(u,new n.MapArea(this.theme),!0),"image"==r&&(u=n.extend(u,new n.MapImage(this.theme),!0)),"line"==r&&(u=n.extend(u,new n.MapLine(this.theme),!0)),t[f]=u,u.areas&&this.processObject(u.areas,u,"area"),u.images&&this.processObject(u.images,u,"image"),u.lines&&this.processObject(u.lines,u,"line")},positionChanged:function(){var n={type:"positionChanged",zoomX:this.zoomX(),zoomY:this.zoomY(),zoomLevel:this.zoomLevel(),chart:this};this.fire(n)},getX:function(n,t){return this.getXY(n,this.realWidth,t)},getY:function(n,t){return this.getXY(n,this.realHeight,t)},trim:function(n){if(n){for(var t=0;t<n.length;t++)if(-1===" \n\r\t\f\vÂ ââââââââââââ\u2028\u2029ã".indexOf(n.charAt(t))){n=n.substring(t);break}for(t=n.length-1;0<=t;t--)if(-1===" \n\r\t\f\vÂ ââââââââââââ\u2028\u2029ã".indexOf(n.charAt(t))){n=n.substring(0,t+1);break}return-1===" \n\r\t\f\vÂ ââââââââââââ\u2028\u2029ã".indexOf(n.charAt(0))?n:""}},destroy:function(){n.HisMap.base.destroy.call(this)},x2c:function(n){var t=this.dataProvider.leftLongitude;return Math.round(this.unscaledMapWidth*(n-t)/(this.dataProvider.rightLongitude-t)*100)/100},y2c:function(n){var t=this.dataProvider.topLatitude;return Math.round(this.unscaledMapHeight*(n-t)/(this.dataProvider.bottomLatitude-t)*100)/100},normalize:function(t){var r,i;t.pathsArray||(t.normalized?r=t.normalized:(i=n.normalizePath(t.node),r=t.node.getAttribute("d"),t.normalized=r,i.maxX>this.maxMapX&&(this.maxMapX=i.maxX),i.minX<this.minMapX&&(this.minMapX=i.minX),i.maxY>this.maxMapY&&(this.maxMapY=i.maxY),i.minY<this.minMapY&&(this.minMapY=i.minY)),t.node.setAttribute("d",r))},redraw:function(n){var t=n.normalized,t=t.split(" Z").join(""),t=t.split("M"),i,r,u;for(n.pathsArray=[],i=0;i<t.length;i++)if(r=t[i],r){for(var r=r.split("L"),e=[],f=0;f<r.length;f++)r[f]&&(u=r[f].split(" "),u=this.xyToCoordinates(Number(u[1]),Number(u[2]),this.dpProjectionFunction,this.sourceMapWidth,this.sourceMapHeight),e.push([u.longitude,u.latitude]));n.pathsArray.push(e)}for(t="",i=0;i<n.pathsArray.length;i++)t+=this.redrawArea(n.pathsArray[i]);n.node.setAttribute("d",t);n.path=t},redrawArea:function(t){for(var s=!1,f="",r=0;r<t.length;r++){var e=t[r][0],o=t[r][1],u=n.degreesToRadians(t[r][0]),i=n.degreesToRadians(t[r][1]),i=this.projectionFunction(u,i),u=n.roundTo(this.x2c(n.radiansToDegrees(i[0])),3),i=n.roundTo(this.y2c(n.radiansToDegrees(i[1])),3);u<this.minMapXX&&(this.minMapXX=u,this.leftLongLat={longitude:e,latitude:o});u>this.maxMapXX&&(this.maxMapXX=u,this.rightLongLat={longitude:e,latitude:o});i<this.minMapYY&&(this.minMapYY=i,this.topLongLat={longitude:e,latitude:o});i>this.maxMapYY&&(this.maxMapYY=i,this.bottomLongLat={longitude:e,latitude:o});s?f+=" L ":(f+=" M ",s=!0);f+=u+" "+i}return f+" Z "},normalizeMap:function(){var i=n.degreesToRadians(this.dataProvider.leftLongitude),u=n.degreesToRadians(this.dataProvider.rightLongitude),r=n.degreesToRadians(this.dataProvider.topLatitude),f=n.degreesToRadians(this.dataProvider.bottomLatitude),e=i+(u-i)/2,o=r+(f-r)/2,s=this.dpProjectionFunction(e,r)[1],c=this.dpProjectionFunction(e,f)[1],h=this.dpProjectionFunction(i,o)[0],t=this.dpProjectionFunction(u,o)[0],r=n.equirectangular(e,r),f=n.equirectangular(e,f),s=(r[1]-f[1])/(s-c),i=n.equirectangular(i,o),u=n.equirectangular(u,o),h=(i[0]-u[0])/(h-t);for(this.minMapX=1/0,this.maxMapX=-1/0,this.minMapY=1/0,this.maxMapY=-1/0,t=0;t<this.svgAreas.length;t++)this.normalize(this.svgAreas[t]);if(this.dataProvider.wrappedLongitudes)for(t=0;t<this.svgAreas.length;t++)this.svgAreas[t].translate(-this.minMapX,-this.minMapY);this.sourceMapHeight=Math.abs(this.maxMapY-this.minMapY);this.sourceMapWidth=Math.abs(this.maxMapX-this.minMapX);this.unscaledMapWidth=this.sourceMapWidth*h;this.unscaledMapHeight=this.sourceMapHeight*s;this.diffY=this.diffX=0},fixMapPosition:function(){var u=n.degreesToRadians(this.dataProvider.leftLongitude),e=n.degreesToRadians(this.dataProvider.rightLongitude),i=n.degreesToRadians(this.dataProvider.topLatitude),t=n.degreesToRadians(this.dataProvider.bottomLatitude),r=u+(e-u)/2,f=i+(t-i)/2,o=this.dpProjectionFunction(r,i)[1],s=this.dpProjectionFunction(r,t)[1],h=this.dpProjectionFunction(u,f)[0],c=this.dpProjectionFunction(e,f)[0];for(this.sourceMapHeight=this.mapHeight/this.mapScale,this.sourceMapWidth=this.mapWidth/this.mapScale,this.unscaledMapWidth=(u-e)/(h-c)*this.sourceMapWidth,this.unscaledMapHeight=(i-t)/(o-s)*this.sourceMapHeight,e=this.coordinatesToXY(n.radiansToDegrees(r),n.radiansToDegrees(i)),u=this.coordinatesToXY(n.radiansToDegrees(u),n.radiansToDegrees(f)),i=f=1/0,t=0;t<this.svgAreas.length;t++)r=this.svgAreas[t].getBBox(),r.y<f&&(f=r.y),r.x<i&&(i=r.x);for(this.diffY=e.y/this.mapScale-f,this.diffX=u.x/this.mapScale-i,t=0;t<this.svgAreas.length;t++)this.svgAreas[t].translate(this.diffX,this.diffY)},changeProjection:function(){this.minMapXX=1/0;this.maxMapXX=-1/0;this.minMapYY=1/0;this.maxMapYY=-1/0;this.projectionChanged=!1;for(var n=0;n<this.svgAreas.length;n++)this.redraw(this.svgAreas[n]);this.projectionChanged=!0;this.resizeMap()},coordinatesToXY:function(t,i){var u,r;return u=!1,this.dataProvider&&(u=this.dataProvider.wrappedLongitudes)&&(t=this.recalcLongitude(t)),this.projectionFunction?(r=this.projectionFunction(n.degreesToRadians(t),n.degreesToRadians(i)),u=this.mapScale*n.roundTo(this.x2c(n.radiansToDegrees(r[0])),3),r=this.mapScale*n.roundTo(this.y2c(n.radiansToDegrees(r[1])),3)):(u=this.longitudeToCoordinate(t),r=this.latitudeToCoordinate(i)),{x:u,y:r}},coordinatesToStageXY:function(n,t){var i=this.coordinatesToXY(n,t),r=i.x*this.zoomLevel()+this.mapContainer.x,i=i.y*this.zoomLevel()+this.mapContainer.y;return{x:r,y:i}},stageXYToCoordinates:function(n,t){var i=this.mapSet.getBBox(),r=(n-this.mapContainer.x)/this.zoomLevel()-i.x*this.mapScale,i=(t-this.mapContainer.y)/this.zoomLevel()-i.y*this.mapScale;return this.xyToCoordinates(r,i)},xyToCoordinates:function(t,i,r,u,f){var s;if(isNaN(u)&&(u=this.mapWidth),isNaN(f)&&(f=this.mapHeight),r||(r=this.projectionFunction),s=r.invert){var e=this.dataProvider.leftLongitude,h=this.dataProvider.rightLongitude,o=this.dataProvider.topLatitude,c=this.dataProvider.bottomLatitude,l=e+(h-e)/2,a=o+(c-o)/2,o=n.radiansToDegrees(r(n.degreesToRadians(l),n.degreesToRadians(o))[1]),c=n.radiansToDegrees(r(n.degreesToRadians(l),n.degreesToRadians(c))[1]),e=n.radiansToDegrees(r(n.degreesToRadians(e),n.degreesToRadians(a))[0]),h=n.radiansToDegrees(r(n.degreesToRadians(h),n.degreesToRadians(a))[0]);this.projectionChanged&&(o=n.radiansToDegrees(r(n.degreesToRadians(this.topLongLat.longitude),n.degreesToRadians(this.topLongLat.latitude))[1]),c=n.radiansToDegrees(r(n.degreesToRadians(this.bottomLongLat.longitude),n.degreesToRadians(this.bottomLongLat.latitude))[1]),e=n.radiansToDegrees(r(n.degreesToRadians(this.leftLongLat.longitude),n.degreesToRadians(this.leftLongLat.latitude))[0]),h=n.radiansToDegrees(r(n.degreesToRadians(this.rightLongLat.longitude),n.degreesToRadians(this.rightLongLat.latitude))[0]));t=n.degreesToRadians(t/u*(h-e)+e);i=n.degreesToRadians(i/f*(c-o)+o);i=s(t,i);s=n.radiansToDegrees(i[0]);i=n.radiansToDegrees(i[1])}else s=this.coordinateToLongitude(t),i=this.coordinateToLatitude(i);return{longitude:n.roundTo(s,4),latitude:n.roundTo(i,4)}},coordinateToLatitude:function(t,i){var r,u,f;return(void 0===i&&(i=this.mapHeight),this.mapSet)&&(u=this.dataProvider,f=u.bottomLatitude,r=u.topLatitude,"mercator"==u.projection?(u=this.mercatorLatitudeToCoordinate(f),r=this.mercatorLatitudeToCoordinate(r),r=2*n.degreesToRadians(t*(u-r)/i+r),r=n.radiansToDegrees(2*Math.atan(Math.exp(r))-.5*Math.PI)):r=t/i*(f-r)+r),Math.round(1e6*r)/1e6},coordinateToLongitude:function(n,t){var r,i=this.dataProvider;return void 0===t&&(t=this.mapWidth),this.mapSet&&(r=n/t*(i.rightLongitude-i.leftLongitude)+i.leftLongitude),Math.round(1e6*r)/1e6}})}(),function(){var n=window.HistoryMaps;n.ZoomControl=n.Class({construct:function(t){this.cname="ZoomControl";this.panStepSize=.1;this.zoomFactor=2;this.maxZoomLevel=64;this.minZoomLevel=1;this.panControlEnabled=!1;this.zoomControlEnabled=!0;this.buttonRollOverColor="#DADADA";this.buttonFillColor="#FFFFFF";this.buttonFillAlpha=1;this.buttonBorderColor="#000000";this.buttonBorderAlpha=.1;this.buttonIconAlpha=this.buttonBorderThickness=1;this.gridColor=this.buttonIconColor="#000000";this.homeIconFile="homeIcon.gif";this.gridBackgroundColor="#000000";this.draggerAlpha=this.gridAlpha=this.gridBackgroundAlpha=0;this.draggerSize=this.buttonSize=31;this.iconSize=11;this.homeButtonEnabled=!0;this.buttonCornerRadius=2;this.gridHeight=5;this.roundButtons=!0;this.top=this.left=10;n.applyTheme(this,t,this.cname)},init:function(t,i){var r=this,w,l,u,v,ut,ft,a,ot;r.chart=t;n.remove(r.set);w=i.set();n.setCN(t,w,"zoom-control");var f=r.buttonSize,a=r.zoomControlEnabled,s=r.panControlEnabled,b=r.buttonFillColor,y=r.buttonFillAlpha,k=r.buttonBorderThickness,d=r.buttonBorderColor,p=r.buttonBorderAlpha,g=r.buttonCornerRadius,nt=r.buttonRollOverColor,tt=r.gridHeight,o=r.zoomFactor,st=r.minZoomLevel,et=r.maxZoomLevel,h=r.buttonIconAlpha,c=r.buttonIconColor,it=r.roundButtons,rt=t.svgIcons,u=t.getX(r.left),e=t.getY(r.top);if(isNaN(r.right)||(u=t.getX(r.right,!0),u=s?u-3*f:u-f),isNaN(r.bottom)||(e=t.getY(r.bottom,!0),a&&(e-=tt+3*f),e=s?e-3*f:r.homeButtonEnabled?e-.5*f:e+f),w.translate(u,e),r.previousDY=NaN,u=f/4-1,a){for(l=i.set(),n.setCN(t,l,"zoom-control-zoom"),w.push(l),r.set=w,r.zoomSet=l,5<tt&&(a=n.rect(i,f+6,tt+2*f+6,r.gridBackgroundColor,r.gridBackgroundAlpha,0,"#000000",0,4),n.setCN(t,a,"zoom-bg"),a.translate(-3,-3),a.mouseup(function(){r.handleBgUp()}).touchend(function(){r.handleBgUp()}),l.push(a)),v=f,it&&(v=f/1.5),r.draggerSize=v,ut=Math.log(et/st)/Math.log(o)+1,1e3<ut&&(ut=1e3),a=tt/ut,ot=i.set(),ot.translate((f-v)/2+1,1,NaN,!0),l.push(ot),ft=1;ft<ut;ft++)e=f+ft*a,e=n.line(i,[1,v-2],[e,e],r.gridColor,r.gridAlpha,1),n.setCN(t,e,"zoom-grid"),ot.push(e);e=new n.SimpleButton;e.setDownHandler(r.draggerDown,r);e.setClickHandler(r.draggerUp,r);e.init(i,v,a,b,y,k,d,p,g,nt);n.setCN(t,e.set,"zoom-dragger");l.push(e.set);e.set.setAttr("opacity",r.draggerAlpha);r.dragger=e.set;r.previousY=NaN;e=new n.SimpleButton;rt?(v=i.set(),ut=n.line(i,[-u,u],[0,0],c,h,1),ft=n.line(i,[0,0],[-u,u],c,h,1),v.push(ut),v.push(ft),e.svgIcon=v):e.setIcon(t.pathToImages+"plus.gif",r.iconSize);e.setClickHandler(t.zoomIn,t);e.init(i,f,f,b,y,k,d,p,g,nt,h,c,it);n.setCN(t,e.set,"zoom-in");l.push(e.set);e=new n.SimpleButton;rt?e.svgIcon=n.line(i,[-u,u],[0,0],c,h,1):e.setIcon(t.pathToImages+"minus.gif",r.iconSize);e.setClickHandler(t.zoomOut,t);e.init(i,f,f,b,y,k,d,p,g,nt,h,c,it);e.set.translate(0,tt+f);n.setCN(t,e.set,"zoom-out");l.push(e.set);tt-=a;et=Math.log(et/100)/Math.log(o);r.realStepSize=tt/(et-Math.log(st/100)/Math.log(o));r.realGridHeight=tt;r.stepMax=et}s&&(s=i.set(),n.setCN(t,s,"zoom-control-pan"),w.push(s),l&&l.translate(f,4*f),o=new n.SimpleButton,rt?o.svgIcon=n.line(i,[u/5,u/5-u,u/5],[-u,0,u],c,h,1):o.setIcon(t.pathToImages+"panLeft.gif",r.iconSize),o.setClickHandler(t.moveLeft,t),o.init(i,f,f,b,y,k,d,p,g,nt,h,c,it),o.set.translate(0,f),n.setCN(t,o.set,"pan-left"),s.push(o.set),o=new n.SimpleButton,rt?o.svgIcon=n.line(i,[-u/5,u-u/5,-u/5],[-u,0,u],c,h,1):o.setIcon(t.pathToImages+"panRight.gif",r.iconSize),o.setClickHandler(t.moveRight,t),o.init(i,f,f,b,y,k,d,p,g,nt,h,c,it),o.set.translate(2*f,f),n.setCN(t,o.set,"pan-right"),s.push(o.set),o=new n.SimpleButton,rt?o.svgIcon=n.line(i,[-u,0,u],[u/5,u/5-u,u/5],c,h,1):o.setIcon(t.pathToImages+"panUp.gif",r.iconSize),o.setClickHandler(t.moveUp,t),o.init(i,f,f,b,y,k,d,p,g,nt,h,c,it),o.set.translate(f,0),n.setCN(t,o.set,"pan-up"),s.push(o.set),o=new n.SimpleButton,rt?o.svgIcon=n.line(i,[-u,0,u],[-u/5,u-u/5,-u/5],c,h,1):o.setIcon(t.pathToImages+"panDown.gif",r.iconSize),o.setClickHandler(t.moveDown,t),o.init(i,f,f,b,y,k,d,p,g,nt,h,c,it),o.set.translate(f,2*f),n.setCN(t,o.set,"pan-down"),s.push(o.set),w.push(s));r.homeButtonEnabled&&(s=new n.SimpleButton,rt?s.svgIcon=n.polygon(i,[-u,0,u,u-1,u-1,2,2,-2,-2,1-u,1-u],[0,-u,0,0,u-1,u-1,2,2,u-1,u-1,0],c,h,1,c,h):s.setIcon(t.pathToImages+r.homeIconFile,r.iconSize),s.setClickHandler(t.goHome,t),r.panControlEnabled&&(p=y=0),s.init(i,f,f,b,y,k,d,p,g,nt,h,c,it),r.panControlEnabled?s.set.translate(f,f):l&&l.translate(0,1.5*f),n.setCN(t,s.set,"pan-home"),w.push(s.set));r.update()},draggerDown:function(){this.chart.stopDrag();this.isDragging=!0},draggerUp:function(){this.isDragging=!1},handleBgUp:function(){var n=this.chart;n.zoomTo(100*Math.pow(this.zoomFactor,this.stepMax-(n.mouseY-this.zoomSet.y-this.set.y-this.buttonSize-this.realStepSize/2)/this.realStepSize))},update:function(){var r=this.zoomFactor;var t,e=this.realStepSize,o=this.stepMax,f=this.dragger,u=this.buttonSize,i=this.chart;i&&(this.isDragging?(i.stopDrag(),t=f.y+(i.mouseY-this.previousY),t=n.fitToBounds(t,u,this.realGridHeight+u),i.zoomTo(100*Math.pow(r,o-(t-u)/e),NaN,NaN,!0)):(r=Math.log(i.zoomLevel()/100)/Math.log(r),t=(o-r)*e+u),this.previousY=i.mouseY,this.previousDY!=t&&f&&(f.translate((this.buttonSize-this.draggerSize)/2,t),this.previousDY=t))}})}(),function(){var n=window.HistoryMaps;n.SimpleButton=n.Class({construct:function(){},init:function(t,i,r,u,f,e,o,s,h,c,l,a,v){var y=this,p;y.rollOverColor=c;y.color=u;y.container=t;c=t.set();y.set=c;v?(i/=2,u=n.circle(t,i,u,f,e,o,s),u.translate(i,i)):u=n.rect(t,i,r,u,f,e,o,s,h);c.push(u);f=y.iconPath;f&&(p=y.iconSize,e=(i-p)/2,v&&(e=(2*i-p)/2),p=t.image(f,e,(r-p)/2,p,p));y.svgIcon&&(p=y.svgIcon,v?p.translate(i,i):p.translate(i/2,i/2));c.setAttr("cursor","pointer");p&&(c.push(p),p.setAttr("opacity",l),p.node.style.pointerEvents="none");u.mousedown(function(){y.handleDown()}).touchstart(function(){y.handleDown()}).mouseup(function(){y.handleUp()}).touchend(function(){y.handleUp()}).mouseover(function(){y.handleOver()}).mouseout(function(){y.handleOut()});y.bg=u},setIcon:function(n,t){this.iconPath=n;this.iconSize=t},setClickHandler:function(n,t){this.clickHandler=n;this.scope=t},setDownHandler:function(n,t){this.downHandler=n;this.scope=t},handleUp:function(){var n=this.clickHandler;n&&n.call(this.scope)},handleDown:function(){var n=this.downHandler;n&&n.call(this.scope)},handleOver:function(){this.container.chart.skipClick=!0;this.bg.setAttr("fill",this.rollOverColor)},handleOut:function(){this.container.chart.skipClick=!1;this.bg.setAttr("fill",this.color)}})}(),function(){var n=window.HistoryMaps;n.SmallMap=n.Class({construct:function(t){this.cname="SmallMap";this.mapColor="#e6e6e6";this.rectangleColor="#FFFFFF";this.top=this.right=10;this.minimizeButtonWidth=23;this.backgroundColor="#9A9A9A";this.backgroundAlpha=1;this.borderColor="#FFFFFF";this.iconColor="#000000";this.borderThickness=3;this.borderAlpha=1;this.size=.2;this.enabled=!0;n.applyTheme(this,t,this.cname)},init:function(t,i){var r=this,h,l,c,a,v;if(r.enabled){r.chart=t;r.container=i;r.width=t.realWidth*r.size;r.height=t.realHeight*r.size;n.remove(r.mapSet);n.remove(r.allSet);n.remove(r.set);h=i.set();r.set=h;n.setCN(t,h,"small-map");l=i.set();r.allSet=l;h.push(l);r.buildSVGMap();var u=r.borderThickness,e=r.borderColor,f=n.rect(i,r.width+u,r.height+u,r.backgroundColor,r.backgroundAlpha,u,e,r.borderAlpha);n.setCN(t,f,"small-map-bg");f.translate(-u/2,-u/2);l.push(f);f.toBack();var y,p,f=r.minimizeButtonWidth,o=new n.SimpleButton,s=f/2;t.svgIcons?o.svgIcon=n.line(i,[-s/2,0,s/2],[-s/4,s/4,-s/4],r.iconColor,1,1):o.setIcon(t.pathToImages+"arrowDown.gif",f);o.setClickHandler(r.minimize,r);o.init(i,f,f,e,1,1,e,1);n.setCN(t,o.set,"small-map-down");o=o.set;r.downButtonSet=o;h.push(o);c=new n.SimpleButton;t.svgIcons?c.svgIcon=n.line(i,[-s/2,0,s/2],[s/4,-s/4,s/4],r.iconColor,1,1):c.setIcon(t.pathToImages+"arrowUp.gif",f);c.setClickHandler(r.maximize,r);c.init(i,f,f,e,1,1,e,1);n.setCN(t,c.set,"small-map-up");e=c.set;r.upButtonSet=e;e.hide();h.push(e);isNaN(r.top)||(y=t.getY(r.top)+u,v=0);isNaN(r.bottom)||(y=t.getY(r.bottom,!0)-r.height-u,v=r.height-f+u/2);isNaN(r.left)||(p=t.getX(r.left)+u,a=-u/2);isNaN(r.right)||(p=t.getX(r.right,!0)-r.width-u,a=r.width-f+u/2);u=i.set();u.clipRect(1,1,r.width,r.height);l.push(u);r.rectangleC=u;h.translate(p,y);o.translate(a,v);e.translate(a,v);l.mouseup(function(){r.handleMouseUp()});r.drawRectangle()}else n.remove(r.allSet),n.remove(r.downButtonSet),n.remove(r.upButtonSet)},minimize:function(){this.downButtonSet.hide();this.upButtonSet.show();this.allSet.hide()},maximize:function(){this.downButtonSet.show();this.upButtonSet.hide();this.allSet.show()},buildSVGMap:function(){var f=this.chart,i={fill:this.mapColor,stroke:this.mapColor,"stroke-opacity":1},t=this.container,u=t.set(),r,e;for(n.setCN(f,u,"small-map-image"),r=0;r<f.svgAreas.length;r++)e=t.path(f.svgAreas[r].path).attr(i),u.push(e);this.allSet.push(u);i=u.getBBox();t=this.size*f.mapScale;r=-i.x*t;var e=-i.y*t,o=0,s=0;f.centerMap&&(o=(this.width-i.width*t)/2,s=(this.height-i.height*t)/2);this.mapWidth=i.width*t;this.mapHeight=i.height*t;r+=o;e+=s;this.dx=o;this.dy=s;u.translate(r,e,t);this.mapSet=u;this.mapX=r;this.mapY=e},update:function(){var n=this.chart;if(n){var t=n.zoomLevel(),i=this.width,r=this.height,f=i/(n.realWidth*t),e=n.mapContainer.getBBox(),i=i/t,r=r/t,u=this.rectangle;u.translate(-(n.mapContainer.x+e.x*t)*f+this.dx,-(n.mapContainer.y+e.y*t)*f+this.dy);0<i&&0<r&&(u.setAttr("width",Math.ceil(i+1)),u.setAttr("height",Math.ceil(r+1)));this.rWidth=i;this.rHeight=r}},drawRectangle:function(){var t=this.rectangle;n.remove(t);t=n.rect(this.container,10,10,"#000",0,1,this.rectangleColor,1);n.setCN(this.chart,t,"small-map-rectangle");this.rectangleC.push(t);this.rectangle=t},handleMouseUp:function(){var n=this.chart,t=n.zoomLevel();n.zoomToMapXY(t,(n.mouseX-this.set.x-this.mapX)/this.size+n.diffX*n.mapScale,(n.mouseY-this.set.y-this.mapY)/this.size+n.diffY*n.mapScale)}})}(),function(){var n=window.HistoryMaps;n.AreasProcessor=n.Class({construct:function(n){this.chart=n},process:function(n){var r;this.updateAllAreas();this.allObjects=[];n=n.areas;r=this.chart;r.outlines=[];for(var t,e=n.length,o=0,f=!1,u=!1,s=0,i=0;i<e;i++)t=n[i],t=t.value,isNaN(t)||((!1===f||f<t)&&(f=t),(!1===u||u>t)&&(u=t),o+=Math.abs(t),s++);for(this.minValue=u,this.maxValue=f,isNaN(r.minValue)||(this.minValue=r.minValue),isNaN(r.maxValue)||(this.maxValue=r.maxValue),r.maxValueReal=f,r.minValueReal=u,i=0;i<e;i++)t=n[i],isNaN(t.value)?t.percents=void 0:(t.percents=(t.value-u)/o*100,u==f&&(t.percents=100));for(i=0;i<e;i++)t=n[i],this.createArea(t);r.outlinesToFront()},updateAllAreas:function(){for(var u=this.chart,f=u.areasSettings,s=f.unlistedAreasColor,h=f.unlistedAreasAlpha,c=f.unlistedAreasOutlineColor,l=f.unlistedAreasOutlineAlpha,a=u.svgAreas,e=u.dataProvider,t=e.areas,v={},o,r,i=0;i<t.length;i++)v[t[i].id]=t[i];for(i=0;i<a.length;i++){if(t=a[i],f.preserveOriginalAttributes){if(t.customAttr)for(o in t.customAttr)t.setAttr(o,t.customAttr[o])}else void 0!=s&&t.setAttr("fill",s),isNaN(h)||t.setAttr("fill-opacity",h),void 0!=c&&t.setAttr("stroke",c),isNaN(l)||t.setAttr("stroke-opacity",l),r=f.outlineThickness,f.adjustOutlineThickness&&(r=r/u.zoomLevel()/u.mapScale),t.setAttr("stroke-width",r);n.setCN(u,t,"map-area-unlisted");e.getAreasFromMap&&!v[t.id]&&(r=new n.MapArea(u.theme),r.parentObject=e,r.id=t.id,r.outline=t.outline,e.areas.push(r))}},createArea:function(t){var r=this.chart,f=r.svgAreasById[t.id],i=r.areasSettings,e,a,g;f&&f.className&&(e=r.areasClasses[f.className],e&&(i=n.processObject(e,n.AreasSettings,r.theme)));var s=i.color,h=i.alpha,w=i.outlineThickness,c=i.rollOverColor,b=i.selectedColor,k=i.rollOverAlpha,u=i.rollOverBrightness,v=i.outlineColor,o=i.outlineAlpha,l=i.balloonText,nt=i.selectable,y=i.pattern,d=i.rollOverOutlineColor,p=i.bringForwardOnHover,tt=i.preserveOriginalAttributes;this.allObjects.push(t);t.chart=r;t.baseSettings=i;t.autoZoomReal=void 0==t.autoZoom?i.autoZoom:t.autoZoom;void 0==(e=t.color)&&(e=s);a=t.alpha;(isNaN(a)&&(a=h),h=t.rollOverAlpha,isNaN(h)&&(h=k),isNaN(h)&&(h=a),k=t.rollOverColor,void 0==k&&(k=c),c=t.pattern,void 0==c&&(c=y),y=t.selectedColor,void 0==y&&(y=b),b=t.balloonText,void 0===b&&(b=l),void 0==i.colorSolid||isNaN(t.value)||(l=Math.floor((t.value-this.minValue)/((this.maxValue-this.minValue)/r.colorSteps)),l==r.colorSteps&&l--,l*=1/(r.colorSteps-1),this.maxValue==this.minValue&&(l=1),t.colorReal=n.getColorFade(e,i.colorSolid,l)),void 0!=t.color&&(t.colorReal=t.color),void 0==t.selectable&&(t.selectable=nt),void 0==t.colorReal&&(t.colorReal=s),s=t.outlineColor,void 0==s&&(s=v),v=t.outlineAlpha,isNaN(v)&&(v=o),o=t.outlineThickness,isNaN(o)&&(o=w),w=t.rollOverOutlineColor,void 0==w&&(w=d),d=t.rollOverBrightness,void 0==d&&(d=u),void 0==t.bringForwardOnHover&&(t.bringForwardOnHover=p),void 0==t.preserveOriginalAttributes&&(t.preserveOriginalAttributes=tt),isNaN(i.selectedBrightness)||(y=n.adjustLuminosity(t.colorReal,i.selectedBrightness/100)),t.alphaReal=a,t.rollOverColorReal=k,t.rollOverAlphaReal=h,t.balloonTextReal=b,t.selectedColorReal=y,t.outlineColorReal=s,t.outlineAlphaReal=v,t.rollOverOutlineColorReal=w,t.outlineThicknessReal=o,t.patternReal=c,t.rollOverBrightnessReal=d,t.accessibleLabel||(t.accessibleLabel=i.accessibleLabel),n.processDescriptionWindow(i,t),f&&(u=f.area,p=f.title,t.enTitle=f.title,p&&!t.title&&(t.title=p),(f=r.language)?(p=n.mapTranslations)&&(f=p[f])&&f[t.enTitle]&&(t.titleTr=f[t.enTitle]):t.titleTr=void 0,u))&&(f=t.tabIndex,void 0===f&&(f=i.tabIndex),void 0!==f&&u.setAttr("tabindex",f),t.displayObject=u,t.outline&&(a=0,t.alphaReal=0,t.rollOverAlphaReal=0,t.mouseEnabled=!1,r.outlines.push(u),u.node.setAttribute("pointer-events","none")),t.mouseEnabled&&r.addObjectEventListeners(u,t),void 0!=e&&(g=e),void 0!=t.colorReal&&(g=t.showAsSelected||r.selectedObject==t?t.selectedColorReal:t.colorReal),u.node.setAttribute("class",""),n.setCN(r,u,"map-area"),n.setCN(r,u,"map-area-"+u.id),i.adjustOutlineThickness&&(o=o/r.zoomLevel()/r.mapScale),t.preserveOriginalAttributes||(u.setAttr("fill",g),u.setAttr("stroke",s),u.setAttr("stroke-opacity",v),u.setAttr("stroke-width",o),u.setAttr("fill-opacity",a)),r.makeObjectAccessible(t),c&&u.pattern(c,r.mapScale,r.path),t.hidden&&u.hide())}})}(),function(){var n=window.HistoryMaps;n.AreasSettings=n.Class({construct:function(t){this.cname="AreasSettings";this.alpha=1;this.autoZoom=!1;this.balloonText="[[title]]";this.color="#FFCC00";this.colorSolid="#990000";this.unlistedAreasAlpha=1;this.unlistedAreasColor="#DDDDDD";this.outlineColor="#FFFFFF";this.outlineThickness=this.outlineAlpha=1;this.selectedColor=this.rollOverOutlineColor="#CC0000";this.unlistedAreasOutlineColor="#FFFFFF";this.unlistedAreasOutlineAlpha=1;this.descriptionWindowWidth=250;this.bringForwardOnHover=this.adjustOutlineThickness=!0;this.accessibleLabel="[[title]] [[value]] [[description]]";n.applyTheme(this,t,this.cname)}})}(),function(){var n=window.HistoryMaps;n.ImagesProcessor=n.Class({construct:function(n){this.chart=n;this.reset()},process:function(n){for(var i=n.images,r,t=0;t<i.length;t++)r=i[t],this.createImage(r,t),r.parentArray=i;this.counter=t;n.parentObject&&n.remainVisible&&this.process(n.parentObject)},createImage:function(t,i){var l,y,r;t=n.processObject(t,n.MapImage);isNaN(i)&&(this.counter++,i=this.counter);var f=this.chart,a=f.container,et=f.mapImagesContainer,ot=f.stageImagesContainer,u=f.imagesSettings;t.remove&&t.remove();var p=u.color,w=u.alpha,g=u.rollOverColor,b=u.rollOverOutlineColor,tt=u.selectedColor,d=u.balloonText,nt=u.outlineColor,s=u.outlineAlpha,ft=u.outlineThickness,k=u.selectedScale,h=u.rollOverScale,v=u.selectable,it=u.labelPosition,rt=u.labelColor,e=u.labelFontSize,st=u.bringForwardOnHover,ut=u.labelRollOverColor,c=u.rollOverBrightness,o=u.selectedLabelColor;return t.index=i,t.chart=f,t.baseSettings=f.imagesSettings,l=a.set(),t.displayObject=l,y=t.color,void 0==y&&(y=p),p=t.alpha,isNaN(p)&&(p=w),void 0==t.bringForwardOnHover&&(t.bringForwardOnHover=st),w=t.outlineAlpha,isNaN(w)&&(w=s),s=t.rollOverColor,void 0==s&&(s=g),g=t.selectedColor,void 0==g&&(g=tt),tt=t.balloonText,void 0===tt&&(tt=d),d=t.outlineColor,void 0==d&&(d=nt),t.outlineColorReal=d,nt=t.outlineThickness,isNaN(nt)&&(nt=ft),(ft=t.labelPosition)||(ft=it),it=t.labelColor,void 0==it&&(it=rt),rt=t.labelRollOverColor,void 0==rt&&(rt=ut),ut=t.selectedLabelColor,void 0==ut&&(ut=o),o=t.labelFontSize,isNaN(o)&&(o=e),e=t.selectedScale,isNaN(e)&&(e=k),k=t.rollOverScale,isNaN(k)&&(k=h),h=t.rollOverBrightness,void 0==h&&(h=c),void 0==t.selectable&&(t.selectable=v),t.colorReal=y,isNaN(u.selectedBrightness)||(g=n.adjustLuminosity(t.colorReal,u.selectedBrightness/100)),t.alphaReal=p,t.rollOverColorReal=s,t.balloonTextReal=tt,t.selectedColorReal=g,t.labelColorReal=it,t.labelRollOverColorReal=rt,t.selectedLabelColorReal=ut,t.labelFontSizeReal=o,t.labelPositionReal=ft,t.selectedScaleReal=e,t.rollOverScaleReal=k,t.rollOverOutlineColorReal=b,t.rollOverBrightnessReal=h,t.accessibleLabel||(t.accessibleLabel=u.accessibleLabel),n.processDescriptionWindow(u,t),t.centeredReal=void 0==t.centered?u.centered:t.centered,b=t.type,h=t.imageURL,k=t.svgPath,e=t.width,o=t.height,v=t.scale,isNaN(t.percentWidth)||(e=t.percentWidth/100*f.realWidth),isNaN(t.percentHeight)||(o=t.percentHeight/100*f.realHeight),h||b||k||(b="circle",e=1,w=p=0),s=c=0,u=t.selectedColorReal,b?(isNaN(e)&&(e=10),isNaN(o)&&(o=10),"kilometers"==t.widthAndHeightUnits&&(e=f.kilometersToPixels(t.width),o=f.kilometersToPixels(t.height)),"miles"==t.widthAndHeightUnits&&(e=f.milesToPixels(t.width),o=f.milesToPixels(t.height)),"circle"!=b&&"bubble"!=b||(o=e),r=this.createPredefinedImage(y,d,nt,b,e,o),s=c=0,t.centeredReal?(isNaN(t.right)||(c=e*v),isNaN(t.bottom)||(s=o*v)):(c=e*v/2,s=o*v/2),r.translate(c,s,v,!0)):h?(isNaN(e)&&(e=10),isNaN(o)&&(o=10),r=a.image(h,0,0,e,o),r.node.setAttribute("preserveAspectRatio","none"),r.setAttr("opacity",p),t.centeredReal&&(c=isNaN(t.right)?-e/2:e/2,s=isNaN(t.bottom)?-o/2:o/2,r.translate(c,s,NaN,!0))):k&&(r=a.path(k),h=r.getBBox(),t.centeredReal?(c=-h.x*v-h.width*v/2,isNaN(t.right)||(c=-c),s=-h.y*v-h.height*v/2,isNaN(t.bottom)||(s=-s)):c=s=0,r.translate(c,s,v,!0),r.x=c,r.y=s),r&&(l.push(r),t.image=r,r.setAttr("stroke-opacity",w),r.setAttr("stroke-width",nt),r.setAttr("stroke",d),r.setAttr("fill-opacity",p),"bubble"!=b&&r.setAttr("fill",y),n.setCN(f,r,"map-image"),void 0!=t.id&&n.setCN(f,r,"map-image-"+t.id)),y=t.labelColorReal,!t.showAsSelected&&f.selectedObject!=t||void 0==u||(r.setAttr("fill",u),y=t.selectedLabelColorReal),r=null,void 0!==t.label&&(r=n.text(a,t.label,y,f.fontFamily,t.labelFontSizeReal,t.labelAlign),n.setCN(f,r,"map-image-label"),void 0!==t.id&&n.setCN(f,r,"map-image-label-"+t.id),y=t.labelBackgroundAlpha,(p=t.labelBackgroundColor)&&0<y&&(w=r.getBBox(),a=n.rect(a,w.width+16,w.height+10,p,y),n.setCN(f,a,"map-image-label-background"),void 0!=t.id&&n.setCN(f,a,"map-image-label-background-"+t.id),l.push(a),t.labelBG=a),t.imageLabel=r,l.push(r),n.setCN(f,l,"map-image-container"),void 0!=t.id&&n.setCN(f,l,"map-image-container-"+t.id)),a=!(!isNaN(t.latitude)&&!isNaN(t.longitude)),t.lineId&&(r=this.chart.getObjectById(t.lineId))&&0<r.longitudes.length&&(a=!1),a?ot.push(l):et.push(l),l&&(l.rotation=t.rotation,isNaN(t.rotation)||l.rotate(t.rotation)),this.updateSizeAndPosition(t),t.mouseEnabled&&f.addObjectEventListeners(l,t),t.hidden&&l.hide(),t.animateAlongLine&&setTimeout(function(){t.animateAlong.call(t)},100),t},updateSizeAndPosition:function(t){var c,r=this.chart,e=t.displayObject,o=r.getX(t.left),u=r.getY(t.top),h=t.image.getBBox(),f,v,y,p,i;isNaN(t.right)||(o=r.getX(t.right,!0)-h.width*t.scale);isNaN(t.bottom)||(u=r.getY(t.bottom,!0)-h.height*t.scale);var l=t.longitude,a=t.latitude,s=t.positionOnLine,h=this.objectsToResize;this.allSvgObjects.push(e);this.allObjects.push(t);t.arrays.push({arr:this.allSvgObjects,el:e});t.arrays.push({arr:this.allObjects,el:t});y=t.imageLabel;p=this.chart.zoomLevel();t.lineId&&(t.line=this.chart.getObjectById(t.lineId));r.makeObjectAccessible(t);i=t.tabIndex;void 0===i&&(i=r.imagesSettings.tabIndex);void 0!==i&&e.setAttr("tabindex",i);t.line&&t.line.getCoordinates&&(t.line.chart=r,i=t.line.getCoordinates(s,t.lineSegment))&&(l=r.coordinateToLongitude(i.x),a=r.coordinateToLatitude(i.y),f=i.x,v=i.y,t.animateAngle&&(c=n.radiansToDegrees(i.angle)));isNaN(c)||e.rotate(c+t.extraAngle);isNaN(o)||isNaN(u)?isNaN(a)||isNaN(l)||(u=r.coordinatesToXY(l,a),o=u.x,u=u.y,isNaN(f)||(o=f),isNaN(v)||(u=v),t.fixedSize?(f=t.positionScale,isNaN(f)?f=0:(--f,f*=1-2*Math.abs(s-.5)),s={image:e,scale:1+f,mapImage:t},h.push(s),t.arrays.push({arr:h,el:s}),e.translate(o,u,1/p+f,!0)):(e.translate(o,u,NaN,!0),y&&(this.labelsToReposition.push(t),t.arrays.push({arr:this.labelsToReposition,el:t})))):e.translate(o,u,NaN,!0);this.positionLabel(y,t,t.labelPositionReal)},positionLabel:function(n,t,i){if(n){var e=t.image,u=0,f=0,o=0,r=0;e&&(r=e.getBBox(),f=e.y+r.y,u=e.x+r.x,o=r.width,r=r.height,t.svgPath&&(o*=t.scale,r*=t.scale));var e=n.getBBox(),s=e.width,h=e.height;"right"==i&&(u+=o+s/2+5,f+=r/2-2);"left"==i&&(u+=-s/2-5,f+=r/2-2);"top"==i&&(f-=h/2+3,u+=o/2);"bottom"==i&&(f+=r+h/2,u+=o/2);"middle"==i&&(u+=o/2,f+=r/2);n.translate(u+t.labelShiftX,f+t.labelShiftY,NaN,!0);n=t.labelFontSizeReal;t.labelBG&&t.labelBG.translate(u-e.width/2+t.labelShiftX-9,f-n/2+t.labelShiftY-4,NaN,!0)}},createPredefinedImage:function(t,i,r,u,f,e){var o,s=this.chart.container;switch(u){case"circle":o=n.circle(s,f/2,t,1,r,i,1);break;case"rectangle":o=n.polygon(s,[-f/2,f/2,f/2,-f/2],[e/2,e/2,-e/2,-e/2],t,1,r,i,1,0,!0);break;case"bubble":o=n.circle(s,f/2,t,1,r,i,1,!0);break;case"hexagon":f/=Math.sqrt(3);o=n.polygon(s,[.866*f,0*f,-.866*f,-.866*f,0*f,.866*f],[.5*f,1*f,.5*f,-.5*f,-1*f,-.5*f],t,1,r,i,1)}return o},reset:function(){this.objectsToResize=[];this.allSvgObjects=[];this.allObjects=[];this.allLabels=[];this.labelsToReposition=[]}})}(),function(){var n=window.HistoryMaps;n.ImagesSettings=n.Class({construct:function(t){this.cname="ImagesSettings";this.balloonText="[[title]]";this.alpha=1;this.borderAlpha=0;this.borderThickness=1;this.labelPosition="right";this.labelColor="#000000";this.labelFontSize=11;this.color="#000000";this.labelRollOverColor="#00CC00";this.centered=!0;this.rollOverScale=this.selectedScale=1;this.descriptionWindowWidth=250;this.bringForwardOnHover=!0;this.outlineColor="transparent";this.adjustAnimationSpeed=!1;this.baseAnimationDistance=500;this.pauseDuration=0;this.easingFunction=n.easeInOutQuad;this.animationDuration=3;this.positionScale=1;this.accessibleLabel="[[title]] [[description]]";n.applyTheme(this,t,this.cname)}})}(),function(){var n=window.HistoryMaps;n.LinesProcessor=n.Class({construct:function(n){this.chart=n;this.reset()},process:function(n){for(var i=n.lines,r,t=0;t<i.length;t++)r=i[t],this.createLine(r,t),r.parentArray=i;this.counter=t;n.parentObject&&n.remainVisible&&this.process(n.parentObject)},createLine:function(t,i){var k,g,l,ht,nt,r,v,y,u,ut,ot;t=n.processObject(t,n.MapLine);isNaN(i)&&(this.counter++,i=this.counter);t.index=i;t.remove&&t.remove();var a=this.chart,s=a.linesSettings,rt=this.objectsToResize,pt=a.mapLinesContainer,wt=a.stageLinesContainer,v=s.thickness,w=s.dashLength,d=s.arrow,p=s.arrowSize,it=s.arrowColor,o=s.arrowAlpha,tt=s.color,r=s.alpha,ft=s.rollOverColor,h=s.selectedColor,f=s.rollOverAlpha,et=s.balloonText,e=s.bringForwardOnHover,b=s.arc,c=s.rollOverBrightness,st=a.container;if(t.chart=a,t.baseSettings=s,k=st.set(),t.displayObject=k,g=t.tabIndex,void 0===g&&(g=s.tabIndex),void 0!==g&&k.setAttr("tabindex",g),this.allSvgObjects.push(k),t.arrays.push({arr:this.allSvgObjects,el:k}),this.allObjects.push(t),t.arrays.push({arr:this.allObjects,el:t}),t.mouseEnabled&&a.addObjectEventListeners(k,t),t.remainVisible||a.selectedObject==t.parentObject){if(g=t.thickness,isNaN(g)&&(g=v),v=t.dashLength,isNaN(v)&&(v=w),w=t.color,void 0==w&&(w=tt),tt=t.alpha,isNaN(tt)&&(tt=r),r=t.rollOverAlpha,isNaN(r)&&(r=f),isNaN(r)&&(r=tt),f=t.rollOverColor,void 0==f&&(f=ft),ft=t.selectedColor,void 0==ft&&(ft=h),h=t.balloonText,void 0===h&&(h=et),et=t.arc,isNaN(et)&&(et=b),b=t.arrow,(!b||"none"==b&&"none"!=d)&&(b=d),d=t.arrowColor,void 0==d&&(d=it),void 0==d&&(d=w),it=t.arrowAlpha,isNaN(it)&&(it=o),isNaN(it)&&(it=tt),o=t.arrowSize,isNaN(o)&&(o=p),p=t.rollOverBrightness,void 0==p&&(p=c),t.colorReal=w,t.arrowColor=d,isNaN(s.selectedBrightness)||(ft=n.adjustLuminosity(t.colorReal,s.selectedBrightness/100)),t.alphaReal=tt,t.rollOverColorReal=f,t.rollOverAlphaReal=r,t.balloonTextReal=h,t.selectedColorReal=ft,t.thicknessReal=g,t.rollOverBrightnessReal=p,t.accessibleLabel||(t.accessibleLabel=s.accessibleLabel),void 0===t.shiftArrow&&(t.shiftArrow=s.shiftArrow),void 0==t.bringForwardOnHover&&(t.bringForwardOnHover=e),n.processDescriptionWindow(s,t),e=this.processCoordinates(t.x,a.realWidth),c=this.processCoordinates(t.y,a.realHeight),p=t.longitudes,s=t.latitudes,0<(r=p.length))for(e=[],c=[],f=0;f<r;f++)h=a.coordinatesToXY(p[f],s[f]),e.push(h.x),c.push(h.y);if(0<e.length){if(t.segments=e.length,n.dx=0,n.dy=0,r=10*(1-Math.abs(et)),10<=r&&(r=NaN),1>r&&(r=1),t.arcRadius=[],t.distances=[],p=a.mapContainer.scale,isNaN(r)){for(r=0;r<e.length-1;r++)ht=Math.sqrt(Math.pow(e[r+1]-e[r],2)+Math.pow(c[r+1]-c[r],2)),t.distances[r]=ht;r=n.line(st,e,c,w,1,g/p,v,!1,!1,!0);w=n.line(st,e,c,w,.001,5/p,v,!1,!1,!0);r.setAttr("stroke-linecap","round")}else{for(f=1,0>et&&(f=0),h={fill:"none",stroke:w,"stroke-opacity":1,"stroke-width":g/p,"fill-opacity":0,"stroke-linecap":"round"},void 0!==v&&0<v&&(h["stroke-dasharray"]=v),v="",y=0;y<e.length-1;y++){var ct=e[y],lt=e[y+1],at=c[y],vt=c[y+1];if(ht=Math.sqrt(Math.pow(lt-ct,2)+Math.pow(vt-at,2)),nt=ht/2*r,l=270+180*Math.acos(ht/2/nt)/Math.PI,isNaN(l)&&(l=270),ct<lt){var yt=ct,ct=lt,lt=yt,yt=at,at=vt,vt=yt;l=-l}0<et&&(l=-l);v+="M"+ct+","+at+"A"+nt+","+nt+",0,0,"+f+","+lt+","+vt;t.arcRadius[y]=nt;t.distances[y]=ht}r=st.path(v).attr(h);w=st.path(v).attr({"fill-opacity":0,stroke:w,"stroke-width":5/p,"stroke-opacity":.001,fill:"none"})}(n.setCN(a,r,"map-line"),void 0!=t.id&&n.setCN(a,r,"map-line-"+t.id),n.dx=.5,n.dy=.5,k.push(r),k.push(w),r.setAttr("opacity",tt),"none"!=b)&&("end"!=b&&"both"!=b||(f=e[e.length-1],y=c[c.length-1],1<e.length?(h=e[e.length-2],u=c[c.length-2]):(h=f,u=y),u=180*Math.atan((y-u)/(f-h))/Math.PI,isNaN(l)||(u+=l),ut=f,ot=y,u=0>f-h?u-90:u+90),tt=[-o/2-.5,-.5,o/2-.5],v=[o,-.5,o],t.shiftArrow&&"middle"!=b&&(v=[0,1.2*-o,0]),"both"==b&&(o=n.polygon(st,tt,v,d,it,1,d,it,void 0,!0),k.push(o),o.translate(ut,ot,1/p,!0),isNaN(u)||o.rotate(u),n.setCN(a,r,"map-line-arrow"),void 0!=t.id&&n.setCN(a,r,"map-line-arrow-"+t.id),t.fixedSize&&rt.push(o)),"start"!=b&&"both"!=b||(o=e[0],ot=c[0],1<e.length?(f=e[1],ut=c[1]):(f=o,ut=ot),u=180*Math.atan((ot-ut)/(o-f))/Math.PI,isNaN(l)||(u-=l),ut=o,u=0>o-f?u-90:u+90),"middle"==b&&(f=e[e.length-1],y=c[c.length-1],1<e.length?(h=e[e.length-2],u=c[c.length-2]):(h=f,u=y),ut=h+(f-h)/2,ot=u+(y-u)/2,u=180*Math.atan((y-u)/(f-h))/Math.PI,isNaN(l)||(l=ht/2,nt-=Math.sqrt(nt*nt-l*l),0>et&&(nt=-nt),l=Math.sin(u/180*Math.PI),-1==l&&(l=1),ut-=l*nt,ot+=Math.cos(u/180*Math.PI)*nt),u=0>f-h?u-90:u+90),o=n.polygon(st,tt,v,d,it,1,d,it,void 0,!0),n.setCN(a,r,"map-line-arrow"),void 0!=t.id&&n.setCN(a,r,"map-line-arrow-"+t.id),k.push(o),o.translate(ut,ot,1/p,!0),isNaN(u)||o.rotate(u),t.fixedSize&&(rt.push(o),t.arrays.push({arr:rt,el:o})),t.arrowSvg=o);t.fixedSize&&r&&(rt={line:r,thickness:g},this.linesToResize.push(rt),t.arrays.push({arr:this.linesToResize,el:rt}),rt={line:w,thickness:5},this.linesToResize.push(rt),t.arrays.push({arr:this.linesToResize,el:rt}));t.lineSvg=r;t.showAsSelected&&!isNaN(ft)&&r.setAttr("stroke",ft);0<s.length?pt.push(k):wt.push(k);t.hidden&&k.hide();a.makeObjectAccessible(t)}}},processCoordinates:function(n,t){for(var f=[],u,i,r=0;r<n.length;r++)u=n[r],i=Number(u),isNaN(i)&&(i=Number(u.replace("%",""))*t/100),isNaN(i)||f.push(i);return f},reset:function(){this.objectsToResize=[];this.allSvgObjects=[];this.allObjects=[];this.linesToResize=[]}})}(),function(){var n=window.HistoryMaps;n.LinesSettings=n.Class({construct:function(t){this.cname="LinesSettings";this.balloonText="[[title]]";this.thickness=1;this.dashLength=0;this.arrowSize=10;this.arrowAlpha=1;this.arrow="none";this.color="#990000";this.descriptionWindowWidth=250;this.bringForwardOnHover=!0;n.applyTheme(this,t,this.cname)}})}(),function(){var n=window.HistoryMaps;n.MapObject=n.Class({construct:function(t){this.fixedSize=this.mouseEnabled=!0;this.images=[];this.lines=[];this.areas=[];this.remainVisible=!0;this.passZoomValuesToTarget=!1;this.objectType=this.cname;n.applyTheme(this,t,"MapObject");this.arrays=[]},deleteObject:function(){if(this.remove(),this.parentArray&&n.removeFromArray(this.parentArray,this),this.arrays)for(var t=0;t<this.arrays.length;t++)n.removeFromArray(this.arrays[t].arr,this.arrays[t].el);this.arrays=[]}})}(),function(){var n=window.HistoryMaps;n.MapArea=n.Class({inherits:n.MapObject,construct:function(t){this.cname="MapArea";n.MapArea.base.construct.call(this,t);n.applyTheme(this,t,this.cname)},validate:function(){this.chart.areasProcessor.createArea(this)}})}(),function(){var n=window.HistoryMaps;n.MapLine=n.Class({inherits:n.MapObject,construct:function(t){this.cname="MapLine";this.longitudes=[];this.latitudes=[];this.x=[];this.y=[];this.segments=0;this.arrow="none";n.MapLine.base.construct.call(this,t);n.applyTheme(this,t,this.cname)},validate:function(){this.chart.linesProcessor.createLine(this)},remove:function(){var n=this.displayObject;n&&n.remove()},getCoordinates:function(t,i){var r,f,u,o,l,s,e,h,c,a;if(isNaN(i)&&(i=0),isNaN(this.arc)||this.validate(),!isNaN(t))return 1<this.longitudes.length?(f=this.chart.coordinatesToXY(this.longitudes[i],this.latitudes[i]),e=this.chart.coordinatesToXY(this.longitudes[i+1],this.latitudes[i+1]),r=f.x,u=e.x,f=f.y,o=e.y):1<this.x.length&&(r=this.x[i],u=this.x[i+1],f=this.y[i],o=this.y[i+1]),e=Math.sqrt(Math.pow(u-r,2)+Math.pow(o-f,2)),r<u&&!isNaN(this.arc)&&0!==this.arc&&(t=1-t),l=r+(u-r)*t,s=f+(o-f)*t,h=Math.atan2(o-f,u-r),!isNaN(this.arc)&&0!==this.arc&&this.arcRadius&&(c=0,r<u&&(c=r,r=u,u=c,c=f,f=o,o=c,c=Math.PI),s=this.arcRadius[i],0>this.arc&&(e=-e),l=r+(u-r)/2+Math.sqrt(s*s-e/2*(e/2))*(f-o)/e,a=f+(o-f)/2+Math.sqrt(s*s-e/2*(e/2))*(u-r)/e,r=180*Math.atan2(f-a,r-l)/Math.PI,u=180*Math.atan2(o-a,u-l)/Math.PI,180<u-r&&(u-=360),h=n.degreesToRadians(r+(u-r)*t),l+=s*Math.cos(h),s=a+s*Math.sin(h),h=0<this.arc?h+Math.PI/2:h-Math.PI/2,h+=c),this.distance=e,{x:l,y:s,angle:h}},fixToStage:function(){var n,t;if(0<this.latitudes.length){for(this.y=[],n=0;n<this.latitudes.length;n++)t=this.chart.coordinatesToStageXY(this.longitudes[n],this.latitudes[n]),this.y.push(t.y),this.x.push(t.x);this.latitudes=[];this.longitudes=[]}this.validate()},fixToMap:function(){var n,t;if(0<this.y.length){for(this.latitudes=[],n=0;n<this.y.length;n++)t=this.chart.stageXYToCoordinates(this.x[n],this.y[n]),this.latitudes.push(t.latitude),this.longitudes.push(t.longitude);this.y=[];this.x=[]}this.validate()}})}(),function(){var n=window.HistoryMaps;n.MapImage=n.Class({inherits:n.MapObject,construct:function(t){this.cname="MapImage";this.scale=1;this.widthAndHeightUnits="pixels";this.labelShiftY=this.labelShiftX=0;this.positionOnLine=.5;this.direction=1;this.lineSegment=this.extraAngle=0;this.animateAngle=!0;this.createEvents("animationStart","animationEnd");n.MapImage.base.construct.call(this,t);n.applyTheme(this,t,this.cname)},validate:function(){this.chart.imagesProcessor.createImage(this)},updatePosition:function(){this.chart.imagesProcessor.updateSizeAndPosition(this)},remove:function(){var n=this.displayObject;n&&n.remove();(n=this.imageLabel)&&n.remove()},animateTo:function(n,t,i,r){isNaN(i)||(this.animationDuration=i);r&&(this.easingFunction=r);this.finalX=n;this.finalY=t;isNaN(this.longitude)||(this.initialX=this.longitude);isNaN(this.left)||(this.initialX=this.left);isNaN(this.right)||(this.initialX=this.right);isNaN(this.latitude)||(this.initialY=this.latitude);isNaN(this.top)||(this.initialY=this.top);isNaN(this.bottom)||(this.initialY=this.bottom);this.animatingAlong=!1;this.animate()},animateAlong:function(n,t,i){1==this.positionOnLine&&this.flipDirection&&(this.direction=-1,this.extraAngle=180);isNaN(t)||(this.animationDuration=t);i&&(this.easingFunction=i);n&&(this.line=this.chart.getObjectById(n));this.animateAlongLine=this.line;this.animatingAlong=!0;this.animate()},animate:function(){var t=this,r=t.chart.imagesSettings,i=t.animationDuration;isNaN(i)&&(i=r.animationDuration);t.totalFrames=i*n.updateRate;i=1;t.line&&r.adjustAnimationSpeed&&(t.line.distances&&(i=t.line.distances[t.lineSegment]*t.chart.zoomLevel(),i=Math.abs(i/r.baseAnimationDistance)),t.totalFrames=Math.round(i*t.totalFrames));t.frame=0;t.clearTO();t.timeOut=setTimeout(function(){t.update.call(t)},1e3/n.updateRate);t.fire({type:"animationStart",chart:t.chart,image:this,lineSegment:t.lineSegment,direction:t.direction})},clearTO:function(){this.timeOut&&clearTimeout(this.timeOut)},update:function(){var t=this;t.updatePosition();var u=Math.round(1e3/n.updateRate),r=t.chart.imagesSettings,i=t.easingFunction;i||(i=r.easingFunction);t.frame++;r=t.totalFrames;t.frame<=r?(i=i(0,t.frame,0,1,r),-1==t.direction&&(i=1-i),t.animatingAlong?t.positionOnLine=i:(r=t.initialX+(t.finalX-t.initialX)*i,isNaN(t.longitude)||(t.longitude=r),isNaN(t.left)||(t.left=r),isNaN(t.right)||(t.right=r),i=t.initialY+(t.finalY-t.initialY)*i,isNaN(t.latitude)||(t.latitude=i),isNaN(t.top)||(t.top=i),isNaN(t.bottom)||(t.bottom=i)),t.clearTO(),window.requestAnimationFrame?window.requestAnimationFrame(function(){t.update.call(t)}):t.timeOut=setTimeout(function(){t.update.call(t)},u)):(t.fire({type:"animationEnd",chart:t.chart,image:this,lineSegment:t.lineSegment,direction:t.direction}),t.line&&t.animatingAlong&&(1==t.direction?t.lineSegment<t.line.segments-2?(t.lineSegment++,t.delayAnimateAlong(),t.positionOnLine=0):t.flipDirection?(t.direction=-1,t.extraAngle=180,t.delayAnimateAlong()):t.loop&&(t.delayAnimateAlong(),t.lineSegment=0):0<t.lineSegment?(t.lineSegment--,t.delayAnimateAlong(),t.positionOnLine=0):t.loop&&t.flipDirection?(t.direction=1,t.extraAngle=0,t.delayAnimateAlong()):t.loop&&t.delayAnimateAlong()))},delayAnimateAlong:function(){var n=this;n.clearTO();n.animateAlongLine&&(n.timeOut=setTimeout(function(){n.animateAlong.call(n)},1e3*n.chart.imagesSettings.pauseDuration))},fixToStage:function(){if(!isNaN(this.longitude)){var n=this.chart.coordinatesToStageXY(this.longitude,this.latitude);this.left=n.x;this.top=n.y;this.latitude=this.longitude=void 0}this.validate()},fixToMap:function(){if(!isNaN(this.left)){var n=this.chart.stageXYToCoordinates(this.left,this.top);this.longitude=n.longitude;this.latitude=n.latitude;this.top=this.left=void 0}this.validate()}})}(),function(){var n=window.HistoryMaps;n.degreesToRadians=function(n){return n/180*Math.PI};n.radiansToDegrees=function(n){return n/Math.PI*180};n.getColorFade=function(t,i,r){var f=n.hex2RGB(i),e,u;i=f[0];var o=f[1],f=f[2],u=n.hex2RGB(t);return t=u[0],e=u[1],u=u[2],t+=Math.round((i-t)*r),e+=Math.round((o-e)*r),u+=Math.round((f-u)*r),"rgb("+t+","+e+","+u+")"};n.hex2RGB=function(n){return[parseInt(n.substring(1,3),16),parseInt(n.substring(3,5),16),parseInt(n.substring(5,7),16)]};n.processDescriptionWindow=function(n,t){isNaN(t.descriptionWindowX)&&(t.descriptionWindowX=n.descriptionWindowX);isNaN(t.descriptionWindowY)&&(t.descriptionWindowY=n.descriptionWindowY);isNaN(t.descriptionWindowLeft)&&(t.descriptionWindowLeft=n.descriptionWindowLeft);isNaN(t.descriptionWindowRight)&&(t.descriptionWindowRight=n.descriptionWindowRight);isNaN(t.descriptionWindowTop)&&(t.descriptionWindowTop=n.descriptionWindowTop);isNaN(t.descriptionWindowBottom)&&(t.descriptionWindowBottom=n.descriptionWindowBottom);isNaN(t.descriptionWindowWidth)&&(t.descriptionWindowWidth=n.descriptionWindowWidth);isNaN(t.descriptionWindowHeight)&&(t.descriptionWindowHeight=n.descriptionWindowHeight)};n.normalizePath=function(t){for(var f,e,o="",v=n.parsePath(t.getAttribute("d")),s=1/0,h=-1/0,c=1/0,l=-1/0,a=0;a<v.length;a++){var i=v[a],r=i.letter,u=i.x,i=i.y;"h"==r&&(r="L",u+=f,i=e);"H"==r&&(r="L",i=e);"v"==r&&(r="L",u=f,i+=e);"V"==r&&(r="L",u=f);"m"!==r&&"l"!==r||(r=r.toUpperCase(),u+=f,i+=e);u=n.roundTo(u,3);i=n.roundTo(i,3);f=u;e=i;u>h&&(h=u);u<s&&(s=u);i>l&&(l=i);i<c&&(c=i);o="z"==r.toLowerCase()?o+"Z ":o+(r+" ")+u+" "+i+" "}return t.setAttribute("d",o),{minX:s,maxX:h,minY:c,maxY:l}};n.mercatorLatitudeToRadians=function(t){return Math.log(Math.tan(Math.PI/4+n.degreesToRadians(t)/2))};n.parsePath=function(n){var u,r,t,i;for(n=n.match(/([MmLlHhVvZz]{1}[0-9.,\-\s]*)/g),u=[],r=0;r<n.length;r++){t=n[r].match(/([MmLlHhVvZz]{1})|([0-9.\-]+)/g);i={letter:t[0]};switch(t[0]){case"Z":case"Z":case"z":break;case"V":case"v":i.y=Number(t[1]);break;case"H":case"h":i.x=Number(t[1]);break;default:i.x=Number(t[1]);i.y=Number(t[2])}u.push(i)}return u};n.acos=function(n){return 1<n?0:-1>n?Math.PI:Math.acos(n)};n.asin=function(n){return 1<n?Math.PI/2:-1>n?-Math.PI/2:Math.asin(n)};n.sinci=function(n){return n?n/Math.sin(n):1};n.asqrt=function(n){return 0<n?Math.sqrt(n):0};n.winkel3=function(t,i){var r=n.aitoff(t,i);return[(r[0]+t/Math.PI*2)/2,(r[1]+i)/2]};n.winkel3.invert=function(t,i){var f=t,e=i,nt=25,p=Math.PI/2;do var o,r=Math.cos(e),u=Math.sin(e),w=Math.sin(2*e),a=u*u,y=r*r,b=Math.sin(f),c=Math.cos(f/2),l=Math.sin(f/2),k=l*l,s=1-y*c*c,h=s?n.acos(r*c)*Math.sqrt(o=1/s):o=0,s=.5*(2*h*r*l+f/p)-t,d=.5*(h*u+e)-i,g=.5*o*(y*k+h*r*c*a)+.5/p,v=o*(b*w/4-h*u*l),u=.125*o*(w*l-h*u*y*b),a=.5*o*(a*c+h*k*r)+.5,r=v*u-a*g,v=(d*v-s*a)/r,s=(s*u-d*g)/r,f=f-v,e=e-s;while((1e-6<Math.abs(v)||1e-6<Math.abs(s))&&0<--nt);return[f,e]};n.aitoff=function(t,i){var r=Math.cos(i),u=n.sinci(n.acos(r*Math.cos(t/=2)));return[2*r*Math.sin(t)*u,Math.sin(i)*u]};n.orthographic=function(n,t){return[Math.cos(t)*Math.sin(n),Math.sin(t)]};n.equirectangular=function(n,t){return[n,t]};n.equirectangular.invert=function(n,t){return[n,t]};n.eckert5=function(n,t){var i=Math.PI;return[n*(1+Math.cos(t))/Math.sqrt(2+i),2*t/Math.sqrt(2+i)]};n.eckert5.invert=function(n,t){var i=Math.sqrt(2+Math.PI),r=t*i/2;return[i*n/(1+Math.cos(r)),r]};n.eckert6=function(n,t){for(var r=Math.PI,i=(1+r/2)*Math.sin(t),u=0,f=1/0;10>u&&1e-5<Math.abs(f);u++)t-=f=(t+Math.sin(t)-i)/(1+Math.cos(t));return i=Math.sqrt(2+r),[n*(1+Math.cos(t))/i,2*t/i]};n.eckert6.invert=function(t,i){var r=1+Math.PI/2,u=Math.sqrt(r/2);return[2*t*u/(1+Math.cos(i*=u)),n.asin((i+Math.sin(i))/r)]};n.mercator=function(n,t){return t>=Math.PI/2-.02&&(t=Math.PI/2-.02),t<=-Math.PI/2+.02&&(t=-Math.PI/2+.02),[n,Math.log(Math.tan(Math.PI/4+t/2))]};n.mercator.invert=function(n,t){return[n,2*Math.atan(Math.exp(t))-Math.PI/2]};n.miller=function(n,t){return[n,1.25*Math.log(Math.tan(Math.PI/4+.4*t))]};n.miller.invert=function(n,t){return[n,2.5*Math.atan(Math.exp(.8*t))-.625*Math.PI]};n.eckert3=function(n,t){var i=Math.PI,r=Math.sqrt(i*(4+i));return[2/r*n*(1+Math.sqrt(1-4*t*t/(i*i))),4/r*t]};n.eckert3.invert=function(t,i){var r=Math.PI,u=Math.sqrt(r*(4+r))/2;return[t*u/(1+n.asqrt(1-i*i*(4+r)/(4*r))),i*u/2]}}(),function(){var n=window.HistoryMaps;n.MapData=n.Class({inherits:n.MapObject,construct:function(){this.cname="MapData";n.MapData.base.construct.call(this);this.projection="mercator";this.topLatitude=90;this.bottomLatitude=-90;this.leftLongitude=-180;this.rightLongitude=180;this.zoomLevel=1;this.getAreasFromMap=!1}})}(),function(){var n=window.HistoryMaps;n.DescriptionWindow=n.Class({construct:function(){},show:function(n,t,i,r){var e=this,f,o,s,u;e.chart=n;f=document.createElement("div");f.style.position="absolute";o=n.classNamePrefix+"-description-";f.className="historymapDescriptionWindow "+o+"div";e.div=f;t.appendChild(f);s=".gif";n.svgIcons&&(s=".svg");u=document.createElement("img");u.className="historymapDescriptionWindowCloseButton "+o+"close-img";u.src=n.pathToImages+"xIcon"+s;u.style.cssFloat="right";u.style.cursor="pointer";u.onclick=function(){e.close()};u.onmouseover=function(){u.src=n.pathToImages+"xIconH"+s};u.onmouseout=function(){u.src=n.pathToImages+"xIcon"+s};f.appendChild(u);t=document.createElement("div");t.className="historymapDescriptionTitle "+o+"title-div";t.onmousedown=function(){e.div.style.zIndex=1e3};f.appendChild(t);t.innerHTML=r;r=t.offsetHeight;t=document.createElement("div");t.className="historymapDescriptionText "+o+"text-div";t.style.maxHeight=e.maxHeight-r-20+"px";f.appendChild(t);t.innerHTML=i},close:function(){try{this.div.parentNode.removeChild(this.div);this.chart.fireClosed()}catch(n){}}})}(),function(){var n=window.HistoryMaps;n.ValueLegend=n.Class({construct:function(t){this.cname="ValueLegend";this.enabled=!0;this.showAsGradient=!1;this.minValue=0;this.height=12;this.width=200;this.bottom=this.left=10;this.borderColor="#FFFFFF";this.borderAlpha=this.borderThickness=1;this.color="#000000";this.fontSize=11;n.applyTheme(this,t,this.cname)},init:function(t,i){var s;if(this.enabled){var e=t.areasSettings.color,c=t.areasSettings.colorSolid,l=t.colorSteps;n.remove(this.set);s=i.set();this.set=s;n.setCN(t,s,"value-legend");var r=0,h=this.minValue,o=this.fontSize,f=t.fontFamily,u=this.color,a={precision:t.precision,decimalSeparator:t.decimalSeparator,thousandsSeparator:t.thousandsSeparator};if(void 0==h&&(h=n.formatNumber(t.minValueReal,a)),void 0!==h&&(r=n.text(i,h,u,f,o,"left"),r.translate(0,o/2-1),n.setCN(t,r,"value-legend-min-label"),s.push(r),r=r.getBBox().height),h=this.maxValue,void 0===h&&(h=n.formatNumber(t.maxValueReal,a)),void 0!==h&&(r=n.text(i,h,u,f,o,"right"),r.translate(this.width,o/2-1),n.setCN(t,r,"value-legend-max-label"),s.push(r),r=r.getBBox().height),this.showAsGradient)e=n.rect(i,this.width,this.height,[e,c],1,this.borderThickness,this.borderColor,1,0,0),n.setCN(t,e,"value-legend-gradient"),e.translate(0,r),s.push(e);else for(o=this.width/l,f=0;f<l;f++)u=n.getColorFade(e,c,1*f/(l-1)),u=n.rect(i,o,this.height,u,1,this.borderThickness,this.borderColor,1),n.setCN(t,u,"value-legend-color"),n.setCN(t,u,"value-legend-color-"+f),u.translate(o*f,r),s.push(u);c=e=0;l=s.getBBox();r=t.getY(this.bottom,!0);o=t.getY(this.top);f=t.getX(this.right,!0);u=t.getX(this.left);isNaN(o)||(e=o);isNaN(r)||(e=r-l.height);isNaN(u)||(c=u);isNaN(f)||(c=f-l.width);s.translate(c,e)}else n.remove(this.set)}})}(),function(){var n=window.HistoryMaps;n.ObjectList=n.Class({construct:function(n){this.divId=n},init:function(n){this.chart=n;var t=this.divId;this.container&&(t=this.container);this.div="object"!=typeof t?document.getElementById(t):t;t=document.createElement("div");t.className="historymapObjectList "+n.classNamePrefix+"-object-list-div";this.div.appendChild(t);this.addObjects(n.dataProvider,t)},addObjects:function(n,t){var f=this.chart,u=document.createElement("ul"),i,r;if(u.className=f.classNamePrefix+"-object-list-ul",n.areas)for(i=0;i<n.areas.length;i++)r=n.areas[i],void 0===r.showInList&&(r.showInList=f.showAreasInList),this.addObject(r,u);if(n.images)for(i=0;i<n.images.length;i++)r=n.images[i],void 0===r.showInList&&(r.showInList=f.showImagesInList),this.addObject(r,u);if(n.lines)for(i=0;i<n.lines.length;i++)r=n.lines[i],void 0===r.showInList&&(r.showInList=f.showLinesInList),this.addObject(r,u);0<u.childNodes.length&&t.appendChild(u)},addObject:function(n,t){var f=this,e,u,r,i;n.showInList&&void 0!==n.title&&(e=f.chart,u=document.createElement("li"),u.className=e.classNamePrefix+"-object-list-li",r=n.titleTr,r||(r=n.title),r=document.createTextNode(r),i=document.createElement("a"),i.className=e.classNamePrefix+"-object-list-a",i.appendChild(r),u.appendChild(i),t.appendChild(u),this.addObjects(n,u),i.onmouseover=function(){f.chart.rollOverMapObject(n,!1)},i.onmouseout=function(){f.chart.rollOutMapObject(n)},i.onclick=function(){f.chart.clickMapObject(n)})}})}();HistoryMaps.themes.black={themeName:"black",HistoryMap:{color:"#e7e7e7",backgroundColor:"#222222"},AmCoordinateChart:{colors:["#de4c4f","#d8854f","#eea638","#a7a737","#86a965","#8aabb0","#69c8ff","#cfd27e","#9d9888","#916b8a","#724887","#7256bc"]},AmStockChart:{colors:["#de4c4f","#d8854f","#eea638","#a7a737","#86a965","#8aabb0","#69c8ff","#cfd27e","#9d9888","#916b8a","#724887","#7256bc"]},AmSlicedChart:{outlineAlpha:1,outlineThickness:2,labelTickColor:"#FFFFFF",labelTickAlpha:.3,colors:["#de4c4f","#d8854f","#eea638","#a7a737","#86a965","#8aabb0","#69c8ff","#cfd27e","#9d9888","#916b8a","#724887","#7256bc"]},AmRectangularChart:{zoomOutButtonColor:"#FFFFFF",zoomOutButtonRollOverAlpha:.15,zoomOutButtonImage:"lensWhite"},AxisBase:{axisColor:"#FFFFFF",axisAlpha:.3,gridAlpha:.1,gridColor:"#FFFFFF",dashLength:3},ChartScrollbar:{backgroundColor:"#000000",backgroundAlpha:.2,graphFillAlpha:.2,graphLineAlpha:0,graphFillColor:"#FFFFFF",selectedGraphFillColor:"#FFFFFF",selectedGraphFillAlpha:.4,selectedGraphLineColor:"#FFFFFF",selectedBackgroundColor:"#FFFFFF",selectedBackgroundAlpha:.09,gridAlpha:.15},ChartCursor:{cursorColor:"#FFFFFF",color:"#000000",cursorAlpha:.5},AmLegend:{color:"#e7e7e7"},AmGraph:{lineAlpha:.9},GaugeArrow:{color:"#FFFFFF",alpha:.8,nailAlpha:0,innerRadius:"40%",nailRadius:15,startWidth:15,borderAlpha:.8,nailBorderAlpha:0},GaugeAxis:{tickColor:"#FFFFFF",tickAlpha:1,tickLength:15,minorTickLength:8,axisThickness:3,axisColor:"#FFFFFF",axisAlpha:1,bandAlpha:.8},TrendLine:{lineColor:"#c03246",lineAlpha:.8},AreasSettings:{alpha:.8,color:"#666666",colorSolid:"#000000",unlistedAreasAlpha:.4,unlistedAreasColor:"#555555",outlineColor:"#000000",outlineAlpha:.5,outlineThickness:.5,rollOverBrightness:30,slectedBrightness:50,rollOverOutlineColor:"#000000",selectedOutlineColor:"#000000",unlistedAreasOutlineColor:"#000000",unlistedAreasOutlineAlpha:.5},LinesSettings:{color:"#555555",alpha:.8},ImagesSettings:{alpha:.8,labelColor:"#FFFFFF",color:"#FFFFFF",labelRollOverColor:"#3c5bdc"},ZoomControl:{buttonFillAlpha:.4},SmallMap:{mapColor:"#444444",rectangleColor:"#666666",backgroundColor:"#000000",backgroundAlpha:.5,borderColor:"#555555",borderThickness:1,borderAlpha:.8},PeriodSelector:{color:"#e7e7e7"},PeriodButton:{color:"#e7e7e7",background:"transparent",opacity:.7,border:"1px solid rgba(255, 255, 255, .15)",MozBorderRadius:"5px",borderRadius:"5px",margin:"1px",outline:"none",boxSizing:"border-box"},PeriodButtonSelected:{color:"#e7e7e7",backgroundColor:"rgba(255, 255, 255, 0.1)",border:"1px solid rgba(255, 255, 255, .3)",MozBorderRadius:"5px",borderRadius:"5px",margin:"1px",outline:"none",opacity:1,boxSizing:"border-box"},PeriodInputField:{color:"#e7e7e7",background:"transparent",border:"1px solid rgba(255, 255, 255, .15)",outline:"none"},DataSetSelector:{color:"#e7e7e7",selectedBackgroundColor:"rgba(255, 255, 255, .25)",rollOverBackgroundColor:"rgba(255, 255, 255, .15)"},DataSetCompareList:{color:"#e7e7e7",lineHeight:"100%",boxSizing:"initial",webkitBoxSizing:"initial",border:"1px solid rgba(255, 255, 255, .15)"},DataSetSelect:{border:"1px solid rgba(255, 255, 255, .15)",outline:"none"}};